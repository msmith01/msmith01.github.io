<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>yahoo finance on Matthew Smith R Shenanigans</title>
    <link>/tags/yahoo-finance/</link>
    <description>Recent content in yahoo finance on Matthew Smith R Shenanigans</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 31 Dec 2019 00:00:00 +0000</lastBuildDate>
    
	<atom:link href="/tags/yahoo-finance/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Quantitative Analytics: Optimal Portfolio Allocation</title>
      <link>/post/portfolio-optimisation-model/portfolio-optimisation-r/</link>
      <pubDate>Tue, 31 Dec 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/portfolio-optimisation-model/portfolio-optimisation-r/</guid>
      <description>
&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;


&lt;div id=&#34;introduction&#34; class=&#34;section level1 tabset tabset-fade tabset-pills&#34;&gt;
&lt;h1&gt;Introduction:&lt;/h1&gt;
&lt;p&gt;The literature in portfolio optimisation has been around for decades. In this post I cover a number of traditional portfolio optimisation models. The general aim is to select a portfolio of assets out of a set of all possible portfolios being considered with a defined objective function.&lt;/p&gt;
&lt;div id=&#34;the-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;The data:&lt;/h2&gt;
&lt;p&gt;The data is collected using the &lt;code&gt;tidyquant()&lt;/code&gt; package’s &lt;code&gt;tq_get()&lt;/code&gt; function. I then convert the daily asset prices to daily log returns using the &lt;code&gt;periodReturn&lt;/code&gt; function from the &lt;code&gt;quantmod()&lt;/code&gt; package. Next I construct &lt;code&gt;lists&lt;/code&gt; of 6 months worth of daily returns using the &lt;code&gt;rolling_origin()&lt;/code&gt; function from the &lt;code&gt;rsample()&lt;/code&gt; package. The objective is to compute on a rolling basis the 6 month mean returns &lt;code&gt;mus&lt;/code&gt; and the 6 month covariance matrices &lt;code&gt;Sigmas&lt;/code&gt; on the training sets (i.e. 6 months) and apply them on the test sets (i.e. 1 month later) - monthly rebalancing.&lt;/p&gt;
&lt;p&gt;Just as with the returns data, the same is applied to the monthly prices data.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;start_date &amp;lt;- &amp;quot;2013-01-01&amp;quot;
end_date &amp;lt;- &amp;quot;2017-08-31&amp;quot;
symbols &amp;lt;- c(&amp;quot;AAPL&amp;quot;, &amp;quot;ABBV&amp;quot;, &amp;quot;A&amp;quot;,  &amp;quot;APD&amp;quot;, &amp;quot;AA&amp;quot;, &amp;quot;CF&amp;quot;, &amp;quot;NVDA&amp;quot;, &amp;quot;HOG&amp;quot;, &amp;quot;WMT&amp;quot;, &amp;quot;AMZN&amp;quot;
            #,&amp;quot;MSFT&amp;quot;, &amp;quot;F&amp;quot;, &amp;quot;INTC&amp;quot;, &amp;quot;ADBE&amp;quot;, &amp;quot;AMG&amp;quot;, &amp;quot;AKAM&amp;quot;, &amp;quot;ALB&amp;quot;, &amp;quot;ALK&amp;quot;
            )

portfolio_prices &amp;lt;- tq_get(
  symbols,
  from = start_date,
  to = end_date,
) %&amp;gt;% 
  select(symbol, date, adjusted)


portfolio_monthly_returns &amp;lt;- portfolio_prices %&amp;gt;% 
  group_by(symbol) %&amp;gt;% 
  tq_transmute(
    select = adjusted,
    mutate_fun = periodReturn,
    period = &amp;quot;daily&amp;quot;,                              
    type = &amp;quot;log&amp;quot;,
  ) %&amp;gt;% 
  pivot_wider(names_from = symbol, values_from = daily.returns) %&amp;gt;% 
  mutate(year_month = yearmonth(date)) %&amp;gt;% 
  nest(-year_month) %&amp;gt;% 
  rolling_origin(
    initial = 6,
    assess = 1,
    skip = 0,
    cumulative = FALSE)


portfolio_monthly_prices &amp;lt;- portfolio_prices %&amp;gt;%
  pivot_wider(names_from = symbol, values_from = adjusted) %&amp;gt;% 
  mutate(year_month = yearmonth(date)) %&amp;gt;% 
  nest(-year_month) %&amp;gt;% 
  rolling_origin(
    initial = 6,
    assess = 1,
    skip = 0,
    cumulative = FALSE)

ListNamesDates &amp;lt;- map(portfolio_monthly_returns$splits, ~assessment(.x) %&amp;gt;%
                        select(year_month)) %&amp;gt;%
  plyr::ldply(., data.frame) %&amp;gt;% 
  pull(year_month)

#########

# Goal is to define the mean and covariance matrix on the training sets and apply them on the test sets - monthly rebalancing

mus &amp;lt;- map(portfolio_monthly_returns$splits, ~ analysis(.x) %&amp;gt;% 
             unnest(data) %&amp;gt;%
             select(-year_month, -date) %&amp;gt;%
             colMeans) %&amp;gt;%
  setNames(c(ListNamesDates))

Sigmas &amp;lt;- map(portfolio_monthly_returns$splits, ~ analysis(.x) %&amp;gt;%
                unnest() %&amp;gt;%
                tk_xts(., date_var = date) %&amp;gt;%
                cov(.)) %&amp;gt;% 
  setNames(c(ListNamesDates))&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;price-and-returns-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Price and Returns data&lt;/h2&gt;
&lt;p&gt;The returns data for the first &lt;code&gt;split&lt;/code&gt; looks like the following:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ABBV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
A
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
APD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012702708
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008291331
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003575412
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0035002417
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.008859253
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004740037
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0007860485
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.020819530
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0063746748
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0045367882
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.028249939
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012713395
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.019555411
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0133515376
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.020731797
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.022152033
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0324601827
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.005529864
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0037720098
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0025886574
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.005899428
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002033327
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.007259372
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0009230752
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.017429792
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.003753345
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0293228286
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.006958715
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0096029606
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0352948721
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002687379
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.022004791
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008022622
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0018451781
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.014769161
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0221704307
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.003063936
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0027737202
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0077780140
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015752246
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005620792
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.026649604
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0133906716
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.002200109
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.034376623
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0226730363
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.038724890
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0002916231
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0001126237
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;the-statistics&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;The statistics&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;Mus&lt;/code&gt; (mean returns) data looks like:&lt;/p&gt;
&lt;table class=&#34;kable_wrapper table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
x
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AAPL
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0025241
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ABBV
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0014847
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
A
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0002314
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
APD
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0006546
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0010700
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CF
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0013681
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
NVDA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0008864
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
HOG
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0008061
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
WMT
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0006895
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMZN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0006147
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The &lt;code&gt;Sigmas&lt;/code&gt; (covariance matrix) data looks like:&lt;/p&gt;
&lt;table class=&#34;kable_wrapper table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ABBV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
A
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
APD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AAPL
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0004166
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000220
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000112
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000388
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000528
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000277
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000408
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000116
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000038
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000366
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ABBV
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000220
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003128
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000490
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000393
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000137
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000472
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000511
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000732
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000258
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000295
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
A
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000112
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000490
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0002061
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000720
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000741
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000885
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000930
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001175
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000371
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001139
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
APD
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000388
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000393
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000720
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000993
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000523
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000687
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000578
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000744
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000107
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000511
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000528
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000137
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000741
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000523
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001485
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000874
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000685
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000674
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000012
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000383
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CF
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000277
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000472
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000885
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000687
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000874
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0002271
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000706
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000900
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000112
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000606
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
NVDA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000408
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000511
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000930
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000578
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000685
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000706
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0002092
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000706
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000127
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000853
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
HOG
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000116
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000732
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001175
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000744
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000674
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000900
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000706
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0002393
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000214
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000895
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
WMT
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000038
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000258
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000371
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000107
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000012
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000112
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000127
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000214
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000682
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000236
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMZN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000366
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000295
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001139
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000511
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000383
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000606
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000853
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000895
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000236
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003118
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;comparing-portfolio-optimisation&#34; class=&#34;section level1 tabset tabset-fade tabset-pills&#34;&gt;
&lt;h1&gt;Comparing Portfolio Optimisation&lt;/h1&gt;
&lt;div id=&#34;global-minimum-variance-portfolio&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Global Minimum Variance Portfolio&lt;/h2&gt;
&lt;p&gt;The global minimum-variance portfolio &lt;span class=&#34;math inline&#34;&gt;\(w^{gmv}\)&lt;/span&gt; is a portfolio of assets with gives us the lowest possible return variance or portfolio volatility. Volatility here is used as a replacement for risk, thus with less variance in volatility correlates to less risk in an asset. The portfolio focuses only on risk and ignores expected returns.&lt;/p&gt;
&lt;p&gt;The objective function is;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray} \min_{w} w^{T} \Sigma w \\
\text{subject to } 1^{T}w = 1 \\
w \ge 0 \end{eqnarray}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Since &lt;span class=&#34;math inline&#34;&gt;\(\Sigma\)&lt;/span&gt; is unknown we can estimate it as &lt;span class=&#34;math inline&#34;&gt;\(\hat{\Sigma}\)&lt;/span&gt; with the covariance matrix. In which the convex solution becomes:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[W = \dfrac{1}{1^{T}\hat{\Sigma}^{-1}1}\hat{\Sigma}^{-1}1\]&lt;/span&gt;
The objective is that we want to find the optimial weights from the model such that our risk is minimised.&lt;/p&gt;
&lt;p&gt;The below problem consists of our &lt;span class=&#34;math inline&#34;&gt;\(Minimisation\)&lt;/span&gt; problem &lt;span class=&#34;math inline&#34;&gt;\(\min_{w} w^{T} \Sigma w\)&lt;/span&gt;. The &lt;code&gt;quad_form&lt;/code&gt; function takes the quadratic form &lt;span class=&#34;math inline&#34;&gt;\(x^T Px\)&lt;/span&gt; where &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; is a vector and &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt; is a matrix or in our case &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; is our weights vector and &lt;span class=&#34;math inline&#34;&gt;\(\Sigma\)&lt;/span&gt; is the covariance matrix for &lt;span class=&#34;math inline&#34;&gt;\(A_{1}, \dots, A_{5}\)&lt;/span&gt;. The &lt;code&gt;constraints&lt;/code&gt; correspond to &lt;span class=&#34;math inline&#34;&gt;\(1^{T}w = 1\)&lt;/span&gt; in which we cannot assign negative weights to our assets and that we invest all our capital in the portfolio.&lt;/p&gt;
&lt;p&gt;We can use the Disciplined Convex Programming (&lt;code&gt;CVXR&lt;/code&gt;) package in R, which;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Analyses the problem,&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Verifies the convexity,&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Converts the problem into canonical form,&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Solves the problem.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We want to find the optimial weights from the model such that our risk is minimised. We can do this by solving the optimisation problem, bind the lists into a single data frame and use &lt;code&gt;ggplot2&lt;/code&gt; to plot the rolling one month out of sample optimal portfolio weights - based on the previous 6 months rolled &lt;code&gt;mus&lt;/code&gt; and &lt;code&gt;Sigmas&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 1) Function: Global Minimum Variance Portfolio
GMVPportolioFunction &amp;lt;- function(Sigma) {
  w &amp;lt;- Variable(nrow(Sigma))
  problem &amp;lt;- Problem(               # Initialise the problem
    Minimize(                       # minimse or maximise objective function
      quad_form(
        w, Sigma                    # Model inputs, the number of weights to consider and the covariance matrix
        )
      ), 
    constraints = list(
      w &amp;gt;= 0,                       # First model constraint
      sum(w) == 1))                 # Second model constrain
  Solution &amp;lt;- solve(problem, solver=&amp;quot;SCS&amp;quot;)        # Solves the problem
  return(as.vector(Solution$getValue(w)))
}

# 1a) Portfolio GMVP
GMVPPortfolio &amp;lt;- map(
  .x = Sigmas,
  GMVPportolioFunction)

# 1b) Portfolio GMVP
GMVPPortfolioWeights &amp;lt;- setNames(GMVPPortfolio, ListNamesDates) %&amp;gt;% 
  map(.,  ~setNames(., c(symbols))) %&amp;gt;% 
  map_dfr(., ~bind_rows(.), .id = &amp;quot;date&amp;quot;) %&amp;gt;% 
  mutate(date = as.Date(paste(date, &amp;quot;01&amp;quot;), format = &amp;quot;%Y %b %d&amp;quot;))

GMVPPortfolioWeights %&amp;gt;%
  head() %&amp;gt;% 
  kable() %&amp;gt;%
  kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
date
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ABBV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
A
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
APD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-07-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0600841
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0335474
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1487694
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1258906
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0727919
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0095632
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5208891
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0284642
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-08-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1046817
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0404000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000009
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0917764
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1592917
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0299732
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0364528
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5374240
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000007
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-09-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1183895
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000005
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000006
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0844453
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1683525
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0246108
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0635568
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000002
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5406430
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000004
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-10-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0975699
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0024138
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0742436
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1166938
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0431301
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0968247
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5691240
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-11-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1480922
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000003
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0620406
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0449223
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000003
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0279872
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1613034
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0376023
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5014186
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0166322
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-12-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1135468
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000007
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0678773
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0560224
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0000005
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0062812
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1195510
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0779063
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5588149
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000001
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 1c) Portfolio GMVP
GMVPPortfolioWeights %&amp;gt;% 
  select(date, everything()) %&amp;gt;% 
  pivot_longer(cols = 2:ncol(.), values_to = &amp;quot;weights&amp;quot;) %&amp;gt;% 
  ggplot(aes(fill = name, y = weights, x = date)) + 
  geom_bar(position = &amp;quot;stack&amp;quot;, stat = &amp;quot;identity&amp;quot;, width = 100) +
  scale_fill_viridis(option = &amp;quot;magma&amp;quot;, discrete = TRUE, name = &amp;quot;Asset&amp;quot;) +
  theme_bw() +
  ggtitle(&amp;quot;GMVP Rolling Portfolio Adjustments&amp;quot;) +
  xlab(&amp;quot;Date&amp;quot;) +
  ylab(&amp;quot;Weights&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/portfolio-optimisation-model/portfolio-optimisation-R_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;markowitz-portfolio&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Markowitz Portfolio&lt;/h2&gt;
&lt;p&gt;The Markowitz Mean-Variance Portfolio is constructed as follows:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray} \max_{w} \mu^{T}w - \lambda w^{T}\Sigma w \\
\text{subject to } 1^{T}w = 1 \\
w \ge 0 \end{eqnarray}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We can set different risk parameters by adjusting &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt; and see how the returns are affected. This can be done by running multiple optimisation problems on the data with different &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt; values. Higher &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt; values places emphasis on the right hand side of the equation and thus the more risk adverse the investor is.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 2) Function: Markowitz Portfolio
MarkowitzportolioFunction &amp;lt;- function(mu, Sigma, lmd) {
  w &amp;lt;- Variable(nrow(Sigma))
  problem &amp;lt;- Problem(
    Maximize(t(mu) %*% w - lmd*quad_form(w, Sigma)),
    constraints = list(
      w &amp;gt;= 0, 
      sum(w) == 1)
  )
  Solution &amp;lt;- solve(problem)
  return(as.vector(Solution$getValue(w)))
}

# 2a) Portfolio Markowitz
lmd &amp;lt;- c(0.25, 0.5, 0.75)
MarkowitzPortfolio &amp;lt;- map(lmd,
                          ~map2(
                            .x = mus,
                            .y = Sigmas,
                            MarkowitzportolioFunction, lmd = .x))

# 2b) Portfolio Markowitz
MarkowitzPortfolioWeights &amp;lt;- setNames(MarkowitzPortfolio, lmd) %&amp;gt;% 
  map(., ~setNames(., c(ListNamesDates))) %&amp;gt;% 
  map(., ~map(., ~setNames(., c(symbols)))) %&amp;gt;% 
  map(., ~map_dfr(., ~bind_rows(.), .id = &amp;quot;date&amp;quot;)) %&amp;gt;% 
  map_dfr(., ~bind_rows(.), .id = &amp;quot;lambda&amp;quot;) %&amp;gt;% 
  mutate(date = as.Date(paste(date, &amp;quot;01&amp;quot;), format = &amp;quot;%Y %b %d&amp;quot;))

MarkowitzPortfolioWeights %&amp;gt;%
  head() %&amp;gt;% 
  kable() %&amp;gt;%
  kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
lambda
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
date
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ABBV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
A
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
APD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-07-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-08-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2938168
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7061832
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-09-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-10-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000001
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9999984
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000004
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000001
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-11-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-12-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We can see how the risk and return is affected by the changes in the &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt; values in the following plot. As the &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt; values increase the less risk we take on but also we assume less returns. Low values of &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt; makes us invest in a signle asset with the weight on asset &lt;span class=&#34;math inline&#34;&gt;\(A_{5}\)&lt;/span&gt;, increasing the &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt; values increases the weights in other assets &lt;span class=&#34;math inline&#34;&gt;\(A_{i}\)&lt;/span&gt; spreading our risk.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 2c) Portfolio Markowitz
MarkowitzPortfolioWeights %&amp;gt;% 
  select(date, lambda, everything()) %&amp;gt;% 
  pivot_longer(cols = 3:ncol(.), values_to = &amp;quot;weights&amp;quot;) %&amp;gt;% 
  ggplot(aes(fill = name, y = weights, x = date)) + 
  geom_bar(position = &amp;quot;stack&amp;quot;, stat = &amp;quot;identity&amp;quot;, width = 100) +
  facet_wrap(~lambda, ncol = 1) +
  scale_fill_viridis(option = &amp;quot;magma&amp;quot;, discrete = TRUE, name = &amp;quot;Asset&amp;quot;) +
  theme_bw() +
  ggtitle(&amp;quot;Markowitz Rolling Portfolio Adjustments&amp;quot;,
          subtitle = &amp;quot;For different Lambda Risk Values&amp;quot;) +
  xlab(&amp;quot;Date&amp;quot;) +
  ylab(&amp;quot;Weights&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/portfolio-optimisation-model/portfolio-optimisation-R_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;max-sharpe-ratio&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Max Sharpe Ratio&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; I originally made this post a few months back and when I went back to it some of the parts for the Max-Sharpe Ratio portfolio did not work as before - I think this is due to the recent update in the &lt;code&gt;tidyr&lt;/code&gt; package. I made some minor adjustments, however this part of the post is incorrect (just look at the portfolio weights plot). I hightlight in the code when I made the minor adjustments - when I have the opportunity to go back through the code more carefully I will -&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 2) Function: Max Sharpe Ratio 
#NOTE::: When we have all negative mus for a given month we obtain an NA value - the function 
# cannot find a maximum when all mus are negative compare the MaxSharpePortfolio$`2015 Sep` and
# MaxSharpePortfolio$`2015 Oct` along with the mus$`2015 Sep` and mus$`2015 Oct` we invests 99% of the portfolio
# in Sept in ABBV since its positive. In Oct ABBV mu is negative and we cannot invest at all.
# Increasing the universe of Assets may overcome this problem.
MaxSharpeportolioFunction &amp;lt;- function(mu, Sigma) {
  w &amp;lt;- Variable(nrow(Sigma))
  problem &amp;lt;- Problem(
    Minimize(quad_form(w, Sigma)),
    constraints = list(
      w &amp;gt;= 0, t(mu) %*% w == 1)
  )
  Solution &amp;lt;- solve(problem, solver=&amp;quot;SCS&amp;quot;)
  return(as.vector(Solution$getValue(w)/sum(Solution$getValue(w))))
}

# 3a) Portfolio Max Sharpe Ratio                                 
MaxSharpePortfolio &amp;lt;- purrr::map2(.x = mus,
                                  .y = Sigmas,
                                  .f = ~MaxSharpeportolioFunction(.x, .y))

# 3b) Portfolio Max Sharpe Ratio
  MaxSharpePortfolioWeights &amp;lt;- setNames(MaxSharpePortfolio, ListNamesDates) %&amp;gt;%
    as_tibble(.) %&amp;gt;%               # Made an adjustment here
    map(.,  ~setNames(., c(symbols))) %&amp;gt;% 
    map_dfr(., ~bind_rows(.), .id = &amp;quot;date&amp;quot;) %&amp;gt;% 
    mutate(date = as.Date(paste(date, &amp;quot;01&amp;quot;), format = &amp;quot;%Y %b %d&amp;quot;))

MaxSharpePortfolioWeights %&amp;gt;%
  head() %&amp;gt;% 
  kable() %&amp;gt;%
  kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
date
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ABBV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
A
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
APD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-07-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0009088
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1532283
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0371040
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2332344
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.1010233
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0126946
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2083815
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0262255
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5086221
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0269248
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-08-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0109744
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1485344
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0156878
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3292178
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0080488
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0051372
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1146053
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0091278
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4086911
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0025515
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-09-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1217206
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1246626
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0087004
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3421645
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2414533
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0002820
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1610166
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-10-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0270424
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2268394
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3427932
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2653166
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1283026
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0097059
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-11-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2061379
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1890218
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2234739
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0533254
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3280410
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-12-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2252115
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0306323
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0724210
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0325004
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1907158
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1192395
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3292796
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 3c) Portfolio Max Sharpe Ratio
MaxSharpePortfolioWeights %&amp;gt;% 
  select(date, everything()) %&amp;gt;%      # Made an adjustment here
  pivot_longer(cols = 2:ncol(.), values_to = &amp;quot;weights&amp;quot;) %&amp;gt;% 
  ggplot(aes(fill = name, y = weights, x = date)) + 
  geom_bar(position = &amp;quot;stack&amp;quot;, stat = &amp;quot;identity&amp;quot;, width = 100) +
  scale_fill_viridis(option = &amp;quot;magma&amp;quot;, discrete = TRUE, name = &amp;quot;Asset&amp;quot;) +
  theme_bw() +
  ggtitle(&amp;quot;Maximum Sharpe Ratio Rolling Portfolio Adjustments&amp;quot;) +
  xlab(&amp;quot;Date&amp;quot;) +
  ylab(&amp;quot;Weights&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/portfolio-optimisation-model/portfolio-optimisation-R_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;mu-quintile-portfolio&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Mu Quintile Portfolio&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 1a)
mu_quintiles &amp;lt;- map(mus, ~ntile(., 5) %&amp;gt;% 
                      setNames(c(symbols))) %&amp;gt;% 
  map(., ~sort(., decreasing = TRUE))

# 2)       
mu_diag_sigma &amp;lt;- map2(
  .x = mus,
  .y = Sigmas,
  ~.x / diag(.y)) 

mu_diag_sigma_quintiles &amp;lt;- mu_diag_sigma %&amp;gt;% 
  map(., ~ntile(., 5)) %&amp;gt;% 
  map(., ~setNames(., c(symbols))) %&amp;gt;% 
  map(., ~sort(., decreasing = TRUE))

# 1b) rank the quintiles by mu
quintiles_mu &amp;lt;- map2(
  .x = mus,
  .y = mu_quintiles,
  ~bind_rows(.x, .y))

quintiles_mu_weights &amp;lt;- map(quintiles_mu, ~ .x %&amp;gt;%
                              mutate_all(~ case_when(. %in% c(5, 1) ~ .5, 
                                                     TRUE ~ 0)) %&amp;gt;%
                              pmap_dfr(., ~ 
                                         {v1 &amp;lt;- c(...)
                                         v2 &amp;lt;- if(sum(v1) &amp;gt; 1) replace(v1, v1 != 0, 1/sum(v1!=0)) else v1
                                         as.list(v2)}))


quintiles_mu_weights &amp;lt;- map(quintiles_mu_weights, ~.x[-1,]) %&amp;gt;% 
  map2(.x = quintiles_mu, .y = ., ~bind_rows(.x, .y))

QuintileMuWeights &amp;lt;- map(quintiles_mu_weights, ~.x[3, ]) %&amp;gt;%  # The weights are stored in row 3.
  map_dfr(., ~bind_rows(.), .id = &amp;quot;date&amp;quot;) %&amp;gt;% 
  mutate(date = as.Date(paste(date, &amp;quot;01&amp;quot;), format = &amp;quot;%Y %b %d&amp;quot;))

QuintileMuWeights %&amp;gt;%
  head() %&amp;gt;% 
  kable() %&amp;gt;%
  kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
date
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ABBV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
A
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
APD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-07-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-08-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-09-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-10-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-11-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-12-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;QuintileMuWeights %&amp;gt;% 
    select(date, everything()) %&amp;gt;%
  pivot_longer(cols = 2:ncol(.), values_to = &amp;quot;weights&amp;quot;) %&amp;gt;% 
  ggplot(aes(fill = name, y = weights, x = date)) + 
  geom_bar(position = &amp;quot;stack&amp;quot;, stat = &amp;quot;identity&amp;quot;, width = 100) +
  scale_fill_viridis(option = &amp;quot;magma&amp;quot;, discrete = TRUE, name = &amp;quot;Asset&amp;quot;) +
  theme_bw() +
  ggtitle(&amp;quot;Quintile MU Rolling Portfolio Adjustments&amp;quot;) +
  xlab(&amp;quot;Date&amp;quot;) +
  ylab(&amp;quot;Weights&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/portfolio-optimisation-model/portfolio-optimisation-R_files/figure-html/unnamed-chunk-13-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;mu-diagsigma-portfolio&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Mu / Diag(Sigma) Portfolio&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 2a) 
mu_diag_sigma &amp;lt;- map2(
  .x = mus,
  .y = Sigmas,
  ~.x / diag(.y)) 

mu_diag_sigma_quintiles &amp;lt;- mu_diag_sigma %&amp;gt;% 
  map(., ~ntile(., 5)) %&amp;gt;% 
  map(., ~setNames(., c(symbols))) %&amp;gt;% 
  map(., ~sort(., decreasing = TRUE))

# 2b) rank the quintiles by mu / diag(Sigma)
quintiles_mu_diag_sigma &amp;lt;- map2(
  .x = mu_diag_sigma,
  .y = mu_diag_sigma_quintiles,
  ~bind_rows(.x, .y))

quintiles_mu_diag_sigma_weights &amp;lt;- map(quintiles_mu_diag_sigma, ~ .x %&amp;gt;%
                                         mutate_all(~ case_when(. %in% c(5, 1) ~ .5, 
                                                                TRUE ~ 0)) %&amp;gt;%
                                         pmap_dfr(., ~ 
                                                    {v1 &amp;lt;- c(...)
                                                    v2 &amp;lt;- if(sum(v1) &amp;gt; 1) replace(v1, v1 != 0, 1/sum(v1!=0)) else v1
                                                    as.list(v2)}))

quintiles_mu_diag_sigma_weights &amp;lt;- map(quintiles_mu_diag_sigma_weights, ~.x[-1,]) %&amp;gt;% 
  map2(.x = quintiles_mu_diag_sigma, .y = ., ~bind_rows(.x, .y))

QuintileMuDiagSigmaWeights &amp;lt;- map(quintiles_mu_diag_sigma_weights, ~.x[3, ]) %&amp;gt;% # The weights are stored in row 3.
  map_dfr(., ~bind_rows(.), .id = &amp;quot;date&amp;quot;) %&amp;gt;% 
  mutate(date = as.Date(paste(date, &amp;quot;01&amp;quot;), format = &amp;quot;%Y %b %d&amp;quot;))

QuintileMuDiagSigmaWeights %&amp;gt;%
  head() %&amp;gt;% 
  kable() %&amp;gt;%
  kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
date
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ABBV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
A
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
APD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-07-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-08-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-09-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-10-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-11-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-12-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;QuintileMuDiagSigmaWeights %&amp;gt;% 
  select(date, everything()) %&amp;gt;%
  pivot_longer(cols = 2:ncol(.), values_to = &amp;quot;weights&amp;quot;) %&amp;gt;% 
  ggplot(aes(fill = name, y = weights, x = date)) + 
  geom_bar(position = &amp;quot;stack&amp;quot;, stat = &amp;quot;identity&amp;quot;, width = 100) +
  scale_fill_viridis(option = &amp;quot;magma&amp;quot;, discrete = TRUE, name = &amp;quot;Asset&amp;quot;) +
  theme_bw() +
  ggtitle(&amp;quot;Quintile MU Diag Sigma Rolling Portfolio Adjustments&amp;quot;) +
  xlab(&amp;quot;Date&amp;quot;) +
  ylab(&amp;quot;Weights&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/portfolio-optimisation-model/portfolio-optimisation-R_files/figure-html/unnamed-chunk-15-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;mu-diagsqrtsigma-portfolio&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Mu / Diag(sqrt(Sigma)) Portfolio&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 3a)
mu_diag_sqrt_sigma &amp;lt;- map2(
  .x = mus,
  .y = Sigmas,
  ~.x / sqrt(diag(.y)))  

mu_diag_sqrt_sigma_quintiles &amp;lt;- mu_diag_sqrt_sigma %&amp;gt;% 
  map(., ~ntile(., 5)) %&amp;gt;% 
  map(., ~setNames(., c(symbols))) %&amp;gt;% 
  map(., ~sort(., decreasing = TRUE))

# 3b) rank the quintiles by mu / sqrt(diag(sigma))

quintiles_mu_diag_sqrt_sigma &amp;lt;- map2(
  .x = mu_diag_sqrt_sigma,
  .y = mu_diag_sqrt_sigma_quintiles,
  ~bind_rows(.x, .y))

quintiles_mu_diag_sqrt_sigma_weights &amp;lt;- map(quintiles_mu_diag_sqrt_sigma, ~ .x %&amp;gt;%
                                         mutate_all(~ case_when(. %in% c(5, 1) ~ .5, 
                                                                TRUE ~ 0)) %&amp;gt;%
                                         pmap_dfr(., ~ 
                                                    {v1 &amp;lt;- c(...)
                                                    v2 &amp;lt;- if(sum(v1) &amp;gt; 1) replace(v1, v1 != 0, 1/sum(v1!=0)) else v1
                                                    as.list(v2)}))

quintiles_mu_diag_sqrt_sigma_weights &amp;lt;- map(quintiles_mu_diag_sqrt_sigma_weights, ~.x[-1,]) %&amp;gt;% 
  map2(.x = quintiles_mu_diag_sqrt_sigma, .y = ., ~bind_rows(.x, .y))

QuintileMuDiagSqrtSigmaWeights &amp;lt;- map(quintiles_mu_diag_sqrt_sigma_weights, ~.x[3, ]) %&amp;gt;% # The weights are stored in row 3.
  map_dfr(., ~bind_rows(.), .id = &amp;quot;date&amp;quot;) %&amp;gt;% 
  mutate(date = as.Date(paste(date, &amp;quot;01&amp;quot;), format = &amp;quot;%Y %b %d&amp;quot;))

QuintileMuDiagSqrtSigmaWeights %&amp;gt;%
  head() %&amp;gt;% 
  kable() %&amp;gt;%
  kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
date
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ABBV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
A
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
APD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-07-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-08-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-09-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-10-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-11-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-12-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.25
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;QuintileMuDiagSqrtSigmaWeights %&amp;gt;% 
  select(date, everything()) %&amp;gt;%
  pivot_longer(cols = 2:ncol(.), values_to = &amp;quot;weights&amp;quot;) %&amp;gt;% 
  ggplot(aes(fill = name, y = weights, x = date)) + 
  geom_bar(position = &amp;quot;stack&amp;quot;, stat = &amp;quot;identity&amp;quot;, width = 100) +
  scale_fill_viridis(option = &amp;quot;magma&amp;quot;, discrete = TRUE, name = &amp;quot;Asset&amp;quot;) +
  theme_bw() +
  ggtitle(&amp;quot;Quintile MU Diag Sqrt(Sigma) Rolling Portfolio Adjustments&amp;quot;) +
  xlab(&amp;quot;Date&amp;quot;) +
  ylab(&amp;quot;Weights&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/portfolio-optimisation-model/portfolio-optimisation-R_files/figure-html/unnamed-chunk-17-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;analysis-of-results&#34; class=&#34;section level1 tabset tabset-fade tabset-pills&#34;&gt;
&lt;h1&gt;Analysis of Results&lt;/h1&gt;
&lt;p&gt;There are 8 different portfolio optimisation models. Putting all the data together, it’s easier to inspect the results.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;############################# Assess the Returns ##################################
MonthlyReturns &amp;lt;- map(portfolio_monthly_prices$splits, ~assessment(.x)) %&amp;gt;% 
  map(., ~unnest(.x, data) %&amp;gt;% 
        select(-year_month) %&amp;gt;% 
        tk_xts(date_var = date) %&amp;gt;% 
        lapply(., periodReturn, period = &amp;quot;monthly&amp;quot;)) %&amp;gt;% 
  setNames(., ListNamesDates) %&amp;gt;% 
  map(., ~data.frame(.)) %&amp;gt;% 
  bind_rows(., .id = &amp;quot;date&amp;quot;) %&amp;gt;% 
  mutate(date = as.Date(paste(date, &amp;quot;01&amp;quot;), format = &amp;quot;%Y %b %d&amp;quot;)) %&amp;gt;% 
  tk_xts(., date_var = date)

############# Assess the Monthly Portfolio Returns Depeninding on Weights #########

# 1d)
TS_GMVPPortfolioWeights &amp;lt;- GMVPPortfolioWeights %&amp;gt;% 
  tk_xts(., date_var = date)

PortRets_GMVP &amp;lt;- Return.portfolio(MonthlyReturns, weights = TS_GMVPPortfolioWeights) %&amp;gt;% 
  setNames(c(&amp;quot;GMVP&amp;quot;))


# 2d)
TS_MarkowitzPortfolioWeights &amp;lt;- MarkowitzPortfolioWeights %&amp;gt;% 
  group_split(lambda) %&amp;gt;% 
  setNames(c(lmd)) %&amp;gt;% 
  map(., ~tk_xts(., select = -lambda, date_var = date))

MarkowitzWeightedPortfolioReturnsFunction &amp;lt;- function(lmd){
  WeightedReturns = Return.portfolio(MonthlyReturns, weights = TS_MarkowitzPortfolioWeights[[lmd]])
  return(fortify.zoo(WeightedReturns))
}

PortRets_Markowitz &amp;lt;- lapply(seq(1:length(lmd)), MarkowitzWeightedPortfolioReturnsFunction) %&amp;gt;% 
  setNames(c(lmd)) %&amp;gt;%
  bind_rows(., .id = &amp;quot;lmd&amp;quot;) %&amp;gt;% 
  #column_to_rownames(&amp;quot;Index&amp;quot;) %&amp;gt;% 
  #select(-matches(&amp;quot;Index&amp;quot;)) %&amp;gt;% 
  #rownames_to_column(&amp;quot;Index&amp;quot;) %&amp;gt;% 
  mutate(Index = as.Date(Index),
         lmd = as.numeric(lmd)) %&amp;gt;% 
  pivot_wider(names_from = lmd, values_from = portfolio.returns) %&amp;gt;% 
  tk_xts(date_var = Index) %&amp;gt;% 
  setNames(c(paste(&amp;quot;Markowitz Lambda&amp;quot;, lmd)))

# 3d)
TS_MaxSharpePortfolioWeights &amp;lt;- MaxSharpePortfolioWeights %&amp;gt;% 
  tk_xts(., date_var = date)

PortRets_MaxSharpe &amp;lt;- Return.portfolio(MonthlyReturns, weights = TS_MaxSharpePortfolioWeights) %&amp;gt;% 
  setNames(c(&amp;quot;MaxSharpe&amp;quot;))


# 4) quintile mu

TS_QuintileMuWeights &amp;lt;- QuintileMuWeights %&amp;gt;% 
  tk_xts(., date_var = date)

PortRets_Mu_Quintiles &amp;lt;- Return.portfolio(MonthlyReturns, weights = TS_QuintileMuWeights) %&amp;gt;% 
  setNames(c(&amp;quot;Mu_Quintiles&amp;quot;))

# 4) quintile mu diag sigma

TS_QuintileMuDiagSigmaWeights &amp;lt;- QuintileMuDiagSigmaWeights %&amp;gt;% 
  tk_xts(., date_var = date)

PortRets_MuDiagSigma_Quintiles &amp;lt;- Return.portfolio(MonthlyReturns, weights = TS_QuintileMuDiagSigmaWeights) %&amp;gt;% 
  setNames(c(&amp;quot;MuDiagSigma_Quintiles&amp;quot;))

# 4) Quintile mu diga sqrt sigma

TS_QuintileMuDiagSqrtSigmaWeights &amp;lt;- QuintileMuDiagSqrtSigmaWeights %&amp;gt;% 
  tk_xts(., date_var = date)

PortRets_MuDiagSqrtSigma_Quintiles &amp;lt;- Return.portfolio(MonthlyReturns, weights = TS_QuintileMuDiagSqrtSigmaWeights) %&amp;gt;% 
  setNames(c(&amp;quot;MuDiagSqrtSigma_Quintiles&amp;quot;))

#####################################################################################&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Looking at the plots the Global Minimum Variance Portfolio shows the lowest volatility in the portfolio returns. The Max Sharpe portfolio is clearly wrong here (see, previous point on Max Sharpe Ratio section). The annaulised performance metrics are also displayed at the bottom for each portfolio over the period.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;########## Assess the Annualised Returns based on portfolio weights ##################
AllReturns &amp;lt;- cbind(PortRets_GMVP, PortRets_Markowitz, PortRets_MaxSharpe, PortRets_Mu_Quintiles,
                    PortRets_MuDiagSigma_Quintiles, PortRets_MuDiagSqrtSigma_Quintiles)
                    
library(data.table)
AllReturns %&amp;gt;%
  data.table(keep.rownames = TRUE) %&amp;gt;%
  as_tibble() %&amp;gt;% 
  pivot_longer(cols = 2:ncol(.)) %&amp;gt;% 
  ggplot(aes(x = index, y = value, color = name)) +
  geom_line() +
  facet_wrap(~name, ncol = 2) +
  ggtitle(&amp;quot;Portfolio Returns&amp;quot;, subtitle = &amp;quot;With portfolio optimised weights&amp;quot;) +
  xlab(&amp;quot;Returns&amp;quot;) +
  ylab(&amp;quot;Date&amp;quot;) +
  theme_tq()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/portfolio-optimisation-model/portfolio-optimisation-R_files/figure-html/unnamed-chunk-19-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;AnnualMetrics &amp;lt;- bind_cols(table.AnnualizedReturns(PortRets_GMVP) %&amp;gt;% 
                          rownames_to_column(&amp;quot;Metric&amp;quot;),
                        table.AnnualizedReturns(PortRets_Markowitz),
                        table.AnnualizedReturns(PortRets_MaxSharpe),
                        table.AnnualizedReturns(PortRets_Mu_Quintiles),
                        table.AnnualizedReturns(PortRets_MuDiagSigma_Quintiles),
                        table.AnnualizedReturns(PortRets_MuDiagSqrtSigma_Quintiles)
                        )

AnnualMetrics %&amp;gt;%
  kable() %&amp;gt;%
  kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Metric
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GMVP
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Markowitz Lambda 0.25
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Markowitz Lambda 0.5
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Markowitz Lambda 0.75
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MaxSharpe
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Mu_Quintiles
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MuDiagSigma_Quintiles
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MuDiagSqrtSigma_Quintiles
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Annualized Return
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1009
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.8441
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.8142
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7712
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1450
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1939
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2590
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2691
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Annualized Std Dev
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1127
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3617
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3516
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3353
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1473
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1800
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1485
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1535
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Annualized Sharpe (Rf=0%)
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.8951
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2.3340
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2.3157
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2.2999
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9845
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0774
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.7437
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.7529
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Plotting the cumulative returns shows that the Markowitz lambda portfolios have the highest returns over the period, however they also have the highest standard deviation over the same period.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chart.CumReturns(AllReturns, main = &amp;quot;Weighted Returns by Objective Function and Risk Tolerance&amp;quot;,
                 wealth.index = TRUE, legend.loc = &amp;quot;topleft&amp;quot;, colorset = rich6equal)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/portfolio-optimisation-model/portfolio-optimisation-R_files/figure-html/unnamed-chunk-20-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;charts.PerformanceSummary(AllReturns, main = &amp;quot;Performance for Different Weighted Assets&amp;quot;, 
                          wealth.index = TRUE, colorset = rich6equal)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/portfolio-optimisation-model/portfolio-optimisation-R_files/figure-html/unnamed-chunk-20-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;div id=&#34;additional&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Additional&lt;/h3&gt;
&lt;p&gt;(Some additional test data I leave here for future reference)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data &amp;lt;- data.frame(
  A_1 = c(2.3, 0.93, 0.62, 0.74, -0.23),
  A_2 = c(0.93, 1.40, 0.2, 0.56, 0.26),
  A_3 = c(0.62, 0.2, 1.80, 0.78, -0.27),
  A_4 = c(0.74, 0.56, 0.78, 3.4, -0.56),
  A_5 = c(-0.23, 0.26, -0.27, -0.56, 2.60),
  Security = c(1, 2, 3, 4, 5),
  R_i = c(15.1, 12.5, 14.7, 9.02, 17.68)
)

Sigma &amp;lt;- data[, 1:5]
w &amp;lt;- Variable(nrow(data))
mu &amp;lt;- data[, 7]
n_samples = 10
lambdas &amp;lt;- 10^seq(-2, 3, length.out = n_samples)

ret_data &amp;lt;- rep(0, n_samples)
risk_data &amp;lt;- rep(0, n_samples)
w_data &amp;lt;- matrix(0, nrow = n_samples, ncol = nrow(data))

for(i in seq_along(lambdas)) {
  lambda &amp;lt;- lambdas[i]
  problem &amp;lt;- Problem(
    Maximize(
      t(mu) %*% w - lambda*quad_form(w, Sigma)
    ),
    constraints = list(w &amp;gt;= 0, sum(w) == 1))
  solution &amp;lt;- solve(problem)
  w_data[i,] &amp;lt;- solution$getValue(w)
  risk_data[i] &amp;lt;- solution$getValue(sqrt(quad_form(w, Sigma)))
  ret_data[i] &amp;lt;- solution$getValue(t(mu) %*% w)
}

ggplot() +
  geom_line(mapping = aes(x = risk_data, y = ret_data), color = &amp;quot;blue&amp;quot;) +
  geom_point(mapping = aes(x = sqrt(diag(as.matrix(Sigma))), y = mu), color = &amp;quot;red&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/portfolio-optimisation-model/portfolio-optimisation-R_files/figure-html/unnamed-chunk-21-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Quantitative Trading Strategies using quantmod</title>
      <link>/post/understanding-ttr-package/technical-trading-rules/</link>
      <pubDate>Sun, 29 Dec 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/understanding-ttr-package/technical-trading-rules/</guid>
      <description>
&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;


&lt;div id=&#34;strategies&#34; class=&#34;section level1 tabset tabset-fade tabset-pills&#34;&gt;
&lt;h1&gt;Strategies&lt;/h1&gt;
&lt;div id=&#34;introduction&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Introduction:&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; This post is unfinished.&lt;/p&gt;
&lt;p&gt;This post goes through a number of the technical trading functions in the &lt;code&gt;TTR&lt;/code&gt; package &lt;a href=&#34;https://cran.r-project.org/web/packages/TTR/TTR.pdf&#34;&gt;here&lt;/a&gt;. I add definitions and show examples of how the functions work.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
library(quantmod)
library(tidyquant)
library(TTR)
library(timetk)
library(tidyr)
library(ggplot2) 
library(directlabels)
library(data.table)
library(quantstrat)
library(purrr)
library(quantstrat)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can download some data using the &lt;code&gt;quantmod&lt;/code&gt; package which stores the different assets into our Global Environment.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;start_date &amp;lt;- &amp;quot;2013-01-01&amp;quot;
end_date &amp;lt;- &amp;quot;2017-08-31&amp;quot;
symbols &amp;lt;- c(&amp;quot;AAPL&amp;quot;, &amp;quot;AMD&amp;quot;, &amp;quot;ADI&amp;quot;,  &amp;quot;ABBV&amp;quot;, &amp;quot;A&amp;quot;,  &amp;quot;APD&amp;quot;, &amp;quot;AA&amp;quot;, &amp;quot;CF&amp;quot;, &amp;quot;NVDA&amp;quot;, &amp;quot;HOG&amp;quot;, &amp;quot;WMT&amp;quot;, &amp;quot;AMZN&amp;quot;
             #,&amp;quot;MSFT&amp;quot;, &amp;quot;F&amp;quot;, &amp;quot;INTC&amp;quot;, &amp;quot;ADBE&amp;quot;, &amp;quot;AMG&amp;quot;, &amp;quot;AKAM&amp;quot;, &amp;quot;ALB&amp;quot;, &amp;quot;ALK&amp;quot;
)

getSymbols(symbols, 
           from = start_date,
           to = end_date)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1] &amp;quot;AAPL&amp;quot; &amp;quot;AMD&amp;quot;  &amp;quot;ADI&amp;quot;  &amp;quot;ABBV&amp;quot; &amp;quot;A&amp;quot;    &amp;quot;APD&amp;quot;  &amp;quot;AA&amp;quot;   &amp;quot;CF&amp;quot;   &amp;quot;NVDA&amp;quot; &amp;quot;HOG&amp;quot; 
## [11] &amp;quot;WMT&amp;quot;  &amp;quot;AMZN&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The first few observations for &lt;code&gt;AAPL&lt;/code&gt; looks like:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL.Open
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL.High
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL.Low
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL.Close
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL.Volume
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL.Adjusted
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-01-02
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79.11714
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79.28571
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
77.37572
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
78.43285
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
140129500
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.85055
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-01-03
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
78.26857
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
78.52428
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
77.28571
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
77.44286
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
88241300
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67.98149
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-01-04
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
76.71000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
76.94714
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.11857
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.28571
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
148583400
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
66.08789
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-01-07
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.57143
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.61429
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.60000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.84286
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
121039100
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.69916
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-01-08
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.60143
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.98428
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.46429
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.04429
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
114676800
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.87595
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-01-09
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.64286
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.00143
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.71286
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.87143
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101901100
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
64.84639
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;bollinger-bands-strategy&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Bollinger Bands Strategy&lt;/h2&gt;
&lt;p&gt;The idea of this strategy is&lt;/p&gt;
&lt;p&gt;Definition: A Bollinger Band consists of 3 lines. A simple moving average (SMA) and two additional lines plotted 2 standard deviations above and below the SMA. The standard deviation measures a stocks volatility and so when the markers are more volatile then the Bollinger Bands become wider. When the market is flat the Bollinger Banks contract.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chartSeries(NVDA,
            theme = chartTheme(&amp;quot;white&amp;quot;),
            TA = c(addBBands(n = 20, sd = 2, ma = &amp;quot;SMA&amp;quot;, draw = &amp;#39;bands&amp;#39;, on = -1))) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chartSeries(AMZN,
            theme = chartTheme(&amp;quot;white&amp;quot;),
            TA = c(addBBands(n = 20, sd = 2, ma = &amp;quot;SMA&amp;quot;, draw = &amp;#39;bands&amp;#39;, on = -1))) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-4-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We set the initial quantstrat parameters and initialise the strategy.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rm.strat(&amp;quot;BollingerBandsStrat&amp;quot;)
currency(&amp;#39;USD&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;USD&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;stock(symbols, currency = &amp;#39;USD&amp;#39;, multiplier = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1] &amp;quot;AAPL&amp;quot; &amp;quot;AMD&amp;quot;  &amp;quot;ADI&amp;quot;  &amp;quot;ABBV&amp;quot; &amp;quot;A&amp;quot;    &amp;quot;APD&amp;quot;  &amp;quot;AA&amp;quot;   &amp;quot;CF&amp;quot;   &amp;quot;NVDA&amp;quot; &amp;quot;HOG&amp;quot; 
## [11] &amp;quot;WMT&amp;quot;  &amp;quot;AMZN&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;init_date = as.Date(start_date) - 1
init_equity = 1000
portfolio.st &amp;lt;- account.st &amp;lt;- &amp;#39;BollingerBandsStrat&amp;#39;
initPortf(portfolio.st,
          symbols = symbols,
          initDate = init_date)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;BollingerBandsStrat&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;initAcct(account.st,
         portfolios = &amp;#39;BollingerBandsStrat&amp;#39;,
         initDate = init_date)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;BollingerBandsStrat&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;initOrders(portfolio = portfolio.st,
           initDate = init_date)
BBands_Strategy &amp;lt;- strategy(&amp;quot;BollingerBandsStrat&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;adding-indicators&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Adding indicators:&lt;/h3&gt;
&lt;p&gt;We add the Bollinger Bands indicator from the &lt;code&gt;TTR&lt;/code&gt; package to the strategy. It takes a Simple Moving Average (SMA) and the High Low Close data from each of our stocks, add the indicator to the defined &lt;code&gt;BBands_Strategy&lt;/code&gt; and creates a new column in our data alled &lt;code&gt;BollingerBands_Label&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Add indicators
BBands_Strategy &amp;lt;- add.indicator(
  strategy = BBands_Strategy,
  name = &amp;quot;BBands&amp;quot;,
  arguments = list(
    HLC = quote(HLC(mktdata)),
    maType = &amp;#39;SMA&amp;#39;),
  label = &amp;#39;BollingerBands_Label&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;adding-signals&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Adding signals:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The first signal states that when the &lt;strong&gt;close&lt;/strong&gt; is greater than the &lt;strong&gt;upper Bollinger Band&lt;/strong&gt;, add a value of 1 into a column called &lt;strong&gt;Close.gt.LowerBBand&lt;/strong&gt;. The &lt;code&gt;sigCrossover&lt;/code&gt; function only returns the first occurence of the relationship switching from false to true. Replacing with &lt;code&gt;sigComparison&lt;/code&gt; here would return all occurences of the relationship being greater than the upper band.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The second signal states that when the &lt;strong&gt;close&lt;/strong&gt; is less than the &lt;strong&gt;lower Bollinger Band&lt;/strong&gt; add a value of 1 into a column called &lt;strong&gt;Close.lt.LowerBBand&lt;/strong&gt;. Again using the &lt;code&gt;sigCrossover&lt;/code&gt; function to only return the first occurence.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The third signal&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The below code creates 3 new columns in our &lt;code&gt;mktdata&lt;/code&gt;. &lt;strong&gt;dn.BollingerBands_Label&lt;/strong&gt;, &lt;strong&gt;mavg.BollingerBands_Label&lt;/strong&gt;, &lt;strong&gt;up.BollingerBands_Label&lt;/strong&gt;. Which are the &lt;strong&gt;lower&lt;/strong&gt;, &lt;strong&gt;middle&lt;/strong&gt; and &lt;strong&gt;upper&lt;/strong&gt; Bollinger Band values. It also creates the following: &lt;strong&gt;Close.gt.UpperBBand&lt;/strong&gt;, &lt;strong&gt;Close.lt.LowerBBand&lt;/strong&gt;, &lt;strong&gt;Cross.MiddleBBand&lt;/strong&gt;. Which takes on the values according to whether the `sigCrossover’ has occured.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Add Signals

BBands_Strategy &amp;lt;- add.signal(
  BBands_Strategy, 
  name = &amp;quot;sigCrossover&amp;quot;,
  arguments = list(
    columns = c(&amp;quot;Close&amp;quot;,&amp;quot;up&amp;quot;),
    relationship = &amp;quot;gt&amp;quot;),
  label = &amp;quot;Close.gt.UpperBBand&amp;quot;)

BBands_Strategy &amp;lt;- add.signal(
  BBands_Strategy,
  name = &amp;quot;sigCrossover&amp;quot;,
  arguments = list(
    columns = c(&amp;quot;Close&amp;quot;,&amp;quot;dn&amp;quot;),
    relationship = &amp;quot;lt&amp;quot;),
  label = &amp;quot;Close.lt.LowerBBand&amp;quot;)

BBands_Strategy &amp;lt;- add.signal(
  BBands_Strategy,
  name = &amp;quot;sigCrossover&amp;quot;,
  arguments = list(
    columns = c(&amp;quot;High&amp;quot;,&amp;quot;Low&amp;quot;,&amp;quot;mavg&amp;quot;),
    relationship = &amp;quot;op&amp;quot;),
  label = &amp;quot;Cross.MiddleBBand&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;mktdata&lt;/code&gt; (which gets presented after running &lt;code&gt;applyStrategy&lt;/code&gt; and &lt;code&gt;updatePortf&lt;/code&gt;) would look like:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
index
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT.Open
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT.High
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT.Low
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT.Close
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT.Volume
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WMT.Adjusted
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
dn.BollingerBands_Label
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
mavg.BollingerBands_Label
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
up.BollingerBands_Label
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
pctB.BollingerBands_Label
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Close.gt.UpperBBand
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Close.lt.LowerBBand
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Cross.MiddleBBand
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-13
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.29
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.70
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.21
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.39
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3968600
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.98333
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.71632
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.09250
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.46868
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9871567
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-14
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.10
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.23
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.75
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.82
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6821000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.50441
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.82043
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.18133
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.54224
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7762866
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-15
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.54
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.13
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.30
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
25683700
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
58.22726
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.84929
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.19050
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.53171
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1096177
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-19
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.19
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.45
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.54
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.76
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14682300
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
57.77356
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.82222
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.18217
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.54211
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0347239
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-20
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.72
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.85
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.30
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.21
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11973600
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
58.15165
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.78472
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.16833
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.55195
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1211618
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-21
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.00
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.47
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.72
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.26
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20413100
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.03389
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.86119
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.22117
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.58114
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5963869
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-22
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.22
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.54
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.89
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.40
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9165200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.15152
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.90249
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.24950
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.59651
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5100843
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.50
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.34
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.44
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.44
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11817600
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.18514
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.00983
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.32100
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.63217
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6597812
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-26
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.69
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.39
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.61
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.11
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10557600
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.74808
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.14416
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.41200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.67984
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7463509
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-27
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.92
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.96
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.58
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.66
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8819000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
60.21020
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.20490
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.49383
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.78277
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.8515172
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-02-28
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.59
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.88
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.78
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.78
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18883600
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.47081
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.28076
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.56167
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.84258
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7283528
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-03-01
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.78
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.90
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.78
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.74
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8902300
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
60.27741
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.33128
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.63400
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.93672
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.8221462
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-03-04
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.52
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.26
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.51
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.26
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10567200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
61.55456
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.27376
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.75150
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.22924
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.1513879
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-03-05
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.47
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.04
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.99
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.72
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9142000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
61.94105
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.24347
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.95300
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.66253
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.2693145
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-03-06
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.75
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.13
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.38
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7149600
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
61.65540
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.17483
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.10567
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.03650
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.1424682
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2013-03-07
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.49
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.61
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.20
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.32
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6680000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
61.60497
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.14018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.22567
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.31116
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0157056
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;In row 4 of the below table, the &lt;strong&gt;close&lt;/strong&gt; is 68.76 which is less than the &lt;strong&gt;lower Bollinger Band&lt;/strong&gt; &lt;strong&gt;dn.BollingerBands_Label&lt;/strong&gt; column 68.822 and a &lt;code&gt;1&lt;/code&gt; is indicated in the &lt;strong&gt;Close.lt.LowerBBand&lt;/strong&gt; column. In row 13 of the same data, there is a &lt;code&gt;1&lt;/code&gt; in the column &lt;strong&gt;Close.gt.UpperBBand&lt;/strong&gt;. The &lt;strong&gt;close&lt;/strong&gt; is 73.26 and the &lt;strong&gt;up.BollingerBands_Label&lt;/strong&gt; is 72.23 so the &lt;strong&gt;close&lt;/strong&gt; is &lt;strong&gt;gt&lt;/strong&gt; then &lt;strong&gt;Upper Bollinger Band&lt;/strong&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;add-the-rules&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Add the rules&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;When the &lt;strong&gt;close&lt;/strong&gt; is greater than the &lt;strong&gt;upper Bollinger Band&lt;/strong&gt; we go short by a quantity of 100 at the market price&lt;/li&gt;
&lt;li&gt;When the &lt;strong&gt;close&lt;/strong&gt; is lower than the &lt;strong&gt;lower Bollinger Band&lt;/strong&gt; we go long by a quantity of 100 at the market price.&lt;/li&gt;
&lt;li&gt;When the &lt;strong&gt;Close&lt;/strong&gt; crosses the &lt;strong&gt;middle Bollinger Band&lt;/strong&gt; we exit all our positions.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Add rules

BBands_Strategy &amp;lt;- add.rule(
  BBands_Strategy,
  name = &amp;#39;ruleSignal&amp;#39;,
  arguments = list(
    sigcol = &amp;quot;Close.gt.UpperBBand&amp;quot;, 
    sigval = TRUE, 
    orderqty = -100, 
    ordertype = &amp;#39;market&amp;#39;,
    orderside = NULL,
    threshold = NULL),
  type = &amp;#39;enter&amp;#39;)

BBands_Strategy &amp;lt;- add.rule(
  BBands_Strategy, 
  name = &amp;#39;ruleSignal&amp;#39;,
  arguments = list(
    sigcol = &amp;quot;Close.lt.LowerBBand&amp;quot;,
    sigval = TRUE,
    orderqty = 100,
    ordertype = &amp;#39;market&amp;#39;,
    orderside = NULL,
    threshold = NULL),
  type = &amp;#39;enter&amp;#39;)

BBands_Strategy &amp;lt;- add.rule(
  BBands_Strategy,
  name = &amp;#39;ruleSignal&amp;#39;,
  arguments = list(
    sigcol = &amp;quot;Cross.MiddleBBand&amp;quot;,
    sigval = TRUE,
    orderqty = &amp;#39;all&amp;#39;,
    ordertype = &amp;#39;market&amp;#39;,
    orderside = NULL,
    threshold = NULL),
  type = &amp;#39;exit&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Apply the strategy and update the portfolio&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;out &amp;lt;- applyStrategy(
  strategy = BBands_Strategy,
  portfolios = &amp;#39;BollingerBandsStrat&amp;#39;,
  parameters = list( 
    sd = 1.6, # number of standard deviations
    n = 20) # MA periods
  )

updatePortf(Portfolio = &amp;#39;BollingerBandsStrat&amp;#39;, Dates = paste(&amp;#39;::&amp;#39;,as.Date(Sys.time()),sep=&amp;#39;&amp;#39;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Find the best performance stocks:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tradeStats(portfolio.st) %&amp;gt;% 
  tibble::rownames_to_column(&amp;quot;ticker&amp;quot;) %&amp;gt;%
  t() %&amp;gt;% 
  kable() %&amp;gt;%
  kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ticker
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
A
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AA
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AAPL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ABBV
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ADI
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMD
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMZN
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
APD
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CF
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
HOG
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
NVDA
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
WMT
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Portfolio
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
BollingerBandsStrat
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Symbol
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
A
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AA
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AAPL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ABBV
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ADI
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMD
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMZN
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
APD
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CF
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
HOG
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
NVDA
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
WMT
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Num.Txns
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
181
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
188
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
163
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
182
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
172
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
165
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
176
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
171
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
175
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
182
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
201
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
184
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Num.Trades
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
70
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
68
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
57
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
63
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
67
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
64
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
62
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
71
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
71
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
68
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
73
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
66
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Net.Trading.PL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
3302.7855
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-663.6981
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-5547.4283
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-288.0025
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1756.0009
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
966.0000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
34942.0472
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
8510.1655
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
7601.2010
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
4524.0020
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-2515.9992
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
3987.0002
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Avg.Trade.PL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
48.525511
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-6.774974
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-97.323304
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-2.285762
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
26.208969
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
16.046875
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
529.436174
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
119.861486
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
107.059169
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
66.529441
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-34.465742
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
60.545452
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Med.Trade.PL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
66.88130
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
76.89585
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
159.99990
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
77.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
84.99980
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
18.50000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1180.00030
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
148.01180
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
129.00010
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
122.99995
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
35.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
42.00020
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Largest.Winner
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
711.7301
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
995.0003
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
965.1434
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
920.9999
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1265.0001
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
152.0000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
9117.9932
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1882.5164
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
939.4002
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1174.0003
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1655.0003
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1356.0006
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Largest.Loser
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-528.0000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-3104.6764
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-11317.0036
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1817.0016
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-2617.0005
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-414.0000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-13718.9819
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1626.9989
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-903.9999
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1227.0002
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-4844.0012
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1395.0009
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Gross.Profits
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
6415.110
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
8216.008
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
15231.716
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
8640.999
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
9168.000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2080.000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
96296.006
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
16046.256
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
11782.200
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
11733.502
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
11577.998
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
9388.999
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Gross.Losses
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-3018.324
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-8676.707
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-20779.144
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-8785.002
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-7411.999
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1053.000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-63470.963
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-7536.091
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-4180.999
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-7209.500
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-14093.998
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-5392.999
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Std.Dev.Trade.PL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
175.69143
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
525.90402
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1607.09458
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
413.50580
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
444.63931
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
80.12096
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
3565.68276
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
463.03163
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
276.80923
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
404.27517
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
794.13687
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
370.13593
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Std.Err.Trade.PL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
20.99914
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
63.77523
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
212.86488
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
52.09683
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
54.32134
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
10.01512
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
452.84216
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
54.95174
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
32.85121
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
49.02557
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
92.94669
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
45.56058
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Percent.Positive
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
65.71429
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
72.05882
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
68.42105
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
66.66667
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
71.64179
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
78.12500
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
67.74194
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
67.60563
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
76.05634
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
64.70588
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
61.64384
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
72.72727
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Percent.Negative
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
34.28571
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
27.94118
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
31.57895
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
33.33333
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
28.35821
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
20.31250
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
32.25806
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
32.39437
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
23.94366
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
35.29412
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
38.35616
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
25.75758
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Profit.Factor
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2.1253880
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.9469040
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.7330290
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.9836081
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.2369133
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.9753086
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.5171663
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2.1292547
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2.8180346
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.6275056
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.8214843
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.7409606
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Avg.Win.Trade
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
139.4589
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
167.6736
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
390.5568
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
205.7381
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
191.0000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
41.6000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2292.7620
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
334.2970
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
218.1889
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
266.6705
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
257.2889
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
195.6041
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Med.Win.Trade
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
111.23030
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
93.71700
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
410.00060
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
189.00015
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
132.49990
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
31.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1834.00115
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
223.84460
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
179.20000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
180.99995
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
91.99980
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
98.99985
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Avg.Losing.Trade
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-125.7635
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-456.6688
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1154.3969
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-418.3334
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-390.1052
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-81.0000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-3173.5481
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-327.6561
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-245.9411
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-300.3958
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-503.3571
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-317.2352
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Med.Losing.Trade
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-93.50035
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-129.76180
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-400.99975
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-288.99940
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-142.00030
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-33.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1961.00005
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-205.00030
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-166.99940
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-155.50005
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-138.99980
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-136.00040
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Avg.Daily.PL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
48.525511
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-6.774974
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-97.323304
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-2.285762
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
26.208969
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
16.046875
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
529.436174
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
119.861486
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
107.059169
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
66.529441
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-34.465742
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
60.545452
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Med.Daily.PL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
66.88130
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
76.89585
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
159.99990
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
77.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
84.99980
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
18.50000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1180.00030
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
148.01180
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
129.00010
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
122.99995
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
35.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
42.00020
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Std.Dev.Daily.PL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
175.69143
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
525.90402
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1607.09458
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
413.50580
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
444.63931
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
80.12096
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
3565.68276
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
463.03163
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
276.80923
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
404.27517
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
794.13687
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
370.13593
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Std.Err.Daily.PL
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
20.99914
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
63.77523
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
212.86488
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
52.09683
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
54.32134
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
10.01512
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
452.84216
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
54.95174
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
32.85121
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
49.02557
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
92.94669
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
45.56058
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Ann.Sharpe
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
4.38449749
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-0.20450380
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-0.96133704
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-0.08775051
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.93571231
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
3.17939560
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2.35706295
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
4.10931348
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
6.13964943
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2.61238437
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-0.68895769
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2.59669262
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Max.Drawdown
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1221.745
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-4652.209
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-12870.005
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-4976.003
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-3965.999
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-669.000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-48292.017
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-2705.000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1757.999
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-3237.000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-14917.000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-3010.999
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Profit.To.Max.Draw
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2.70333546
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-0.14266301
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-0.43103544
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-0.05787828
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.44276383
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.44394619
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.72355742
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
3.14608694
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
4.32378029
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.39759098
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-0.16866657
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.32414540
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Avg.WinLoss.Ratio
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.1088981
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.3671669
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.3383211
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.4918040
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.4896115
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.5135802
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.7224601
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.0202679
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.8871590
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.8877303
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.5111458
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.6165902
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Med.WinLoss.Ratio
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.1896244
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.7222233
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.0224460
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.6539811
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.9330959
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.9393939
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.9352377
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.0919233
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.0730577
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.1639864
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.6618700
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.7279379
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Max.Equity
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
3659.7860
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1090.9615
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
6834.5749
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
607.9984
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2919.9995
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1058.0000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
37225.0306
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
9494.1666
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
7601.2010
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
6193.0030
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2511.9993
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
4036.9994
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Min.Equity
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-555.0795
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-3561.2473
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-6035.4303
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-4687.0026
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1045.9995
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-101.0000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-11066.9863
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-848.2877
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-1744.5987
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-847.9955
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-12405.0003
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-2489.9988
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
End.Equity
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
3302.7855
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-663.6981
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-5547.4283
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-288.0025
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1756.0009
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
966.0000
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
34942.0472
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
8510.1655
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
7601.2010
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
4524.0020
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
-2515.9992
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
3987.0002
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Performance plots and trade statistics&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;for(sym in symbols){
  chart.Posn(Portfolio = &amp;#39;BollingerBandsStrat&amp;#39;, Symbol = sym)
  plot(add_BBands(on = 1, sd = 1.6, n = 20))
  
  perf &amp;lt;- tradeStats(portfolio.st) %&amp;gt;% 
    tibble::rownames_to_column(&amp;quot;ticker&amp;quot;) %&amp;gt;% 
    filter(ticker == sym) %&amp;gt;% 
    t() %&amp;gt;% 
    kable() %&amp;gt;%
    kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-2.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-3.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-4.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-5.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-6.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-7.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-8.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-9.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-10.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-11.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-12.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-13.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-14.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-15.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-16.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-17.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-18.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-19.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-20.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-21.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-22.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-23.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-12-24.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Zooming in one some of the charts, it’s possible to see when we entered and exited each trade.&lt;/p&gt;
&lt;div id=&#34;here---everything-works.-chart.posn-plots-each-plot-in-sequence-find-a-way-to-plot-it-in-one-instance.&#34; class=&#34;section level9&#34;&gt;
&lt;p&gt;Here - everything works. chart.posn plots each plot in sequence find a way to plot it in one instance.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chart.Posn(Portfolio = &amp;#39;BollingerBandsStrat&amp;#39;, Symbol = &amp;quot;AMD&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-13-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(add_BBands(on = 1, sd = 1.6, n = 20))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-13-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;zoom_Chart(&amp;#39;2017-01::2017-03&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-13-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chart.Posn(Portfolio = &amp;#39;BollingerBandsStrat&amp;#39;, Symbol = &amp;quot;WMT&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-13-4.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(add_BBands(on = 1, sd = 1.6, n = 20))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-13-5.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;zoom_Chart(&amp;#39;2017-01::2017-03&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-13-6.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chart.Posn(Portfolio = &amp;#39;BollingerBandsStrat&amp;#39;, Symbol = &amp;quot;AMZN&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-13-7.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(add_BBands(on = 1, sd = 1.6, n = 20))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-13-8.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;zoom_Chart(&amp;#39;2017-01::2017-03&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/understanding-ttr-package/technical-trading-rules_files/figure-html/unnamed-chunk-13-9.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;adx-directional-movement-index&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;ADX: Directional Movement Index&lt;/h2&gt;
&lt;p&gt;The Directional Movement Index (DMI) &lt;span class=&#34;citation&#34;&gt;Wilder (&lt;a href=&#34;#ref-wilder1978new&#34; role=&#34;doc-biblioref&#34;&gt;1978&lt;/a&gt;)&lt;/span&gt; tries to identify the direction an asset is moving towards through comparing previous highs and lows. It trys to determine if an asset is trending and to measure the strength of that trend. It has four components:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Positive Direction Indicator (+DI): Computes the difference between todays high and the previous days high. - Helps identify the presence of an uptrend.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Negative Direction Indicator (-DI): Computes the difference between todays low and the previous days low. - Helps identify the presence of a downtrend.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Average Directional Index (ADX): A smoothed average of the difference of the +DI and -DI.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Average Directional Rating (ADXR): Simple average of todays ADX and the ADX from 14 or n periods previously.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The ADX is relative to its own asset price. An ADX of 60 for &lt;span class=&#34;math inline&#34;&gt;\(Asset_{i}\)&lt;/span&gt; is different to an ADX for &lt;span class=&#34;math inline&#34;&gt;\(Asset_{j}\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Using the &lt;code&gt;TTR&lt;/code&gt; package along with the &lt;code&gt;tidyquant&lt;/code&gt; package in R we can calculate the &lt;code&gt;ADX&lt;/code&gt; using:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# adx_calc &amp;lt;- asset_prices %&amp;gt;% 
#   group_by(symbol) %&amp;gt;% 
#   tq_mutate(
#     select = c(&amp;quot;high&amp;quot;, &amp;quot;low&amp;quot;, &amp;quot;close&amp;quot;),
#     mutate_fun = ADX,
#     n = 14,
#     maType = &amp;quot;SMA&amp;quot;
#     )

# adx_calc %&amp;gt;% 
#   group_by(symbol) %&amp;gt;% 
#   drop_na() %&amp;gt;% 
#   slice(1:5)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The first few observations of each of the assets looks like:&lt;/p&gt;
&lt;p&gt;Where the newely created columns are defined as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;DIp&lt;/code&gt;: Directional Index positive&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DIn&lt;/code&gt;: Directional Index negative&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DX&lt;/code&gt;: Directional Index&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ADX&lt;/code&gt;: Average Directional Index which takes on values between 0 and 100&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As defined previously.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;adx-trend-strength&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;ADX Trend Strength&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;ADX Value&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;Strength&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;0-25&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Weak Trend&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;26-50&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Strong Trend&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;51-75&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Very Strong&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;76-100&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Strongestng&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We can plot the ADX using the following, where I first put the Directional Index columns to longer format using the &lt;code&gt;pivot_longer&lt;/code&gt; function and then take a random sample of the grouped data using a combination of &lt;code&gt;group_by&lt;/code&gt;, &lt;code&gt;nest&lt;/code&gt; and &lt;code&gt;sample_n&lt;/code&gt;. Finally I filter the data between a period of 3 months and use &lt;code&gt;ggplot&lt;/code&gt; to plot the data.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# adx_calc %&amp;gt;% 
#   pivot_longer(
#     cols = c(&amp;quot;DIp&amp;quot;, &amp;quot;DIn&amp;quot;, &amp;quot;ADX&amp;quot;),
#     names_to = &amp;quot;Indicator&amp;quot;,
#     values_to = &amp;quot;Indicator_value&amp;quot;
#     ) %&amp;gt;%  
#   group_by(symbol) %&amp;gt;%
#   nest() %&amp;gt;%
#   ungroup() %&amp;gt;% 
#   sample_n(2) %&amp;gt;%
#   unnest() %&amp;gt;% 
#   filter(date &amp;gt; &amp;quot;2014-09-01&amp;quot; &amp;amp; date &amp;lt; &amp;quot;2015-01-01&amp;quot;) %&amp;gt;% 
#   ggplot(aes(x = date, y = Indicator_value, color = Indicator)) +
#   geom_line() +
#   geom_dl(aes(label = Indicator), method = list(dl.combine(&amp;quot;first.points&amp;quot;, &amp;quot;last.points&amp;quot;))) +
#   facet_wrap(~symbol, scales = &amp;quot;free&amp;quot;) +
#   theme_tq()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can create a simple trading strategy based on the &lt;code&gt;ADX&lt;/code&gt; by:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Adding a buy signal when the &lt;code&gt;DIp&lt;/code&gt; is greater than the &lt;code&gt;DIn&lt;/code&gt; and also when the &lt;code&gt;ADX&lt;/code&gt; is greater than 30.&lt;/li&gt;
&lt;li&gt;We will hold the asset until the &lt;code&gt;DIp&lt;/code&gt; is less than the &lt;code&gt;DIn&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;This creates multiple consecutive rows of &lt;code&gt;1&lt;/code&gt;’s followed by consecutive rows of &lt;code&gt;-1&lt;/code&gt;’s. Since we cannot “buy”, “buy” and “buy” and then followed by “sell”, “sell” and “sell” we will only take the first occurrence of the first “buy” and the first “sell”. I call this &lt;code&gt;buy_here&lt;/code&gt; and &lt;code&gt;sell_here&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# adx_signals &amp;lt;- adx_calc %&amp;gt;% 
#   mutate(
#     adx_signal_buy = case_when(
#       DIp &amp;gt; DIn &amp;amp; ADX &amp;gt; 30 ~ 1,
#       TRUE ~ 0
#       ),
#     adx_signal_buy_hold_until = case_when(
#       DIp &amp;lt; DIn ~ -1,
#       TRUE ~ 0
#       )
#     ) %&amp;gt;% 
#   group_by(grp = rleid(adx_signal_buy)) %&amp;gt;% 
#   mutate(buy_here = +(all(adx_signal_buy == 1) * row_number() == 1)) %&amp;gt;%
#   ungroup %&amp;gt;%
#   group_by(grp = rleid(adx_signal_buy_hold_until)) %&amp;gt;%
#   mutate(sell_here = -1 *(all(adx_signal_buy_hold_until == -1) * row_number() == 1)) %&amp;gt;%
#   ungroup %&amp;gt;%
#   select(-grp)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-wilder1978new&#34;&gt;
&lt;p&gt;Wilder, J Welles. 1978. &lt;em&gt;New Concepts in Technical Trading Systems&lt;/em&gt;. Trend Research.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Factor Modeling in R</title>
      <link>/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation/</link>
      <pubDate>Thu, 14 Nov 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation/</guid>
      <description>
&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/jquery/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/threejs/three.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/threejs/Detector.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/threejs/Projector.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/threejs/CanvasRenderer.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/threejs/TrackballControls.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/threejs/StateOrbitControls.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/scatterplotThree-binding/scatterplotThree.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/crosstalk/css/crosstalk.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/crosstalk/js/crosstalk.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/plotly-binding/plotly.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/typedarray/typedarray.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/plotly-main/plotly-latest.min.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;The most popular models for analysing the risk of portfolios are factor models, since stocks have a tendency to move together. The principal component of securities often explains a large share of it’s variance. Since we are mostly concerned with multiple assets which form a portfolio we need to account for this. Some questions might be &lt;em&gt;why do stocks with low Price to Book ratios outperform stocks with higher Price to Book ratios?&lt;/em&gt; Here the “Price” part of the ratio is simply the share price (per share) and the “Book” part of the ratio is the “Shareholders Equity” / “Shares Outstanding” which are items found on a companies Balance Sheet.&lt;/p&gt;
&lt;p&gt;Another important reason Factor models are popular are dimensionality. Assume &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; assets which subsequently has &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; variances and &lt;span class=&#34;math inline&#34;&gt;\(N(N-1)/2\)&lt;/span&gt; correlations. If we have a factor model with &lt;span class=&#34;math inline&#34;&gt;\(F\)&lt;/span&gt; factors, it has &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; idiosyncratic variances, &lt;span class=&#34;math inline&#34;&gt;\(F\)&lt;/span&gt; factor variances and &lt;span class=&#34;math inline&#34;&gt;\(NF\)&lt;/span&gt; betas. As long as:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[2F &amp;lt; N(N-1)/(N+1)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We have fewer parameters with factor models.&lt;/p&gt;
&lt;p&gt;The Capital Asset Pricing Model &lt;span class=&#34;citation&#34;&gt;Sharpe (&lt;a href=&#34;#ref-sharpe1964capital&#34; role=&#34;doc-biblioref&#34;&gt;1964&lt;/a&gt;)&lt;/span&gt; is the simplest factor model consisting of a single factor.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[r_i = a_i + b_if + e_i\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The mean-variance parameters are:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\overline{r}_i = a_{i} + b_{i}\overline{y}\]&lt;/span&gt;
&lt;span class=&#34;math display&#34;&gt;\[\sigma_{i}^2 = b_{i}^2\sigma_{\epsilon_{i}}^2\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\sigma_{ij} = b_{i}b_{j}\sigma_{y}^2\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The &lt;span class=&#34;math inline&#34;&gt;\(Cov(r_{i}, y) = Cov(a_{i} + b_{i}y + e_{i}, y) = b_{i}\sigma_{y}^2\)&lt;/span&gt; and therefore &lt;span class=&#34;math inline&#34;&gt;\(b_{i}\)&lt;/span&gt; is;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[b_{i} = \dfrac{Cov(r_{i}, y)}{\sigma_{y}^2}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This is alternatively expressed as;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[b_{i} = Cov(r_{i}, y) / Var(y)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Where &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; is the slope of the regression line which minimises the squared distance of returns and &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; is the intercept or &lt;span class=&#34;math inline&#34;&gt;\(alpha\)&lt;/span&gt; which are expressed on a line &lt;span class=&#34;math inline&#34;&gt;\(a + bf\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;I will go through these calculations using &lt;em&gt;Base R&lt;/em&gt; functions, however first we need some data and for this I like the &lt;em&gt;tidy&lt;/em&gt; functions which require a few packages.&lt;/p&gt;
&lt;p&gt;I download daily price data from Yahoo Finance using &lt;code&gt;quantmod&lt;/code&gt; or &lt;code&gt;tidyquant&lt;/code&gt;’s wrapper to the &lt;code&gt;quantmod&lt;/code&gt; package. The difference here being that &lt;code&gt;quantmod&lt;/code&gt; collects data and stores it as an &lt;code&gt;xts&lt;/code&gt; object and &lt;code&gt;tidyquant&lt;/code&gt; collects the data and stores it as a &lt;code&gt;tibble&lt;/code&gt;, from here we are able to more easily use functions from the &lt;code&gt;tidyverse&lt;/code&gt; way of handling data, we convert the data back to an &lt;code&gt;xts&lt;/code&gt; object using the &lt;code&gt;tk_xts&lt;/code&gt; function from the &lt;code&gt;timetk&lt;/code&gt; package.&lt;/p&gt;
&lt;p&gt;The firms are Apple, Harley Davidson, Nvidia, Microsoft, AMD, Ford, General Electric, 3M, Intel and Amazon.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(quantmod)
library(ggplot2)
library(tidyquant)
library(tidyr)
library(dplyr)
library(timetk)
library(tibble)
library(rvest)
library(corrplot) 
library(stringr)

start_date &amp;lt;- &amp;quot;2017-01-01&amp;quot;
end_date &amp;lt;- &amp;quot;2019-01-01&amp;quot;

symbols &amp;lt;- c(&amp;quot;AAPL&amp;quot;, &amp;quot;HOG&amp;quot;, &amp;quot;NVDA&amp;quot;, &amp;quot;MSFT&amp;quot;, &amp;quot;AMD&amp;quot;, &amp;quot;F&amp;quot;, &amp;quot;GE&amp;quot;, &amp;quot;MMM&amp;quot;, &amp;quot;INTL&amp;quot;, &amp;quot;AMZN&amp;quot;)

portfolio_prices &amp;lt;- tq_get(
  symbols,
  from = start_date,
  to = end_date
  ) %&amp;gt;%
  select(symbol, date, adjusted) %&amp;gt;% 
  pivot_wider(names_from = symbol, values_from = adjusted) %&amp;gt;% 
  tk_xts(date_var = date)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The data looks like the following, I removed the &lt;code&gt;Open&lt;/code&gt;, &lt;code&gt;High&lt;/code&gt;, &lt;code&gt;Low&lt;/code&gt;, &lt;code&gt;Close&lt;/code&gt; and &lt;code&gt;Volume&lt;/code&gt; data and kept just the &lt;code&gt;Adjusted&lt;/code&gt; prices, where each asset is it’s own column, the data has been converted into a time series object or an &lt;code&gt;xts&lt;/code&gt; object where the &lt;code&gt;date&lt;/code&gt; is stored as the index (or rownames) and is not visable in the table below.&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MMM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
INTL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
110.9539
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53.59669
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.0116
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.49657
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11.43
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.43042
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.13062
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
165.3643
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40.41
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
753.67
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
110.8297
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
54.18777
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
103.3683
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.23036
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11.43
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.91093
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.13950
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
165.6151
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40.86
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
757.18
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
111.3933
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
54.24233
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.7443
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.23036
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11.24
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.57954
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27.97971
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
165.0485
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.77
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
780.45
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
112.6351
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53.74219
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
102.0910
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.74376
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11.32
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.57126
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.05961
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
165.5315
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.71
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
795.99
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
113.6668
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
52.87832
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106.2301
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.55362
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11.49
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.46355
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27.92646
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
164.6399
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.33
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
796.92
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
113.7815
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53.19659
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.4280
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.53460
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11.44
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.64582
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27.84656
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
163.9991
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.46
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
795.90
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;I also collect the S&amp;amp;P500 data using the same method:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;SPY &amp;lt;- tq_get(
  &amp;quot;^GSPC&amp;quot;,
  from = start_date,
  to = end_date
) %&amp;gt;% 
  select(date, adjusted) %&amp;gt;% 
  tk_xts(date_var = date)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which looks similar to the individual asset prices.&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
adjusted
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2257.83
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2270.75
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2269.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2276.98
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2268.90
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2268.90
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We can plot the data using the &lt;code&gt;chartSeries&lt;/code&gt; function.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chartSeries(SPY)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;I compute the daily log returns for all the assets in the &lt;code&gt;portfolio_returns&lt;/code&gt; and the &lt;code&gt;SPY&lt;/code&gt; returns&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;portfolio_returns &amp;lt;- diff(log(portfolio_prices), na.pad = FALSE)
SPY_returns &amp;lt;- diff(log(SPY), na.pad = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The returns data for each asset looks like:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MMM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
INTL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001119731
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.010967925
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.023062871
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0044844490
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0450387901
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003155849
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001515279
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.011074335
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004646413
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005072384
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001006252
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.025713094
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016762633
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0308429974
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0056944999
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.003426713
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.052504862
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.030269695
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.011086527
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.009263191
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.013278832
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0086305184
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.007092228
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0007833275
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0028513212
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002921873
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001548813
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.019715919
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.009117836
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016204986
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.039742771
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0031877844
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.014906019
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0102405428
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0047565496
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.005400948
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.009865007
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001167666
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001008053
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.006000910
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.007578959
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0003193095
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004361106
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0172690614
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0028650791
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.003899774
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003385783
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001280696
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005358706
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008411454
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012380417
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0090613598
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.021202208
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0141067872
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0031828276
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.007391130
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.009059257
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003912422
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We can use the &lt;code&gt;autoplot&lt;/code&gt; to plot &lt;code&gt;xts&lt;/code&gt; or time series data with &lt;code&gt;ggplot&lt;/code&gt; functionality, (I only plot the first 3 assets):&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;autoplot(portfolio_returns[,1:3]) +
  xlab(&amp;quot;Date&amp;quot;) +
  ggtitle(&amp;quot;Asset Log Returns&amp;quot;) +
  theme_tq()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;div id=&#34;technical-r&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Technical R:&lt;/h3&gt;
&lt;div id=&#34;from-here-i-will-talk-a-little-more-technically-but-will-keep-it-as-simple-as-possible.&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;From here I will talk a little more &lt;em&gt;technically&lt;/em&gt; but will keep it as simple as possible.&lt;/h4&gt;
&lt;p&gt;Next I compute the calculations described at the begining of the post. We first need to define a few things:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The number of assets we have in the portfolio, denoted previously as &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;The number of days we apply our model which is usually denoted as &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;N_portfolio &amp;lt;- ncol(portfolio_prices)
days &amp;lt;- nrow(portfolio_prices)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;a-we-can-compute-beta-as-the-following&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;(a) We can compute &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; as the following:&lt;/h4&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;beta &amp;lt;- cov(portfolio_returns, SPY_returns) / as.numeric(var(SPY_returns))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which returns:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
adjusted
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AAPL
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.2722563
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
HOG
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.8957108
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
NVDA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.9681667
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
MSFT
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.4221581
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMD
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.8544079
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.8626349
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;However, in order to understand it better we can break it down each of the computations:&lt;/p&gt;
The &lt;span class=&#34;math inline&#34;&gt;\(cov\)&lt;/span&gt; covariance matrix part of the &lt;span class=&#34;math inline&#34;&gt;\(beta\)&lt;/span&gt; formula looks like:
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
adjusted
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AAPL
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000852
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
HOG
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000600
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
NVDA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001318
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
MSFT
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000953
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMD
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001242
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000578
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000548
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
MMM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000714
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
INTL
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000576
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMZN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001056
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We can compute the covariances using base R as follows:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[Cov(x, y) = \sum_{i=1}^N \dfrac{((x_i - \overline{x}) (y_{i} - \overline{y}))}{(n-1)}\]&lt;/span&gt;
Where &lt;span class=&#34;math inline&#34;&gt;\(x_{i}\)&lt;/span&gt; is our asset and &lt;span class=&#34;math inline&#34;&gt;\(y_{i}\)&lt;/span&gt; is the SPY500. In R we can compute this as:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;x = portfolio_returns[,1] # which takes the first Asset in the portfolio_returns data
x_bar = colMeans(x)

y = SPY_returns[,1]
y_bar = colMeans(y)

n = length(x)
sum(((x - x_bar)*(y - y_bar))) / (n-1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.00008521578&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which corresponds to the first result, &lt;code&gt;AAPL&lt;/code&gt; in the &lt;code&gt;cov(portfolio_returns, SPY_returns)&lt;/code&gt; calculation. We can change the &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; in &lt;code&gt;x = portfolio_returns[,1]&lt;/code&gt; to &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt; … &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; to compute the covariances for each of the assets (&lt;code&gt;HOG&lt;/code&gt;, &lt;code&gt;NVDA&lt;/code&gt; and &lt;code&gt;MSFT&lt;/code&gt;, respectively), or we can wrap the above into a &lt;em&gt;for loop&lt;/em&gt; to compute for all assets. &lt;strong&gt;Note:&lt;/strong&gt; I only changed the &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; to an &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; from the above equation in the &lt;em&gt;for loop&lt;/em&gt;, everything else is constant.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;for(i in 1:ncol(portfolio_returns)){
  x = portfolio_returns[,i]
  x_bar = colMeans(x)
  y = SPY_returns[,1]
  y_bar = colMeans(y)
  cov_x_y = sum(((x - x_bar)*(y - y_bar))) / (n-1)
  print(cov_x_y)
}&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.00008521578
## [1] 0.00005999475
## [1] 0.0001318279
## [1] 0.00009525621
## [1] 0.0001242083
## [1] 0.00005777932
## [1] 0.00005477266
## [1] 0.00007136762
## [1] 0.0000575575
## [1] 0.0001056044&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The variance of the SPY returns is.&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
x
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000067
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Which is calculated as:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[Var = \sum(\dfrac{((y - \overline{y})^2)} {(n-1)})\]&lt;/span&gt;
In base R we can simply calculate it as:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;n = length(SPY_returns)
y = SPY_returns[,1]
y_bar = colMeans(y)

sum(((y - y_bar)**2) / (n-1))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.00006698004&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Putting all this together, we can compute &lt;span class=&#34;math inline&#34;&gt;\(beta\)&lt;/span&gt;. Recall, that &lt;span class=&#34;math inline&#34;&gt;\(\beta = \dfrac{Cov(r_{i}, y)}{Var(y)}\)&lt;/span&gt; where here &lt;span class=&#34;math inline&#34;&gt;\(r_{i}\)&lt;/span&gt; is each of our assets in our portfolio and &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; is the &lt;em&gt;market&lt;/em&gt; returns or SPY500 returns.&lt;/p&gt;
&lt;p&gt;To compute &lt;span class=&#34;math inline&#34;&gt;\(beta\)&lt;/span&gt; for each of our assets using base R we can wrap the above code into a function:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;myBetaComputation &amp;lt;- function(ASSET){
  x = ASSET                   # which Asset in the portfolio_returns data we want to compute beta for.
  x_bar = colMeans(x)
  
  y = SPY_returns[,1]
  y_bar = colMeans(y)
  
  cov_x_y &amp;lt;- sum(((x - x_bar)*(y - y_bar))) / (n-1)
  
  
  n = length(SPY_returns)
  y = SPY_returns[,1]
  y_bar = colMeans(y)
  
  var_y &amp;lt;- sum(((y - y_bar)**2) / (n-1))
  
  return(cov_x_y / var_y)
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can apply this function to individual assets in our data and then all of them:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;myBetaComputation(portfolio_returns[,1])        # Computes for the first asset&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 1.272256&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;myBetaComputation(portfolio_returns[,2])        # Computes for the second asset&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.8957108&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sapply(portfolio_returns, myBetaComputation)    # Computes for all assets&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##      AAPL       HOG      NVDA      MSFT       AMD         F        GE       MMM 
## 1.2722563 0.8957108 1.9681667 1.4221581 1.8544079 0.8626349 0.8177459 1.0655057 
##      INTL      AMZN 
## 0.8593232 1.5766544&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The interpretation here is that a value of 1 indicates that the asset moves in perfect correlation with the market, values &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;\)&lt;/span&gt; 1 indicate that an asset moves more than when the market moves or moves with more volatility when the market moves and values &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;\)&lt;/span&gt; 1 indicates that an asset moves less than the market.&lt;/p&gt;
&lt;p&gt;Typically Tech stocks have a higher market &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; whereas mature non-tech stocks have a lower market &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;. That is, AAPL, NVDA, MSFT and AMD all have betas above 1 whereas HOG and Ford (F) have &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;’s less than 1.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;b-we-can-compute-alpha-as-the-following&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;(b) We can compute &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; as the following:&lt;/h4&gt;
&lt;p&gt;Now that we have &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; we can estimate &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; for each of our assets in our portfolio.&lt;/p&gt;
&lt;p&gt;Recall, that alpha is defined as;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\alpha = \overline{r_{i}} - \beta_{i}*\overline{f}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Where &lt;span class=&#34;math inline&#34;&gt;\(\overline{r_{i}}\)&lt;/span&gt; is the average returns of our individual assets in our portfolio, &lt;span class=&#34;math inline&#34;&gt;\(\beta_{i}\)&lt;/span&gt; is the beta of each asset over our sample period and &lt;span class=&#34;math inline&#34;&gt;\(\overline{f}\)&lt;/span&gt; is the average returns of SPY. Therefore, we can compute &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; as;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;alpha &amp;lt;- colMeans(portfolio_returns) - beta*colMeans(SPY_returns)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The alpha or &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; for our assests, looks like:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
adjusted
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AAPL
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0004068
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
HOG
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0011516
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
NVDA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001393
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
MSFT
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0007480
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMD
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005696
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0009272
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;There are other ways to calculate &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; but for a single factor model we can use the &lt;code&gt;CAPM.beta&lt;/code&gt; and &lt;code&gt;CAPM.alpha&lt;/code&gt; from the &lt;code&gt;PerformanceAnalytics&lt;/code&gt; package.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(PerformanceAnalytics)
CAPM.beta(Ra = portfolio_returns, Rb = SPY_returns, Rf = 0)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                    AAPL       HOG     NVDA     MSFT      AMD         F
## Beta: adjusted 1.272256 0.8957108 1.968167 1.422158 1.854408 0.8626349
##                       GE      MMM      INTL     AMZN
## Beta: adjusted 0.8177459 1.065506 0.8593232 1.576654&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;CAPM.alpha(Ra = portfolio_returns, Rb = SPY_returns, Rf = 0)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                        AAPL          HOG         NVDA         MSFT          AMD
## Alpha: adjusted 0.000406813 -0.001151611 0.0001393021 0.0007480208 0.0005695635
##                             F           GE           MMM          INTL
## Alpha: adjusted -0.0009272497 -0.002875334 0.00001141014 -0.0003782044
##                        AMZN
## Alpha: adjusted 0.001047154&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which is much simpler than what we just did. The &lt;code&gt;Ra&lt;/code&gt; is the asset returns, &lt;code&gt;Rb&lt;/code&gt; is the market returns and &lt;code&gt;Rf&lt;/code&gt; is the risk-free rate of return.&lt;/p&gt;
&lt;p&gt;Upon investigating the &lt;code&gt;CAPM.beta&lt;/code&gt; functions from the &lt;code&gt;PerformanceAnalytics&lt;/code&gt; package I noticed they had functions for &lt;code&gt;CAPM.beta.bull&lt;/code&gt; and &lt;code&gt;CAPM.beta.bear&lt;/code&gt;, so I wanted to see how these would look like plotted for each asset.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rbind(
  CAPM.beta.bull(Ra = portfolio_returns, Rb = SPY_returns, Rf = 0),
  CAPM.beta(Ra = portfolio_returns, Rb = SPY_returns, Rf = 0),
  CAPM.beta.bear(Ra = portfolio_returns, Rb = SPY_returns, Rf = 0)
) %&amp;gt;% 
  as_tibble(rownames = NA) %&amp;gt;% 
  rownames_to_column(&amp;quot;betas&amp;quot;) %&amp;gt;% 
  pivot_longer(2:ncol(.)) %&amp;gt;% 
  ggplot(aes(x = name, y = value, color = betas)) +
  geom_point(size = 5, shape = 19) +
  scale_color_brewer(type=&amp;#39;seq&amp;#39;, palette=&amp;#39;Reds&amp;#39;) +
  theme_tq() +
  ggtitle(&amp;quot;Asset Betas:&amp;quot;, subtitle = &amp;quot;Bear, Beta, Bull&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation_files/figure-html/unnamed-chunk-21-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Interesting…&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;visualising-the-covariance-matrix-of-the-returns&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Visualising the covariance matrix of the returns&lt;/h3&gt;
&lt;p&gt;In order to visualise the the covariance matrix some further formulas are needed.&lt;/p&gt;
&lt;p&gt;Ultimately we want to compute the following;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\hat{\Sigma} = var(y)\hat{\beta} \hat{\beta}^T + \hat{\psi}\]&lt;/span&gt;
Where;
&lt;span class=&#34;math display&#34;&gt;\[\hat{\psi} = diag(\hat{\sigma}_{1}^2, ... \hat{\sigma}_{i}^2, ... \hat{\sigma}_{N}^2)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We use our &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; results from before as well as &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;. I created a function which takes in the &lt;span class=&#34;math inline&#34;&gt;\(asset\)&lt;/span&gt; and computes the residules and Sigma values. What we are calculating here is the following;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;err&lt;/code&gt;
&lt;span class=&#34;math display&#34;&gt;\[\hat{\epsilon_{i}} = x_{i} - \alpha_{i} - \beta_{i}*y\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Where &lt;span class=&#34;math inline&#34;&gt;\(i = 1.,..., N\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Sigma&lt;/code&gt;
&lt;span class=&#34;math display&#34;&gt;\[\hat{\sigma}_{i}^2 = \dfrac{1} {N-2}\hat{\epsilon}_{i}^N\epsilon_{i}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The code in base R for the above equations is:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;beta &amp;lt;- cov(portfolio_returns, SPY_returns) / as.numeric(var(SPY_returns))
alpha &amp;lt;- colMeans(portfolio_returns) - beta*colMeans(SPY_returns)
N = length(SPY_returns)

mySigmaFunction &amp;lt;- function(ASSET){
  err = portfolio_returns[, ASSET] - alpha[ASSET ,] - beta[ASSET ,] * SPY_returns
  Sigma = (1 / (N - 2)) %*% t(err) %*% err
  return(Sigma)
}

mySigmaFunction(&amp;quot;AAPL&amp;quot;)                               # For Apple&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##              AAPL
## [1,] 0.0001178595&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mySigmaFunction(&amp;quot;F&amp;quot;)                                  # For Ford&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                 F
## [1,] 0.0001599711&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sapply(colnames(portfolio_returns), mySigmaFunction)  # For all assets in the portfolio&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##          AAPL           HOG          NVDA          MSFT           AMD 
## 0.00011785947 0.00021461371 0.00056144410 0.00006590872 0.00126760753 
##             F            GE           MMM          INTL          AMZN 
## 0.00015997110 0.00035027461 0.00007165307 0.00019184188 0.00017665040&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now that we have the &lt;span class=&#34;math inline&#34;&gt;\(\sigma\)&lt;/span&gt; values. we want to create a matrix with the Sigma values down the digaonal.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;Sigma2 &amp;lt;- sapply(colnames(portfolio_returns), mySigmaFunction)
diag_Sigma2 &amp;lt;- diag(Sigma2)
colnames(diag_Sigma2) = colnames(portfolio_returns)
rownames(diag_Sigma2) = colnames(portfolio_returns)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which creates our diagonal matrix as follows:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MMM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
INTL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AAPL
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001179
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
HOG
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0002146
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
NVDA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005614
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
MSFT
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000659
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMD
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0012676
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003503
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
MMM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000717
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
INTL
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001918
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMZN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001767
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Now that we have our diagonal matrix &lt;span class=&#34;math inline&#34;&gt;\(Diag(\psi)\)&lt;/span&gt; we can compute the covariance matrix of the returns using: &lt;span class=&#34;math display&#34;&gt;\[\Sigma = var(y)\beta \beta^T + \psi\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Then use the &lt;code&gt;cov2cor&lt;/code&gt; function from the &lt;code&gt;stats&lt;/code&gt; package.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;Sigma &amp;lt;- as.numeric(var(SPY_returns)) * beta %*% t(beta) + diag_Sigma2
corrplot(cov2cor(Sigma), main = &amp;quot;Covariance matrix of Portfolio Assets&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation_files/figure-html/unnamed-chunk-25-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The correlation table looks like:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AAPL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HOG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NVDA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MMM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
INTL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AMZN
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AAPL
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3097538
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3891498
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5677312
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2714307
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3373737
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2330694
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4966757
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3133839
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4821634
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
HOG
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3097538
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2515805
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3670311
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1754765
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2181079
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1506764
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3210946
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2025988
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3117126
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
NVDA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3891498
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2515805
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4611084
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2204547
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2740132
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1892978
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4033975
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2545288
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3916107
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
MSFT
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5677312
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3670311
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4611084
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3216216
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3997582
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2761668
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5885171
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3713324
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5713213
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMD
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2714307
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1754765
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2204547
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3216216
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1911233
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1320346
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2813684
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1775330
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2731471
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3373737
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2181079
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2740132
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3997582
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1911233
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1641118
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3497257
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2206640
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3395071
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2330694
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1506764
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1892978
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2761668
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1320346
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1641118
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2416026
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1524423
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2345432
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
MMM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4966757
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3210946
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4033975
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5885171
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2813684
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3497257
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2416026
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3248576
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4998164
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
INTL
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3133839
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2025988
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2545288
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3713324
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1775330
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2206640
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1524423
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3248576
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3153656
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AMZN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4821634
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3117126
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3916107
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5713213
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2731471
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3395071
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2345432
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4998164
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3153656
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0000000
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;etf-analysis-and-a-randomly-sampled-portfolio&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;ETF analysis and a randomly sampled portfolio&lt;/h2&gt;
&lt;div id=&#34;analysing-my-randomly-selected-portfolio-and-a-series-of-u.s.-funds&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Analysing my randomly selected portfolio and a series of U.S. funds&lt;/h4&gt;
&lt;p&gt;Since factor modelling is all about risk and portfolio analysis I thought it would be interesting to compare the performance of a number of U.S. Exchnage Traded Funds (ETFs) and a randomly selected portfolio of assets from the SP500.&lt;/p&gt;
&lt;p&gt;In order to construct the randomly created portfolio I first scraped the wikipedia page which contains the list of SP500 firms along with their &lt;em&gt;ticker&lt;/em&gt; symbol, I filter out all &lt;em&gt;Class A&lt;/em&gt;, &lt;em&gt;B&lt;/em&gt; and &lt;em&gt;C&lt;/em&gt; shares since a few firms have multiple asset classes and I don’t want to sample two of the same asset.&lt;/p&gt;
&lt;p&gt;Just as before I collect the data and put it into time series format.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;start_date &amp;lt;- &amp;quot;2016-01-01&amp;quot;
end_date &amp;lt;- &amp;quot;2017-12-31&amp;quot;

set.seed(4746)
url &amp;lt;- &amp;quot;https://en.wikipedia.org/wiki/List_of_S%26P_500_companies&amp;quot;

symbols &amp;lt;- url %&amp;gt;%
  read_html() %&amp;gt;%
  html_nodes(xpath = &amp;#39;//*[@id=&amp;quot;constituents&amp;quot;]&amp;#39;) %&amp;gt;% 
  html_table() %&amp;gt;% 
  .[[1]] %&amp;gt;% 
  filter(!str_detect(Security, &amp;quot;Class A|Class B|Class C&amp;quot;)) %&amp;gt;%     # Removes firms with Class A shares
  sample_n(20) %&amp;gt;% 
  pull(Symbol)

asset_prices &amp;lt;- tq_get(
  symbols,
  from = start_date,
  to = end_date
) %&amp;gt;%
  select(symbol, date, adjusted) %&amp;gt;% 
  pivot_wider(names_from = symbol, values_from = adjusted) %&amp;gt;% 
  tk_xts(date_var = date)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which looks like:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MMM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MNST
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
TJX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
TMUS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NWL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
INTC
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EIX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XRX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GPN
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HES
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
TIF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IR
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GRMN
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DRI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GLW
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ZTS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CCI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
BK
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
132.8015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.11333
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33.27088
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.95
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.54331
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30.45350
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.77293
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24.64223
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
62.47044
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.85172
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.47929
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.15904
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30.85206
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.28202
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16.24429
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.97239
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.96610
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36.90321
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
133.3804
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.69000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33.79228
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40.22
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.52557
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30.31014
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.79048
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24.59438
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
63.43876
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.74931
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.27712
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50.61163
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30.96944
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56.28635
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16.23521
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.69207
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.48198
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36.76471
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
130.6940
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.76667
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32.92327
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40.05
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.46084
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
29.63818
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.44798
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24.28336
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
63.63840
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41.95655
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67.00899
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49.53537
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30.12268
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.86901
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15.87241
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.70180
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.84963
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35.84144
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
127.5101
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.40000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32.87630
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40.51
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35.78388
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.52719
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.19327
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.61348
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
61.25259
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40.60672
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.17110
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.06017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
29.25916
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.47833
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15.50961
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.28187
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.98727
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.93664
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
127.0759
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.08333
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31.43894
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.88
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.94097
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.23153
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.18450
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22.94359
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
60.07465
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40.56948
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
62.72673
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47.60556
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.12736
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.06099
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15.55497
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.62054
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.96515
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.29958
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
127.0488
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.68000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31.84760
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.68
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.91435
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.72431
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.99249
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22.48903
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
58.41755
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.81003
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
62.34076
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47.76327
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27.83393
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.01660
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15.70009
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43.35622
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.49354
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.54886
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Next, I collect the U.S. ETFs. I scraped a website (which I cannot remember the name) for the symbols of the ETFs.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;myETFs &amp;lt;- c(&amp;quot;SPY&amp;quot;, &amp;quot;IVV&amp;quot;, &amp;quot;VTI&amp;quot;, &amp;quot;VOO&amp;quot;, &amp;quot;QQQ&amp;quot;, &amp;quot;VEA&amp;quot;, &amp;quot;IEFA&amp;quot;, &amp;quot;AGG&amp;quot;, &amp;quot;VWO&amp;quot;,
            &amp;quot;EFA&amp;quot;,&amp;quot;IEMG&amp;quot;,&amp;quot;VTV&amp;quot;, &amp;quot;IJH&amp;quot;, &amp;quot;IWF&amp;quot;,&amp;quot;BND&amp;quot;, &amp;quot;IJR&amp;quot;, &amp;quot;IWM&amp;quot;, &amp;quot;VUG&amp;quot;,
            &amp;quot;GLD&amp;quot;, &amp;quot;IWD&amp;quot;, &amp;quot;VIG&amp;quot;, &amp;quot;VNQ&amp;quot;, &amp;quot;USMV&amp;quot;, &amp;quot;LQD&amp;quot;, &amp;quot;VO&amp;quot;, &amp;quot;VYM&amp;quot;, &amp;quot;EEM&amp;quot;,
            &amp;quot;VB&amp;quot;, &amp;quot;VCSH&amp;quot;, &amp;quot;XLF&amp;quot;, &amp;quot;VCIT&amp;quot;, &amp;quot;VEU&amp;quot;, &amp;quot;XLK&amp;quot;, &amp;quot;ITOT&amp;quot;, &amp;quot;IVW&amp;quot;, &amp;quot;BNDX&amp;quot;,
            &amp;quot;VGT&amp;quot;, &amp;quot;DIA&amp;quot;, &amp;quot;BSV&amp;quot;, &amp;quot;SHV&amp;quot;, &amp;quot;IWB&amp;quot;, &amp;quot;IWR&amp;quot;, &amp;quot;TIP&amp;quot;, &amp;quot;SCHF&amp;quot;, &amp;quot;MBB&amp;quot;, &amp;quot;SDY&amp;quot;,
            &amp;quot;MDY&amp;quot;, &amp;quot;SCHX&amp;quot;, &amp;quot;IEF&amp;quot;, &amp;quot;HYG&amp;quot;, &amp;quot;DVY&amp;quot;, &amp;quot;XLV&amp;quot;, &amp;quot;SHY&amp;quot;, &amp;quot;IXUS&amp;quot;, &amp;quot;TLT&amp;quot;, &amp;quot;IVE&amp;quot;,
            &amp;quot;PFF&amp;quot;, &amp;quot;IAU&amp;quot;, &amp;quot;VXUS&amp;quot;, &amp;quot;RSP&amp;quot;, &amp;quot;SCHB&amp;quot;, &amp;quot;VV&amp;quot;, &amp;quot;GOVT&amp;quot;, &amp;quot;EMB&amp;quot;, &amp;quot;MUB&amp;quot;, &amp;quot;QUAL&amp;quot;,
            &amp;quot;XLY&amp;quot;, &amp;quot;VBR&amp;quot;, &amp;quot;EWJ&amp;quot;, &amp;quot;XLP&amp;quot;, &amp;quot;VGK&amp;quot;, &amp;quot;SPLV&amp;quot;, &amp;quot;MINT&amp;quot;, &amp;quot;BIV&amp;quot;, &amp;quot;IGSB&amp;quot;, &amp;quot;EFAV&amp;quot;,
            &amp;quot;VT&amp;quot;, &amp;quot;GDX&amp;quot;, &amp;quot;XLU&amp;quot;, &amp;quot;IWS&amp;quot;, &amp;quot;XLI&amp;quot;, &amp;quot;SCHD&amp;quot;, &amp;quot;IWP&amp;quot;, &amp;quot;ACWI&amp;quot;, &amp;quot;VMBS&amp;quot;, &amp;quot;XLE&amp;quot;, &amp;quot;JNK&amp;quot;,
            &amp;quot;VOE&amp;quot;, &amp;quot;FLOT&amp;quot;, &amp;quot;IWV&amp;quot;, &amp;quot;JPST&amp;quot;, &amp;quot;SCZ&amp;quot;, &amp;quot;IEI&amp;quot;, &amp;quot;IWN&amp;quot;, &amp;quot;DGRO&amp;quot;, &amp;quot;VBK&amp;quot;, &amp;quot;IGIB&amp;quot;, &amp;quot;IWO&amp;quot;)
            

etf_prices &amp;lt;- tq_get(
  myETFs,
  from = start_date,
  to = end_date
) %&amp;gt;% 
  select(symbol, date, adjusted) %&amp;gt;% 
  pivot_wider(names_from = symbol, values_from = adjusted) %&amp;gt;% 
  tk_xts(date_var = date)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The data looks like:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SPY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IVV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VTI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VOO
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
QQQ
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VEA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IEFA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AGG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VWO
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EFA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IEMG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VTV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IJH
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
BND
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IJR
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VUG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GLD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VIG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VNQ
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
USMV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
LQD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VO
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VYM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EEM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VCSH
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VCIT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VEU
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLK
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ITOT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IVW
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
BNDX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VGT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DIA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
BSV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SHV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWR
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
TIP
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SCHF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MBB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SDY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MDY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SCHX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IEF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HYG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DVY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SHY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IXUS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
TLT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IVE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
PFF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IAU
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VXUS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
RSP
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SCHB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GOVT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EMB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MUB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
QUAL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VBR
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EWJ
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLP
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VGK
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SPLV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MINT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
BIV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IGSB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EFAV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GDX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLU
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SCHD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWP
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ACWI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VMBS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
JNK
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VOE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
FLOT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
JPST
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SCZ
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IEI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWN
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DGRO
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VBK
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IGIB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWO
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
186.8362
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
187.3943
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.69553
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
171.0293
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.7754
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32.31758
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.12894
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.70714
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.82161
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.85117
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35.29821
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.21329
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
129.8436
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
93.32362
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.46418
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.13569
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
104.60918
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.84885
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
102.89
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
88.57166
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.16028
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67.15640
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.30936
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.1451
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
112.0916
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
58.70417
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
29.25530
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
103.10962
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.86420
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13.61419
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.99710
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.23042
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.89517
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.61963
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
107.9444
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.90886
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.77430
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
156.9451
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.18727
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.2681
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
104.11566
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.17856
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.8868
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24.86581
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.72220
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
63.99211
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
238.7614
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.54472
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.23306
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.49518
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.93277
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
66.68895
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.17432
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.14714
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
110.3894
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.04479
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31.46391
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.38
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.78462
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.26929
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.05346
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
85.64318
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.57018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87.65514
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.0075
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.58526
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.85894
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
90.46735
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.07748
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.11800
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43.21453
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.96312
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
93.40020
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.13937
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.21395
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
57.09138
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.90483
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13.86359
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.17657
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
62.81808
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.48287
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.12284
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87.50332
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50.81642
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.00686
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53.82844
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.80476
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
78.58987
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.91737
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
110.6951
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.01355
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115.1113
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
84.09489
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.20199
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115.5700
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47.86354
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
131.6090
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
187.1522
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
187.7839
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.90974
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
171.3355
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.5919
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32.28184
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.04810
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.75242
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.88509
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.77047
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35.38096
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.44967
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
129.9475
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
93.46677
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.55397
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.29261
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
104.83739
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.86796
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
103.18
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
88.74566
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.39217
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.45230
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.56908
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.1978
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
112.2051
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
58.99791
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
29.32071
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
103.16643
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.84602
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13.66662
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.01466
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.14082
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.79135
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.69417
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
108.1532
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.88116
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.28743
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
157.0367
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.17794
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.2777
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
104.32082
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.26314
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.8220
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24.83831
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.79476
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
64.25666
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
238.8375
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.63781
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.20529
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.61782
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
66.33069
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67.00954
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.12685
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.10166
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
109.9440
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.26437
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31.49616
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.40
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.71283
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.43853
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.09076
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
85.81048
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.54203
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87.88744
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.1264
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.74447
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.76409
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
90.67188
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.64425
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.40763
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.95955
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35.24865
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
93.40020
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.22964
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.19091
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
57.19847
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.91398
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13.79471
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.45059
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
62.96579
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.61266
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.31977
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87.66763
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50.86277
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.09793
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
54.03376
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.97237
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
78.76543
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.90808
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
110.9662
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.89528
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115.1582
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
84.47743
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.28449
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115.6185
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47.92159
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
131.6866
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
184.7914
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
185.3255
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
94.62438
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
169.1641
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
104.5776
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31.69214
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47.20373
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.12343
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.36815
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50.91853
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.74654
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.40415
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
128.1251
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
92.48373
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.87716
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50.70773
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
103.23986
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.76987
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
104.67
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87.39035
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.52956
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.26473
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.32790
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.5933
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
110.1342
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
58.22349
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.76008
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.62282
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.87331
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13.45691
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.25190
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.48678
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.30056
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.08852
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106.9669
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49.06577
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.91275
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
154.7919
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.26179
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.2586
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
102.94081
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36.64525
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
102.1459
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24.37987
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.11230
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
63.51594
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
235.4678
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.06064
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.79820
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.61782
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.65863
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
66.46268
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.17432
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43.33769
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
111.4255
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79.06572
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31.42361
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.57
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.03973
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.13145
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.53121
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
84.68593
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.63587
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87.87912
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.5744
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.03268
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.05276
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
89.25890
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.85076
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.25377
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.24736
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.93548
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
93.40947
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.53665
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.22778
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56.64514
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.14435
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14.02101
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.37987
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
61.87635
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47.86177
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33.90801
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
86.25658
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50.09352
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.20723
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.95383
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.90055
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
77.24093
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.90808
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
109.4701
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.14021
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115.4954
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
83.48843
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22.96364
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
113.8152
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47.99304
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
129.3380
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
180.3579
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
180.8912
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
92.30511
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
165.0441
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.3029
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31.09350
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.30547
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.11440
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27.45217
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49.86035
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33.69835
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.71315
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
124.8108
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
90.12631
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.88611
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49.40485
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.48224
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.22995
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106.15
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
85.32989
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.23102
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
66.93474
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.70643
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.6724
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
107.6568
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56.96841
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27.87242
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.88598
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.90975
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13.07825
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.29585
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36.68042
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.13966
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41.07753
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
104.2529
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.99192
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.69561
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
151.1452
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.37366
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.2681
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.43254
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35.80653
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
102.0626
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.93059
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.23930
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
62.23734
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
229.4516
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43.00870
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.01125
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.19263
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
64.49137
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.11437
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.20277
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.43728
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
111.6255
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
77.26316
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31.22207
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.72
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.23201
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.54225
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43.44009
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
82.62268
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.68278
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87.46435
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.7207
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
57.62780
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.57320
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87.00002
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.17064
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.71072
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41.46484
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.35522
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
93.40020
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.63598
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.24622
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.87762
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49.95324
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14.64089
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.12353
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
60.51917
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.56396
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33.20084
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
84.22703
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.92575
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.27098
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50.68622
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.46945
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.47622
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.91737
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106.8519
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43.46700
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115.7578
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
81.26778
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22.53279
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
110.6160
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.06894
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
125.7083
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
178.3782
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
178.8873
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
91.25257
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
163.2903
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.4722
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30.70930
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.71261
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.33157
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27.20731
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49.25951
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33.37653
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.87674
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
123.1961
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
89.22913
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.97586
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.58223
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.75159
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.33240
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.68
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
84.23099
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.51684
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
66.03955
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.32612
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.7515
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106.2667
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56.32751
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27.57342
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.51283
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.91882
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12.87435
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.32222
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36.24140
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.83765
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40.59300
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
103.2470
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.98268
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.86506
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
149.5692
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.45753
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.2777
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.38823
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35.36956
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
102.1459
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.63719
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.34815
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
61.63771
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
226.3864
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.52462
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.26135
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65.02093
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
64.04923
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
64.13377
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.25970
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41.90978
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
112.1254
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
76.28411
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31.31075
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.66
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.78327
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67.70534
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.94580
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
81.73975
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.71093
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87.38972
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.7664
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56.97219
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.81445
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
85.77296
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43.22602
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.36678
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41.10435
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.02365
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
93.39094
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.83461
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.27848
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.38676
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49.36685
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14.28668
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.10586
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.79903
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.09118
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32.84278
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
83.17358
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.36041
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.30741
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50.03457
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.18208
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.31207
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.88947
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.6269
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.88478
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115.9920
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79.95219
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22.25777
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
108.9970
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.12699
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
123.5344
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
178.5548
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
179.0729
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
91.19671
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
163.3088
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.7813
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30.84332
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45.87430
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.05104
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27.08941
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49.46577
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33.33975
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
69.83128
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
122.7901
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
89.27684
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72.67066
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.58699
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.32368
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.42790
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
104.74
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
84.19437
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68.66522
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
66.41467
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.38177
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.4263
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.7561
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56.38982
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27.56408
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.03933
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.98254
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12.89183
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.19040
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36.31308
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.08304
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40.58370
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
103.5317
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.92731
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.33284
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
150.1098
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.44821
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.2681
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.32295
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35.24034
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.6092
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.71054
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.25743
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
61.62007
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
225.7010
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.51531
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.94638
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
64.92279
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
64.19955
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
63.37006
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.28816
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41.99163
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
110.8984
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
76.18345
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31.14146
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10.57
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.86405
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67.48906
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.91782
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
81.75836
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.67340
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87.24041
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101.6019
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
57.05649
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70.36455
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
85.55912
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43.52830
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44.78313
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41.22744
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.09733
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
93.41876
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75.65400
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.26467
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.53847
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49.39434
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13.69632
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38.30916
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.57745
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.11899
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32.90544
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
82.78702
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.41602
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.23457
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.96336
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80.06235
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.02564
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.90808
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105.5428
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.95756
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115.8515
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79.92420
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22.32194
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
108.0954
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
48.04214
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
122.4960
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;I also collect the SPY500.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;SPY_prices &amp;lt;- tq_get(
  &amp;quot;^GSPC&amp;quot;,
  from = start_date,
  to = end_date
) %&amp;gt;% 
  select(date, adjusted) %&amp;gt;% 
  tk_xts(date_var = date)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which looks like:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
adjusted
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2012.66
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016.71
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1990.26
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1943.09
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1922.03
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1923.67
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Now, we have a series of 3 data sets, the daily prices of the adjusted close for the randomly selected assets from the SPY500 wikipedia page, the ETFs and the SPY500. Next I calculate the daily returns.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;asset_returns &amp;lt;- diff(log(asset_prices), na.pad = FALSE)
etf_returns &amp;lt;- diff(log(etf_prices), na.pad = FALSE)
SPY_returns &amp;lt;- diff(log(SPY_prices), na.pad = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;asset_returns&lt;/code&gt; looks like:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MMM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MNST
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
TJX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
TMUS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NWL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
INTC
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EIX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XRX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GPN
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HES
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
TIF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IR
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GRMN
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DRI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GLW
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ZTS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CCI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
BK
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0043496940
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.011914276
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.015549833
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.032085611
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0004605231
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004718686
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003390193
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001943595
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.015381467
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0022860685
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.002956558
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.010757820
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003797292
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0180042454
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0005589373
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0155331932
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.020287018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.003760040
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0203468502
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001573356
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.026052579
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004235761
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0280260856
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.022418948
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0066352645
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012726538
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003142188
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0644414487
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018747883
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.021494331
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.027722605
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0074420504
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0225996450
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0002084719
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008412745
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.025433678
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0246630740
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.007547151
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001427791
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.011420159
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0457985304
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.038205692
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0049630049
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.027973817
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.038210941
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0327010158
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.027810684
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.030233211
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.029085489
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0070174571
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0231226086
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0308759534
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.025196097
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.025568744
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0034106468
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.006564266
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.044704812
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015673838
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0238374478
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.010418300
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0001713849
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.028779059
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.019418177
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0009174858
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.038228556
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.009504269
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.039450060
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0075510143
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0029199836
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0147124623
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.014103137
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018403085
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0002136353
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.012332679
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.012914805
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.005027688
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0007621181
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.017304330
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0156624749
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.020011095
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.027971612
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0443372159
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.006172111
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003307394
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.010486917
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0008065403
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0092862449
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0287440451
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.007315467
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.007241532
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0028436862
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.008590726
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.016384277
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.009531073
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0156331210
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.019154091
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0033726404
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.013734922
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0514319659
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.008367407
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.016185405
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001507319
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0088375907
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0017316113
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0087102953
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004411381
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.007985230
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;However, I want to assume that I own all of these assets in a single portfolio. So I average over the rows and join the data to the ETFs and call it &lt;code&gt;all_returns&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;portfolio_returns &amp;lt;- xts(rowMeans(asset_returns), index(asset_returns))
colnames(portfolio_returns) &amp;lt;- c(&amp;quot;myPortfolio&amp;quot;)
all_returns &amp;lt;- cbind(portfolio_returns, etf_returns)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;all_returns&lt;/code&gt; data looks like the following, where we can now see &lt;code&gt;myPortfolio&lt;/code&gt; has been joined with the ETF dataset.&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
myPortfolio
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SPY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IVV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VTI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VOO
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
QQQ
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VEA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IEFA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
AGG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VWO
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EFA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IEMG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VTV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IJH
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
BND
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IJR
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VUG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GLD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VIG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VNQ
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
USMV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
LQD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VO
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VYM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EEM
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VCSH
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VCIT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VEU
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLK
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ITOT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IVW
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
BNDX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VGT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DIA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
BSV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SHV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWR
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
TIP
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SCHF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MBB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SDY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MDY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SCHX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IEF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HYG
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DVY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SHY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IXUS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
TLT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IVE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
PFF
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IAU
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VXUS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
RSP
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SCHB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GOVT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EMB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MUB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
QUAL
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLY
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VBR
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EWJ
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLP
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VGK
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SPLV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MINT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
BIV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IGSB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EFAV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GDX
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLU
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SCHD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWP
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ACWI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VMBS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
XLE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
JNK
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VOE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
FLOT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
JPST
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SCZ
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IEI
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWN
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DGRO
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
VBK
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IGIB
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IWO
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.006099968
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0016898660
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002077056
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0022360355
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0017890863
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001736693
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001106388
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001681088
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00046332859
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002200231
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001557725
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0023415111
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0032234753
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0007997348
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0015327343
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0012383279
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003064097
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002179106
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000191391
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002814589
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0019626291
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003253374
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.019113014
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.006756640
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005267369
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001011874
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004991256
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0022334070
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005508056
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0002531205
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003843879
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0002372109
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.002346225
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.002605712
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0017475020
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001932397
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0005666427
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004795300
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005836581
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0001257842
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00009081159
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0019685044
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002272383
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0006361631
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001106790
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0007422784
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0041255033
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003189161
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0020875396
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0002827452
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001870799
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0060170694
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004795681
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0005922602
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001030700
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004042725
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002739571
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0010243955
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001924928
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001806146
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002371882
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0008275628
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0019515134
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001194977
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00264674400
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0011761117
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002668490
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001302665
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002258164
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.012494986
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.006398807
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.005917852
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.008133639
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001200660
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0004779842
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001874008
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001763650
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00498036
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0071519848
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0023486170
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0026733893
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005754619
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001875951
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0009116517
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0018953483
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003807047
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0020722096
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002231295
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0001980912
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002446725
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.002630911
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0004069319
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0045386533
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003549552
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0004194414
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001211963
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005894971
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.017322911
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0126945384
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.013178202
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0134924019
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0127544774
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.009652265
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018436329
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.017729720
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00378821023
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018058472
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016592869
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0180938802
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0143367503
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0141237737
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0105732344
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0044445716
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011468264
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015355426
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011056244
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.014337489
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0153896498
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012156174
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.002743903
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.006272724
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0039388941
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018628687
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.013212984
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0193056059
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0150753935
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003798793
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015464153
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0032002389
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.017296894
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012410734
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0142874994
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011028538
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0037696378
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.013665012
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0143976824
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0011297112
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00018126091
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0133167477
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016720820
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0031757481
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018629431
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0032416931
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0115945095
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0142095765
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0130144362
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0060192314
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0101836091
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008194411
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005922602
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.017474795
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.013385186
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015046456
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0023059217
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.016213994
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.017094464
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018466064
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0124870774
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0131916717
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003978224
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00009471654
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0044202968
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011985546
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.009823880
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015706040
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.017537150
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.003394215
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016716991
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008924441
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00009924540
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004072733
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0007647688
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.009721009
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0149360906
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.01627195
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0018408588
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0174535242
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0155668847
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012070245
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016226286
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0152395434
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0022698272
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.039253655
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0008873999
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.019544672
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.013574412
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016961509
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0029245001
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0117764103
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.013875422
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0157191560
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001489930
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0179955058
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.022721172
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0242840940
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.024218220
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0248157103
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0246568769
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.031814151
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.019069875
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.019212776
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00009198023
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.032821816
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.021000906
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0306311536
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0236320930
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0262082119
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0258207050
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001227881
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.026029826
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.027074043
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.026052010
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.014040682
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0238600026
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018582970
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.019675179
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016347691
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0007861946
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.022751878
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.021792064
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0313506787
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0273006374
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005068469
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.028542194
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005917693
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.021745295
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.029984083
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0243136677
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.025700013
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0015062361
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.032729302
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0238405527
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0015052940
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00009044932
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0246679043
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.023153370
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0008155098
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018599946
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0012935879
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0203358057
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0258820165
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0241643775
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0021541043
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.006500818
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0179376149
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.020495249
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003548886
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.020995449
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001793079
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.023062135
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0064343040
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.014091356
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.020906723
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.022920923
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0248076812
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0246652173
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001982686
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00473089487
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0014396023
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.024085978
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.020748172
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.025632797
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015280173
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012072667
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018696026
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016748990
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00009924540
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001314087
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003822792
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.013642270
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0235646381
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.04326116
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0067016093
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0221778810
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0274902986
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.021075943
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.023810522
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0235878969
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0013215006
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.024701342
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0053430008
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.023111858
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001980912
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.024207994
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015369037
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0022689596
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0269583342
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.018940649
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0285117041
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001580334
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0284649716
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016273779
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0110371371
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011139358
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0114683030
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0106831096
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008234532
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012433352
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012885863
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00221091926
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008959566
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012123531
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0095957668
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0118987200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0130211706
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0100044748
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0012306568
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.016790854
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.017373511
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.009370855
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004437547
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0129618969
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.010369474
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.013464265
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.010137208
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0007854976
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012995981
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011313767
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0107854401
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0139835513
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001261363
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015713048
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003548290
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012040822
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.007949941
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0118655695
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.009695182
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0001885182
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008626436
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0104818256
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0011270489
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00009081159
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0104525822
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012278941
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0008155098
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012336194
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0011074564
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0096812509
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0134486432
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0113193358
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0025227807
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.002637331
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0068795036
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015174172
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0007095865
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012508199
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004468584
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012752597
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0028360806
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.005612737
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011806658
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012285245
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0114437766
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0107437626
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001188048
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00085371766
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0004493159
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011441888
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.010809474
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.014204613
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.021617824
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.007722146
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008731859
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.009698102
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00009916959
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002622702
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0006684507
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008823294
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0118083221
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.02449108
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0004634958
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0119706508
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0102051133
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.010843211
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012586070
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0116223810
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0007544131
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012939813
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0035775482
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015544198
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0005950313
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011530313
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.013485184
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0020213357
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0163207962
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.012280109
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0147442744
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001206870
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0174444534
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.003287114
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0009894013
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001036607
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0006123565
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001135276
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003072098
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004354785
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003530857
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00285692501
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004342847
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004178409
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0011027594
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0006508431
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0033014245
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005345031
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0041909610
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000097994
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004342530
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001001152
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008934590
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0004349583
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002163316
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005664191
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001489776
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0032326845
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004816595
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001105438
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0003388982
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0048675476
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0008856206
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001356817
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0017752166
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001975840
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.006464163
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0002292283
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002753215
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0011312023
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004867711
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0036078899
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0001251127
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00009081159
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0006570038
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.003659859
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0052679258
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003098229
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0009228731
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0002861645
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0030322035
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0002189089
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0031781230
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001510439
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0023442262
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011979547
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003544986
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001951243
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.011003744
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001320438
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0054213750
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.008478619
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002135701
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.003199632
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0006516613
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0002276234
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001584279
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00170998028
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0016183255
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001478523
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.007848505
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.002496171
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.006968673
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.009340380
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002990074
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002163358
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00029781110
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.002384484
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0002860690
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002735430
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005566762
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.04220025
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0053208513
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0037123602
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0006030788
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001905938
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004658536
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0011492677
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0015090848
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.021642045
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0014944173
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.003861882
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003969400
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.000796942
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001695691
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0012123094
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0003501705
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002878845
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0083062241
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.001764683
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0084416475
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005140787
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0080360599
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.007689359
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0068197139
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0082617000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.011531038
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004047425
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004688442
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00221249905
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003675782
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004702448
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0008273783
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0061003752
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0038377668
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0097876198
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0025911534
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002638930
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002993541
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.009163331
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.005072985
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0057480147
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.008340049
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.006697424
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005197513
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0022727943
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004549844
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005352840
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0020317774
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0028262158
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.007652486
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0005922597
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004185365
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.011825830
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0070922542
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.010122713
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0013197206
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.011331708
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0068127609
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001251127
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.00009081159
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0077616649
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004124727
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0027283407
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004244698
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0015682489
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0052809133
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0041247242
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0078515507
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0044839921
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001007182
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0009635456
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.012714693
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001185908
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003891078
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.014321948
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.006106584
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0007773691
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.004741593
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002367465
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.004726248
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0064978364
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0075872456
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003165548
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00467027771
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0003596236
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.010125999
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.010992048
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001411921
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.005221970
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005441886
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.008282949
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005119095
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.00019864151
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001431193
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0003823817
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.003208727
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0055494219
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.02252194
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0039301169
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0004647994
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0080082458
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005967129
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.008138341
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0064871928
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001887472
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002367193
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0023899644
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.002866649
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001980912
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.007238678
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000000000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0018584037
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0026886552
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.008587052
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0051881359
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.001579281
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0088344163
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Next, I compute (just as before) the &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; of the portfolios. This time using just the &lt;code&gt;CAPM.beta&lt;/code&gt; and &lt;code&gt;CAPM.alpha&lt;/code&gt; functions in the &lt;code&gt;PerformanceAnalytics&lt;/code&gt; package.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(PerformanceAnalytics)
betas &amp;lt;- CAPM.beta(Ra = all_returns, Rb = SPY_returns, Rf = 0)
alphas &amp;lt;- CAPM.alpha(Ra = all_returns, Rb = SPY_returns, Rf = 0)

beta_alphas &amp;lt;- cbind(t(betas), t(alphas))
colnames(beta_alphas) &amp;lt;- c(&amp;quot;beta&amp;quot;, &amp;quot;alpha&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I rank the ETF’s by their &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; value. We can see the &lt;code&gt;GDX&lt;/code&gt; has the highest &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; and a negative &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; which makes sense since its a Goldminers ETF whihc tracks the Arca Gold Miners Index (GDMNTR) which tracks the performance of companies involved in the gold mining industry. As far as I know there are very few Gold mining companies listed in the SPY500. However, this is a nice way to present and rank ETFs by their &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; values and see their corresponding &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; values.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;beta_alphas %&amp;gt;% 
  as_tibble(rownames = NA) %&amp;gt;% 
  rownames_to_column(&amp;quot;ETFs&amp;quot;) %&amp;gt;% 
  arrange(desc(alpha)) %&amp;gt;% 
  head(10) %&amp;gt;% # I only take the top 10 observations since there are many ETF&amp;#39;s in the data
  pivot_longer(cols = c(&amp;quot;beta&amp;quot;, &amp;quot;alpha&amp;quot;)) %&amp;gt;% 
  ggplot(aes(x = reorder(ETFs, if_else(name == &amp;quot;alpha&amp;quot;, value, -Inf), FUN = max), y = value)) +
  geom_bar(color = &amp;quot;black&amp;quot;, fill = &amp;quot;darkred&amp;quot;, stat = &amp;quot;identity&amp;quot;) +
  scale_color_brewer(type=&amp;#39;seq&amp;#39;, palette=&amp;#39;Reds&amp;#39;) + 
  facet_wrap(~name, scales = &amp;quot;free&amp;quot;) +
  theme_tq() +
  coord_flip() +
  ggtitle(&amp;quot;Highest ranked  alpha stocks&amp;quot;, subtitle = &amp;quot;With corresponding beta values&amp;quot;) +
  ylab(&amp;quot;Alpha / Beta value&amp;quot;) +
  xlab(&amp;quot;ETF&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation_files/figure-html/unnamed-chunk-38-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We can also rank the &lt;span class=&#34;math inline&#34;&gt;\(alpha\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(beta\)&lt;/span&gt; values by taking their ratio of &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{\alpha}{\beta}\)&lt;/span&gt; and plot the results.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;beta_alphas %&amp;gt;% 
  as_tibble(rownames = NA) %&amp;gt;% 
  rownames_to_column(&amp;quot;ETFs&amp;quot;) %&amp;gt;% 
  mutate(alpha_divided_beta = alpha/beta) %&amp;gt;% 
  arrange(desc(alpha_divided_beta )) %&amp;gt;% 
  head(10) %&amp;gt;% 
  ggplot(aes(x = ETFs, y = alpha_divided_beta )) +
  geom_bar(color = &amp;quot;black&amp;quot;, fill = &amp;quot;darkred&amp;quot;, stat = &amp;quot;identity&amp;quot;) +
  scale_color_brewer(type=&amp;#39;seq&amp;#39;, palette=&amp;#39;Reds&amp;#39;) + 
  theme_tq() +
  coord_flip() +
  ggtitle(&amp;quot;Best Performers: Alpha over Beta ranked ETFs&amp;quot;) +
  ylab(&amp;quot;Alpha / Beta value&amp;quot;) +
  xlab(&amp;quot;ETF&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation_files/figure-html/unnamed-chunk-39-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Changing a few lines of code and we can plot and see the worst performers with negative &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; to &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; ratios.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;beta_alphas %&amp;gt;% 
  as_tibble(rownames = NA) %&amp;gt;% 
  rownames_to_column(&amp;quot;ETFs&amp;quot;) %&amp;gt;% 
  mutate(alpha_divided_beta = alpha/beta) %&amp;gt;% 
  arrange(alpha_divided_beta) %&amp;gt;% 
  head(10) %&amp;gt;% 
  ggplot(aes(x = ETFs, y = alpha_divided_beta )) +
  geom_bar(color = &amp;quot;black&amp;quot;, fill = &amp;quot;darkblue&amp;quot;, stat = &amp;quot;identity&amp;quot;) +
  scale_color_brewer(type=&amp;#39;seq&amp;#39;, palette=&amp;#39;Reds&amp;#39;) + 
  theme_tq() +
  coord_flip() +
  ggtitle(&amp;quot;Worst Performers: Alpha over Beta ranked ETFs&amp;quot;) +
  ylab(&amp;quot;Alpha / Beta value&amp;quot;) +
  xlab(&amp;quot;ETF&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation_files/figure-html/unnamed-chunk-40-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We can take our ETF &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; values before and compute &lt;span class=&#34;math inline&#34;&gt;\(\sigma\)&lt;/span&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;beta &amp;lt;- cov(all_returns, SPY_returns) / as.numeric(var(SPY_returns))
alpha &amp;lt;- colMeans(all_returns) - beta*colMeans(SPY_returns)
N = length(SPY_returns)

mySigmaFunction &amp;lt;- function(ASSET){
  err = all_returns[, ASSET] - alpha[ASSET ,] - beta[ASSET ,] * SPY_returns
  Sigma = (1 / (N - 2)) %*% t(err) %*% err
  return(Sigma)
}

Sigma2 &amp;lt;- sapply(colnames(all_returns), mySigmaFunction)
diag_Sigma2 &amp;lt;- diag(Sigma2)
colnames(diag_Sigma2) = colnames(all_returns)
rownames(diag_Sigma2) = colnames(all_returns)

Sigma &amp;lt;- as.numeric(var(SPY_returns)) * beta %*% t(beta) + diag_Sigma2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, I take a random sample of the ETF’s (since there are too many to analyse) and plot the correlations between the ETF’s.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(1234)
Sigma_subsample &amp;lt;- sample(colnames(Sigma), size = 10)
Sigma_sampled &amp;lt;- Sigma[ncol = Sigma_subsample, nrow = Sigma_subsample, drop = FALSE]
col &amp;lt;- colorRampPalette(c(&amp;quot;#BB4444&amp;quot;, &amp;quot;#EE9988&amp;quot;, &amp;quot;#FFFFFF&amp;quot;, &amp;quot;#77AADD&amp;quot;, &amp;quot;#4477AA&amp;quot;))
corrplot(cov2cor(Sigma_sampled), method = &amp;quot;color&amp;quot;, col = col(200),
         main = &amp;quot;Covariance matrix of ETFs&amp;quot;,
         type = &amp;quot;upper&amp;quot;, order = &amp;quot;hclust&amp;quot;, number.cex = .7,
         addCoef.col = &amp;quot;black&amp;quot;,
         tl.col = &amp;quot;black&amp;quot;, tl.srt = 90,
         diag = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation_files/figure-html/unnamed-chunk-42-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;sharpe-ratio-capm-and-fama-french-factor-analysis&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Sharpe Ratio, CAPM and Fama-French Factor Analysis&lt;/h2&gt;
&lt;p&gt;Using simple plots still doesn’t give us enough information about an ETF, Portfolio or Asset. The &lt;em&gt;Sharpe&lt;/em&gt; ratio &lt;span class=&#34;citation&#34;&gt;Sharpe (&lt;a href=&#34;#ref-sharpe1966mutual&#34; role=&#34;doc-biblioref&#34;&gt;1966&lt;/a&gt;)&lt;/span&gt; is a better measure. The &lt;em&gt;Sharpe&lt;/em&gt; ratio is a reward-to-variability ratio which allows us to compare the performance of a portfolio compared to a risk-free asset, after adjusting for it’s risk. It takes the differenece between the portfolio’s return and the risk-free return, this is then divided by the standard deviation (which measures the portfolios volatility).&lt;/p&gt;
&lt;p&gt;The &lt;em&gt;Sharpe&lt;/em&gt; ratio tells us what the additional unit of return we can expect per unit of risk increase. The &lt;em&gt;Sharpe&lt;/em&gt; ratio is defined as:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[S = \dfrac{\overline{d}}{\sigma_{d}}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Where &lt;span class=&#34;math display&#34;&gt;\[\widetilde{d} = \widetilde{R}_{F} - \widetilde{R}_{B}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The single asset model with just the market factor looks like:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ x_t = \alpha + \beta y_{t} + \epsilon_{t}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Taking the expected value of &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; at time &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; we have:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[E[x_{t}] = \alpha + \beta E[y_{t}]\]&lt;/span&gt;
With variance:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[var[x_{t}] = \beta^2var[y_t] + \sigma^2\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Thus, the &lt;em&gt;Sharpe&lt;/em&gt; ratio becomes:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\dfrac{E[x_{t}]}{\sqrt{var[x_{t}]}}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Recall that &lt;span class=&#34;math inline&#34;&gt;\(\sigma = \sqrt{var[x_t]}\)&lt;/span&gt;, we just plug in the values for &lt;span class=&#34;math inline&#34;&gt;\(E[x_{t}]\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(var[x_t]\)&lt;/span&gt; defined previously and the equation becomes:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\dfrac{\alpha + \beta E[y_{t}]}{\sqrt{\beta^2 var[y_t] + \sigma^2}}\]&lt;/span&gt;
Which after some algebra we obtain:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\dfrac{\dfrac{\alpha}{\beta} + E[y_{t}]}{\sqrt{var[y_{t}] + \dfrac{\sigma^{2}}{\beta^{2}}}}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Finally we end up with:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\dfrac{\dfrac{\alpha}{\beta} + E[y_t]}{\sqrt{(var[y_t])}}\]&lt;/span&gt;
We can represent the &lt;em&gt;Sharpe&lt;/em&gt; ratio as &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{\overline{x}}{\sqrt(Diag(\sigma^{2}))}\)&lt;/span&gt; where &lt;span class=&#34;math inline&#34;&gt;\(\overline{x}\)&lt;/span&gt; is the average value of &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; over the historic period from &lt;span class=&#34;math inline&#34;&gt;\(t=1\)&lt;/span&gt; to &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; - simply computed as &lt;span class=&#34;math inline&#34;&gt;\(\overline{x} = \dfrac{1}{T}\sum_{t=1}^{T} D_{t}\)&lt;/span&gt;. In R we can simply take &lt;code&gt;colMeans(all_returns) / sqrt(diag(var(all_returns)))&lt;/code&gt;.&lt;/p&gt;
&lt;div id=&#34;machine-learning-and-clustering&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Machine Learning and Clustering&lt;/h4&gt;
&lt;p&gt;We can cluster our ETF’s based on their &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(sharpe\)&lt;/span&gt; values. Why would we want to do this? Perhaps with more variables than the 3 here the model can cluster these firms in a higher dimensional space and thus we can select our ETF’s based on the clusters and use it as a portfolio diversification tool, that is one cluster might contain riskier ETF’s whereas another might contain &lt;code&gt;value&lt;/code&gt; stocks or &lt;code&gt;growth&lt;/code&gt; stocks. With such few variables here it doesn’t quite work but with more variables we can better classifiy ETFs.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;betas &amp;lt;- CAPM.beta(Ra = all_returns, Rb = SPY_returns, Rf = 0)
alphas &amp;lt;- CAPM.alpha(Ra = all_returns, Rb = SPY_returns, Rf = 0)
sharpe &amp;lt;- colMeans(all_returns) / sqrt(diag(var(all_returns)))

beta_alphas_sharpe &amp;lt;- cbind(t(betas), t(alphas), sharpe)
colnames(beta_alphas_sharpe) &amp;lt;- c(&amp;quot;beta&amp;quot;, &amp;quot;alpha&amp;quot;, &amp;quot;sharpe&amp;quot;)
beta_alphas_sharpe &amp;lt;- na.omit(beta_alphas_sharpe)
library(factoextra)
kmeans_model &amp;lt;- kmeans(beta_alphas_sharpe, centers = 5, iter.max = 10, nstart = 1)
fviz_cluster(kmeans_model, data = beta_alphas_sharpe)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/factor-modeling-for-portfolio-optimisation/factor-modeling-portfolio-optimisation_files/figure-html/unnamed-chunk-43-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;beta_alphas_sharpe&lt;/code&gt; data looks like:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
beta
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
alpha
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
sharpe
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
myPortfolio
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0977199
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000345
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0834437
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
SPY
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9990763
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000799
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0988232
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IVV
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9923880
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000872
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1000217
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
VTI
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0282825
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000718
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0969068
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
VOO
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9978598
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000848
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0995858
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
QQQ
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.1472461
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000931
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0870931
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We can plot the &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt;, and &lt;span class=&#34;math inline&#34;&gt;\(sharpe\)&lt;/span&gt; values in a 3D plot and colour them according to the clusters from the &lt;code&gt;kmeans&lt;/code&gt; model. It also gives me the opportunity to use the &lt;code&gt;threejs&lt;/code&gt; package which we can interact with.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#library(rgl)
#options(rgl.printRglwidget = TRUE)
#plot3d(beta_alphas_sharpe, col = kmeans_model$cluster, size=2, type=&amp;#39;s&amp;#39;)

library(threejs)
scatterplot3js(beta_alphas_sharpe, color = factor(kmeans_model$cluster), size = 0.5, bg = &amp;quot;black&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:672px;height:480px;&#34; class=&#34;scatterplotThree html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;NROW&#34;:98,&#34;height&#34;:null,&#34;width&#34;:null,&#34;axis&#34;:true,&#34;numticks&#34;:[6,6,6],&#34;xticklabs&#34;:null,&#34;yticklabs&#34;:null,&#34;zticklabs&#34;:null,&#34;color&#34;:[[&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#00CD00&#34;,&#34;#00CD00&#34;,&#34;#00CD00&#34;,&#34;#0000FF&#34;,&#34;#0000FF&#34;,&#34;#0000FF&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;,&#34;#0000FF&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#00FFFF&#34;,&#34;#00CD00&#34;,&#34;#00CD00&#34;,&#34;#000000&#34;,&#34;#000000&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#0000FF&#34;,&#34;#0000FF&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#00CD00&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#FF0000&#34;,&#34;#FF0000&#34;,&#34;#00CD00&#34;,&#34;#0000FF&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;,&#34;#FF0000&#34;,&#34;#00CD00&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#FF0000&#34;,&#34;#000000&#34;,&#34;#00CD00&#34;,&#34;#00CD00&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;,&#34;#00FFFF&#34;,&#34;#00CD00&#34;,&#34;#000000&#34;,&#34;#00FFFF&#34;,&#34;#0000FF&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#00CD00&#34;,&#34;#FF0000&#34;,&#34;#000000&#34;,&#34;#FF0000&#34;,&#34;#00CD00&#34;,&#34;#00CD00&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#000000&#34;,&#34;#0000FF&#34;,&#34;#000000&#34;,&#34;#FF0000&#34;,&#34;#FF0000&#34;,&#34;#FF0000&#34;,&#34;#00CD00&#34;,&#34;#0000FF&#34;,&#34;#FF0000&#34;,&#34;#000000&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#00CD00&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;,&#34;#000000&#34;,&#34;#0000FF&#34;,&#34;#FF0000&#34;,&#34;#00CD00&#34;,&#34;#00CD00&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;,&#34;#00CD00&#34;,&#34;#0000FF&#34;,&#34;#FF0000&#34;,&#34;#0000FF&#34;]],&#34;size&#34;:0.5,&#34;stroke&#34;:&#34;black&#34;,&#34;flipy&#34;:true,&#34;grid&#34;:true,&#34;renderer&#34;:&#34;auto&#34;,&#34;signif&#34;:8,&#34;bg&#34;:&#34;black&#34;,&#34;cexsymbols&#34;:1,&#34;xlim&#34;:{},&#34;ylim&#34;:{},&#34;zlim&#34;:{},&#34;pch&#34;:[&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;,&#34;@&#34;],&#34;axisLabels&#34;:[&#34;beta&#34;,&#34;sharpe&#34;,&#34;alpha&#34;],&#34;linealpha&#34;:1,&#34;alpha&#34;:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],&#34;vertices&#34;:[[0.86842037,0.19768058,0.79896455,0.8122099,0.24570882,0.76546812,0.80839869,0.24945155,0.76008965,0.82885256,0.23972431,0.77143559,0.8115167,0.24809052,0.76186757,0.89664204,0.20907696,0.75569795,0.87545316,0.13300382,0.88279977,0.87892383,0.12345017,0.89921062,0.21245747,0.1353452,0.71519514,0.96224679,0.17917625,0.73777743,0.8840305,0.11368051,0.92247267,0.9567801,0.19368915,0.69889475,0.8030793,0.24426172,0.75214024,0.90077996,0.20228446,0.78891538,0.80846652,0.25685801,0.72872393,0.20738798,0.14629668,0.7034228,0.93980694,0.18609032,0.77202964,0.96776678,0.16660805,0.83350105,0.82469874,0.22492581,0.77612462,0.0072680562,0.072944981,0.3815712,0.8238163,0.20278562,0.81329857,0.71997998,0.28505182,0.69305727,0.64956127,0.038009408,0.91332596,0.63627089,0.27495944,0.69195384,0.22303675,0.21506997,0.62037529,0.87677485,0.17855466,0.85353738,0.74885905,0.26866605,0.72260875,0.98475726,0.18641981,0.70987767,0.92873432,0.17647001,0.83318765,0.23662141,0.24538331,0.74954408,0.95349741,0.20807217,0.33941353,0.21914287,0.2132234,0.65780069,0.89471618,0.15197604,0.85062954,0.87138986,0.27506301,0.62683163,0.82597919,0.24004032,0.77034434,0.80559384,0.23720957,0.7596557,0.22235117,0.17512233,0.71131769,0.91812957,0.25946954,0.64274803,0.76340472,0.35044209,0.59597513,0.22073833,0.11710243,0.77175807,0.24069479,0.35835152,0.80696572,0.81858223,0.24136177,0.77105671,0.86650082,0.19227675,0.82847854,0.22134258,0.10882134,0.70481383,0.86976802,0.13628746,0.87610547,0.21684798,0.081724253,0.75359276,0.72569943,0.28425152,0.67061056,0.90492964,0.19742584,0.79969008,0.81035901,0.24835885,0.76135119,0.14360957,0,0.70622799,0.50727275,0.23155018,0.73759234,0.69507419,0.28304457,0.65302193,0.75321769,0.086311,0.92312075,0.23036576,0.040832626,0.80126956,0.88121801,0.15984125,0.83184111,0.021569341,0.016758407,0.52655437,0.81060701,0.22243558,0.77961659,0.40021893,0.086042066,0.81301106,0,0.073658157,0.37205153,0.89758197,0.14935085,0.8532154,0.85487073,0.20812666,0.80752296,0.82133194,0.24192055,0.76812712,0.81048037,0.24753617,0.76279233,0.170983,0.0087811686,0.73450521,0.37935598,0.2400784,0.64866877,0.1996185,0.10274521,0.7241423,0.77047125,0.23734123,0.77137957,0.80442396,0.17443686,0.82295812,0.91473618,0.18557293,0.80403361,0.77729792,0.11576565,0.83330271,0.57265433,0.11995578,0.79637196,0.94172922,0.087313513,0.96968996,0.63234826,0.23587091,0.71002534,0.24128725,1,0.76734876,0.18793973,0.0833462,0.70033351,0.2410368,0.27075425,0.77846917,0.68230063,0.11677763,0.85991714,0.86080815,0.20196789,0.81016103,0.14373956,0.06352858,0,0.43246144,0.13590547,0.57383405,0.85764927,0.19124094,0.81461577,0.83311762,0.26908846,0.65291322,0.71347671,0.31790239,0.6500643,0.87192721,0.18532454,0.8333257,0.84539964,0.20738937,0.80081765,0.21427724,0.091387259,0.74892751,0.96104965,0.056055458,1,0.51241777,0.24790322,0.71644714,0.86561388,0.18999103,0.82323629,0.2457111,0.3520244,0.77946229,0.83226163,0.23529644,0.77766867,0.80587032,0.17269504,0.76881137,0.19005408,0.01666762,0.75302567,0.93855143,0.17765193,0.78812958,0.75957138,0.30953111,0.66859364,0.94591256,0.15700728,0.86976113,0.22767177,0.22204563,0.71347953,1,0.14382141,0.88218506]],&#34;xticklab&#34;:[&#34;-0.43&#34;,&#34;-0.08&#34;,&#34;0.28&#34;,&#34;0.63&#34;,&#34;0.98&#34;,&#34;1.33&#34;],&#34;yticklab&#34;:[&#34;0.02&#34;,&#34;0.08&#34;,&#34;0.15&#34;,&#34;0.21&#34;,&#34;0.28&#34;,&#34;0.34&#34;],&#34;zticklab&#34;:[&#34;1.12e-03&#34;,&#34;8.46e-04&#34;,&#34;5.75e-04&#34;,&#34;3.04e-04&#34;,&#34;3.31e-05&#34;,&#34;-2.38e-04&#34;],&#34;xtick&#34;:[0,0.2,0.4,0.6,0.8,1],&#34;ytick&#34;:[0,0.2,0.4,0.6,0.8,1],&#34;ztick&#34;:[0,0.2,0.4,0.6,0.8,1]},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;factor-modelling-fama-and-french&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Factor Modelling Fama and French&lt;/h1&gt;
&lt;p&gt;Finally, I analyse the performance of the various ETF’s. The CAPM formula tries to explain the performance of a portfolio through a sigle factor, the market as a whole. CAPM is defined as follows:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[R_{a} = R_{rf} + \beta_{a}(R_{m} - R_{rf})\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We can take the model further by adding &lt;em&gt;Factors&lt;/em&gt; to the model. Thus, the 3 Factor model looks like:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[R_{a} = R_{rf} + \beta_{a}(R_{m} - R_{rf}) + \beta_{b}(SMB) + \beta_{c} HML\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Which takes the market factor from the CAPM and adds 2 new factors, the &lt;span class=&#34;math inline&#34;&gt;\(SMB\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(HML\)&lt;/span&gt; or &lt;em&gt;Small-minus-Big&lt;/em&gt; and &lt;em&gt;High-minus-Low&lt;/em&gt;. The &lt;span class=&#34;math inline&#34;&gt;\(SMB\)&lt;/span&gt; tries to caputre the size effect, small market cap companies should outperform the market over the long run. The &lt;span class=&#34;math inline&#34;&gt;\(HML\)&lt;/span&gt; aims to capture the value verses growth effect by sorting assests based on high book-to-market ratios (defined at the begining of the post). Firms which typically have a high book-to-market ratio are value stocks and low book-to-market ratios are growth stocks, the literature also shows that value stocks outperform growth stocks over the long term horizon.&lt;/p&gt;
&lt;p&gt;The Fama French factor model allows us to analyse fund managers performance, since, if an asset managers portfolio can be explained by the Fama French factors then that fund manager has not added any value through portfolio selection and skill and subseuently obtained no alpha.&lt;/p&gt;
&lt;p&gt;More formally, our equation becomes:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[X^T = a^T + B F^T + E^T\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Where &lt;span class=&#34;math inline&#34;&gt;\(F\)&lt;/span&gt; is a matrix of factors and &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; is a scalar of &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;’s such that &lt;span class=&#34;math inline&#34;&gt;\(B = [{b_{1}, b_{2}, b_{3}]}\)&lt;/span&gt;, in which &lt;span class=&#34;math inline&#34;&gt;\(b_{1}\)&lt;/span&gt; is the market &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(b_{2}\)&lt;/span&gt; is the &lt;span class=&#34;math inline&#34;&gt;\(SMB\)&lt;/span&gt; &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(b_{3}\)&lt;/span&gt; is the &lt;span class=&#34;math inline&#34;&gt;\(HML\)&lt;/span&gt; &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;. More formally extending to include more factors up to &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; we have; &lt;span class=&#34;math inline&#34;&gt;\(B = [\beta_{1}, ... , \beta_{N}]^T\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We want to fit a line which minimises the squared errors such that; &lt;span class=&#34;math inline&#34;&gt;\(minimise, \beta\)&lt;/span&gt; &lt;span class=&#34;math inline&#34;&gt;\(|X^T - a^T-BF^T|_{F}^2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The solution becomes &lt;span class=&#34;math inline&#34;&gt;\([a, B] = X^T \widetilde{F}(\widetilde{F}^T\widetilde{F})^{-1}\)&lt;/span&gt; which we can solve in R using the following:&lt;/p&gt;
&lt;p&gt;(For completness I re-download the data)&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;I download the data as before randomly selecting from Wikipedia and convert the daily prices to daily returns - (I set a &lt;code&gt;seed&lt;/code&gt; such that we collect the same data using &lt;code&gt;set.seed&lt;/code&gt;).&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(quantmod)
library(tidyquant)
library(timetk)
library(rvest)

start_date &amp;lt;- &amp;quot;2016-01-01&amp;quot;
end_date &amp;lt;- &amp;quot;2019-11-15&amp;quot;


set.seed(4746)
url &amp;lt;- &amp;quot;https://en.wikipedia.org/wiki/List_of_S%26P_500_companies&amp;quot;

symbols &amp;lt;- url %&amp;gt;%
  read_html() %&amp;gt;%
  html_nodes(xpath = &amp;#39;//*[@id=&amp;quot;constituents&amp;quot;]&amp;#39;) %&amp;gt;% 
  html_table() %&amp;gt;% 
  .[[1]] %&amp;gt;% 
  filter(!str_detect(Security, &amp;quot;Class A|Class B|Class C&amp;quot;)) %&amp;gt;%     # Removes firms with Class A shares
  sample_n(20) %&amp;gt;% 
  pull(Symbol)


asset_returns &amp;lt;- tq_get(
  symbols,
  from = start_date,
  to = end_date
) %&amp;gt;% 
  group_by(symbol) %&amp;gt;% 
  tq_transmute(
    select = adjusted,
    mutate_fun = periodReturn,
    period = &amp;quot;daily&amp;quot;,
    type = &amp;quot;arithmetic&amp;quot;
  ) %&amp;gt;% 
  select(symbol, date, daily.returns) %&amp;gt;% 
  pivot_wider(names_from = symbol, values_from = daily.returns) %&amp;gt;% 
  .[-1, ]&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;I download the ETFs just as before and convert to daily returns.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;myETFs &amp;lt;- c(&amp;quot;SPY&amp;quot;, &amp;quot;IVV&amp;quot;, &amp;quot;VTI&amp;quot;, &amp;quot;VOO&amp;quot;, &amp;quot;QQQ&amp;quot;, &amp;quot;VEA&amp;quot;, &amp;quot;IEFA&amp;quot;, &amp;quot;AGG&amp;quot;, &amp;quot;VWO&amp;quot;,
            &amp;quot;EFA&amp;quot;,&amp;quot;IEMG&amp;quot;,&amp;quot;VTV&amp;quot;, &amp;quot;IJH&amp;quot;, &amp;quot;IWF&amp;quot;,&amp;quot;BND&amp;quot;, &amp;quot;IJR&amp;quot;, &amp;quot;IWM&amp;quot;, &amp;quot;VUG&amp;quot;, 
            &amp;quot;GLD&amp;quot;, &amp;quot;IWD&amp;quot;, &amp;quot;VIG&amp;quot;, &amp;quot;VNQ&amp;quot;, &amp;quot;USMV&amp;quot;, &amp;quot;LQD&amp;quot;, &amp;quot;VO&amp;quot;, &amp;quot;VYM&amp;quot;, &amp;quot;EEM&amp;quot;,
            &amp;quot;VB&amp;quot;, &amp;quot;VCSH&amp;quot;, &amp;quot;XLF&amp;quot;, &amp;quot;VCIT&amp;quot;, &amp;quot;VEU&amp;quot;, &amp;quot;XLK&amp;quot;, &amp;quot;ITOT&amp;quot;, &amp;quot;IVW&amp;quot;, &amp;quot;BNDX&amp;quot;,
            &amp;quot;VGT&amp;quot;, &amp;quot;DIA&amp;quot;, &amp;quot;BSV&amp;quot;, &amp;quot;SHV&amp;quot;, &amp;quot;IWB&amp;quot;, &amp;quot;IWR&amp;quot;, &amp;quot;TIP&amp;quot;, &amp;quot;SCHF&amp;quot;, &amp;quot;MBB&amp;quot;, &amp;quot;SDY&amp;quot;,
            &amp;quot;MDY&amp;quot;, &amp;quot;SCHX&amp;quot;, &amp;quot;IEF&amp;quot;, &amp;quot;HYG&amp;quot;, &amp;quot;DVY&amp;quot;, &amp;quot;XLV&amp;quot;, &amp;quot;SHY&amp;quot;, &amp;quot;IXUS&amp;quot;, &amp;quot;TLT&amp;quot;, &amp;quot;IVE&amp;quot;,
            &amp;quot;PFF&amp;quot;, &amp;quot;IAU&amp;quot;, &amp;quot;VXUS&amp;quot;, &amp;quot;RSP&amp;quot;, &amp;quot;SCHB&amp;quot;, &amp;quot;VV&amp;quot;, &amp;quot;GOVT&amp;quot;, &amp;quot;EMB&amp;quot;, &amp;quot;MUB&amp;quot;, &amp;quot;QUAL&amp;quot;,
            &amp;quot;XLY&amp;quot;, &amp;quot;VBR&amp;quot;, &amp;quot;EWJ&amp;quot;, &amp;quot;XLP&amp;quot;, &amp;quot;VGK&amp;quot;, &amp;quot;SPLV&amp;quot;, &amp;quot;MINT&amp;quot;, &amp;quot;BIV&amp;quot;, &amp;quot;IGSB&amp;quot;, &amp;quot;EFAV&amp;quot;,
            &amp;quot;VT&amp;quot;, &amp;quot;GDX&amp;quot;, &amp;quot;XLU&amp;quot;, &amp;quot;IWS&amp;quot;, &amp;quot;XLI&amp;quot;, &amp;quot;SCHD&amp;quot;, &amp;quot;IWP&amp;quot;, &amp;quot;ACWI&amp;quot;, &amp;quot;VMBS&amp;quot;, &amp;quot;XLE&amp;quot;, &amp;quot;JNK&amp;quot;,
            &amp;quot;VOE&amp;quot;, &amp;quot;FLOT&amp;quot;, &amp;quot;IWV&amp;quot;, &amp;quot;JPST&amp;quot;, &amp;quot;SCZ&amp;quot;, &amp;quot;IEI&amp;quot;, &amp;quot;IWN&amp;quot;, &amp;quot;DGRO&amp;quot;, &amp;quot;VBK&amp;quot;, &amp;quot;IGIB&amp;quot;, &amp;quot;IWO&amp;quot;)


etf_returns &amp;lt;- tq_get(
  myETFs,
  from = start_date,
  to = end_date
) %&amp;gt;% 
  group_by(symbol) %&amp;gt;% 
  tq_transmute(
    select = adjusted,
    mutate_fun = periodReturn,
    period = &amp;quot;daily&amp;quot;,
    type = &amp;quot;arithmetic&amp;quot;
  ) %&amp;gt;% 
  select(symbol, date, daily.returns) %&amp;gt;% 
  pivot_wider(names_from = symbol, values_from = daily.returns) %&amp;gt;% 
  .[-1, ]&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;I take the average daily return of the randomly selected stocks and join the data with the ETFs and set the data as a time series object. I also download the daily Fama French 3 factors from Kenneth French’s website and clean the data up a little.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;portfolio_and_etfs &amp;lt;- asset_returns %&amp;gt;% 
  mutate(myPortfolio = rowMeans(select(., -date), na.rm = TRUE)) %&amp;gt;% 
  select(date, myPortfolio) %&amp;gt;% 
  inner_join(etf_returns, by = c(&amp;quot;date&amp;quot;)) %&amp;gt;% 
  tk_xts(date_var = date)

# Daily fama french
library(glue)
library(readr)
temp &amp;lt;- tempfile()
base &amp;lt;- &amp;quot;http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/&amp;quot;
factor &amp;lt;- &amp;quot;F-F_Research_Data_Factors_daily&amp;quot;
format&amp;lt;-&amp;quot;_CSV.zip&amp;quot;
full_url &amp;lt;-glue(base,factor,format,sep =&amp;quot;&amp;quot;)
download.file(full_url,temp,quiet = TRUE)

North_America_3_Factors &amp;lt;- read_csv(unz(temp, &amp;quot;F-F_Research_Data_Factors_daily.CSV&amp;quot;), skip = 4) %&amp;gt;%
  rename(date = X1) %&amp;gt;% 
  mutate(date = ymd(date)) %&amp;gt;% 
  drop_na(date) %&amp;gt;%
  rename(Mkt_Rf_3 = `Mkt-RF`,
         SMB_3 = SMB,
         HML_3 = HML,
         RF_3 = RF) %&amp;gt;% 
  select(-RF_3) %&amp;gt;% 
  mutate_at(vars(c(&amp;quot;Mkt_Rf_3&amp;quot;, &amp;quot;SMB_3&amp;quot;, &amp;quot;HML_3&amp;quot;)), funs(./100)) %&amp;gt;% 
  tk_xts(date_var = date)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally we can compute the solution &lt;span class=&#34;math inline&#34;&gt;\([a, B] = X^T \widetilde{F}(\widetilde{F}^T\widetilde{F})^{-1}\)&lt;/span&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;three_factors &amp;lt;- North_America_3_Factors[index(North_America_3_Factors) %in% c(min(index(portfolio_and_etfs)):max(index(North_America_3_Factors)))] # this ensures that the dates from the both time series match
portfolio_and_etfs_new &amp;lt;- portfolio_and_etfs[index(portfolio_and_etfs) %in% c(min(index(three_factors))):max(index(three_factors))] # There is probably a much nicer way to go about doing this but this works...
FF_3Factors &amp;lt;- cbind(alpha = 1, three_factors)
Gamma &amp;lt;- t(solve(t(FF_3Factors) %*% FF_3Factors, t(FF_3Factors) %*% portfolio_and_etfs_new))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which we can see as:&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
alpha
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Mkt_Rf_3
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SMB_3
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
HML_3
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
myPortfolio
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0001697
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9844870
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0155642
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0629606
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
SPY
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000391
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9784199
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.1331473
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0085326
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IVV
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000423
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9771912
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.1341942
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0113980
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
VTI
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000440
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9727841
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0164012
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0019078
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
VOO
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000430
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9769683
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.1356460
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0099922
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
QQQ
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0000440
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.1645777
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.1440829
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.4955734
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Instead, we can estimate these using linear regression models. For my random portfolio &lt;code&gt;myPortfolio&lt;/code&gt; we can use the &lt;code&gt;lm&lt;/code&gt; function to fit a linear model and then use the &lt;code&gt;tidy&lt;/code&gt; function from the &lt;code&gt;broom&lt;/code&gt; package to tidy the output up a little:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(broom)
regdata &amp;lt;- cbind(FF_3Factors, portfolio_and_etfs_new)
#sapply(regdata, function(x) sum(is.na(x)))   # One column was causing problems since it consisted of just NA values. I remove it below.
regdata$JPST &amp;lt;- NULL      # This ETF failed to download or does not exist on the Yahoo Finance site

myPortfolioReg &amp;lt;- lm(myPortfolio ~ Mkt_Rf_3 + SMB_3 + HML_3, data = regdata, na.action = na.exclude)
tidy(myPortfolioReg)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 4 x 5
##   term        estimate std.error statistic p.value
##   &amp;lt;chr&amp;gt;          &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;   &amp;lt;dbl&amp;gt;
## 1 (Intercept) 0.000170  0.000112     1.51  0.131  
## 2 Mkt_Rf_3    0.984     0.0136      72.6   0      
## 3 SMB_3       0.0156    0.0226       0.690 0.490  
## 4 HML_3       0.0630    0.0200       3.15  0.00167&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can apply this to all our ETFs in the data using the &lt;code&gt;apply&lt;/code&gt; command and applying our own custom &lt;code&gt;lm&lt;/code&gt; function.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;regressionLists &amp;lt;- apply(regdata, 2, function(y) lm(y ~ Mkt_Rf_3 + SMB_3 + HML_3, data = regdata, na.action = na.exclude))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can also apply the &lt;code&gt;tidy&lt;/code&gt; command to individual ETFs and then use the &lt;code&gt;stars.pval&lt;/code&gt; to make the data even more tidy &lt;em&gt;&lt;sub&gt;awesome&lt;/sub&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(gtools)
tidy(regressionLists$myPortfolio) %&amp;gt;% 
  mutate(p.value = stars.pval(p.value))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 4 x 5
##   term        estimate std.error statistic p.value
##   &amp;lt;chr&amp;gt;          &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  
## 1 (Intercept) 0.000170  0.000112     1.51  &amp;quot; &amp;quot;    
## 2 Mkt_Rf_3    0.984     0.0136      72.6   ***    
## 3 SMB_3       0.0156    0.0226       0.690 &amp;quot; &amp;quot;    
## 4 HML_3       0.0630    0.0200       3.15  **&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tidy(regressionLists$VTV)%&amp;gt;% 
  mutate(p.value = stars.pval(p.value))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 4 x 5
##   term          estimate std.error statistic p.value
##   &amp;lt;chr&amp;gt;            &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  
## 1 (Intercept)  0.0000514 0.0000446      1.15 &amp;quot; &amp;quot;    
## 2 Mkt_Rf_3     0.918     0.00539      170.   ***    
## 3 SMB_3       -0.131     0.00897      -14.7  ***    
## 4 HML_3        0.265     0.00794       33.4  ***&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tidy(regressionLists$LQD) %&amp;gt;% 
  mutate(p.value = stars.pval(p.value))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 4 x 5
##   term         estimate std.error statistic p.value
##   &amp;lt;chr&amp;gt;           &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  
## 1 (Intercept)  0.000241 0.0000882      2.74 **     
## 2 Mkt_Rf_3    -0.0119   0.0106        -1.12 &amp;quot; &amp;quot;    
## 3 SMB_3       -0.0325   0.0177        -1.84 .      
## 4 HML_3       -0.157    0.0157       -10.0  ***&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, we can apply this same method to all our ETFs using the &lt;code&gt;lapply&lt;/code&gt; function to &lt;code&gt;tidy&lt;/code&gt; the data and the &lt;code&gt;map&lt;/code&gt; function to &lt;code&gt;mutate&lt;/code&gt; or &lt;em&gt;convert&lt;/em&gt; the p-value to &lt;em&gt;stars&lt;/em&gt;. Then take a random sample of 5 ETFs regressions.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(purrr)
myTidyRegressions &amp;lt;- lapply(regressionLists[4:length(regressionLists)], tidy)
myTidiedRegressions &amp;lt;- map(myTidyRegressions, ~mutate(., p.value = stars.pval(p.value)))
library(rlist)
list.sample(myTidiedRegressions, 5)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $DGRO
## # A tibble: 4 x 5
##   term         estimate std.error statistic p.value
##   &amp;lt;chr&amp;gt;           &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  
## 1 (Intercept)  0.000154 0.0000507      3.04 **     
## 2 Mkt_Rf_3     0.890    0.00612      146.   ***    
## 3 SMB_3       -0.145    0.0102       -14.2  ***    
## 4 HML_3        0.121    0.00902       13.4  ***    
## 
## $EFAV
## # A tibble: 4 x 5
##   term           estimate std.error statistic p.value
##   &amp;lt;chr&amp;gt;             &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  
## 1 (Intercept) -0.00000220  0.000142   -0.0155 &amp;quot; &amp;quot;    
## 2 Mkt_Rf_3     0.572       0.0171     33.5    ***    
## 3 SMB_3       -0.112       0.0285     -3.94   ***    
## 4 HML_3       -0.0172      0.0252     -0.684  &amp;quot; &amp;quot;    
## 
## $XLE
## # A tibble: 4 x 5
##   term         estimate std.error statistic p.value
##   &amp;lt;chr&amp;gt;           &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  
## 1 (Intercept) -0.000264  0.000270    -0.978 &amp;quot; &amp;quot;    
## 2 Mkt_Rf_3     1.09      0.0326      33.5   ***    
## 3 SMB_3        0.0920    0.0543       1.69  .      
## 4 HML_3        0.716     0.0481      14.9   ***    
## 
## $IVW
## # A tibble: 4 x 5
##   term          estimate std.error statistic p.value
##   &amp;lt;chr&amp;gt;            &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  
## 1 (Intercept)  0.0000434 0.0000407      1.07 &amp;quot; &amp;quot;    
## 2 Mkt_Rf_3     1.01      0.00491      206.   ***    
## 3 SMB_3       -0.180     0.00817      -22.0  ***    
## 4 HML_3       -0.312     0.00724      -43.1  ***    
## 
## $VEA
## # A tibble: 4 x 5
##   term         estimate std.error statistic p.value
##   &amp;lt;chr&amp;gt;           &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;  
## 1 (Intercept) -0.000113  0.000154    -0.730 &amp;quot; &amp;quot;    
## 2 Mkt_Rf_3     0.852     0.0186      45.8   ***    
## 3 SMB_3       -0.0850    0.0310      -2.74  **     
## 4 HML_3        0.150     0.0274       5.45  ***&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A few notes here: We should be modelling the excess returns on the ETFs and not just the ETF returns. This is simple enough by replacing &lt;em&gt;for example&lt;/em&gt; &lt;code&gt;myPortfolio&lt;/code&gt; in the &lt;code&gt;lm&lt;/code&gt; regressions with &lt;span class=&#34;math inline&#34;&gt;\((myPortfolio - RF_3)\)&lt;/span&gt; where &lt;span class=&#34;math inline&#34;&gt;\(RF_3\)&lt;/span&gt; is the risk free rate which comes with the Fama and French data. We should also probably use &lt;span class=&#34;math inline&#34;&gt;\(NeweyWest\)&lt;/span&gt; adjusted standard errors by running &lt;code&gt;coeftest(myPortfolioReg, NeweyWest(myPortfolioReg, lag = N, prewhite = FALSE))&lt;/code&gt;. Literature suggests that lags of &lt;span class=&#34;math inline&#34;&gt;\(4(N/100)^{2/9}\)&lt;/span&gt; should be used, where &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; is the number of observations.
We could rank the ETFs based on their alphas as before and go &lt;em&gt;long&lt;/em&gt; on the high alphas and &lt;em&gt;short&lt;/em&gt; on the low alphas. Run our hedge portfolio through a Fama French regression here and see if we are able to obtain better performances.&lt;/p&gt;
&lt;p&gt;Finally, here I only used the 3 Factor model. There are more factors from the literature we could use. On the Kenneth French website we can collect data on &lt;span class=&#34;math inline&#34;&gt;\(Market\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(SMB\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(HML\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(RMW\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(CMA\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(MOM\)&lt;/span&gt;. Where the &lt;span class=&#34;math inline&#34;&gt;\(RMW\)&lt;/span&gt; factor is a profitability factor, the &lt;span class=&#34;math inline&#34;&gt;\(CMA\)&lt;/span&gt; is an investment factor and the &lt;span class=&#34;math inline&#34;&gt;\(MOM\)&lt;/span&gt; is a momentum factor.&lt;/p&gt;
&lt;p&gt;Below I pull in the daily Fama and French 5 Factor model and plot them.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(glue)
library(timetk)
library(plotly)
library(pipeR)

temp &amp;lt;- tempfile()
base &amp;lt;- &amp;quot;http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/&amp;quot;
factor &amp;lt;- &amp;quot;North_America_5_Factors&amp;quot;
format&amp;lt;-&amp;quot;_CSV.zip&amp;quot;
full_url &amp;lt;-glue(base,factor,format,sep =&amp;quot;&amp;quot;)
download.file(full_url,temp,quiet = TRUE)

North_America_Factors &amp;lt;- read_csv(unz(temp, &amp;quot;North_America_5_Factors.csv&amp;quot;), skip = 6) %&amp;gt;%
  rename(date = X1) %&amp;gt;%
  mutate_at(vars(-date), as.numeric) %&amp;gt;%
  mutate(date = rollback(ymd(parse_date_time(date, &amp;quot;%Y%m&amp;quot;) + months(1)))) %&amp;gt;%
  drop_na(date) %&amp;gt;%
  rename(Mkt_Rf = `Mkt-RF`) %&amp;gt;% 
  select(-RF) %&amp;gt;% 
  mutate_at(vars(c(&amp;quot;Mkt_Rf&amp;quot;, &amp;quot;SMB&amp;quot;, &amp;quot;HML&amp;quot;, &amp;quot;RMW&amp;quot;, &amp;quot;CMA&amp;quot;)), funs(./100)) %&amp;gt;% 
  tk_xts(date_var = date)

ax &amp;lt;- list(
  zeroline = TRUE,
  showline = TRUE,
  mirror = &amp;quot;ticks&amp;quot;,
  gridcolor = toRGB(&amp;#39;white&amp;#39;),
  gridwidth = 2,
  zerolinecolor = toRGB(&amp;#39;white&amp;#39;),
  zerolinewidth = 4,
  linecolor = toRGB(&amp;#39;white&amp;#39;),
  linewidth = 6,
  color = &amp;#39;white&amp;#39;
)


North_America_Factors %&amp;gt;&amp;gt;% 
  (cumprod(1+.)) %&amp;gt;&amp;gt;%
  ROC(36, type = &amp;quot;discrete&amp;quot;) %&amp;gt;&amp;gt;%
  na.omit() %&amp;gt;&amp;gt;% 
  (
    plot_ly(
      x = colnames(.),
      y = as.Date(index(.)),
      z = data.matrix(.),
      type = &amp;quot;surface&amp;quot;,
      colors = c(&amp;quot;darkblue&amp;quot;, &amp;quot;yellow&amp;quot;, &amp;quot;darkred&amp;quot;)
    )
  ) %&amp;gt;%
  plotly::layout(
    xaxis = ax, yaxis = ax,
    paper_bgcolor =&amp;#39;rgb(0,0,0)&amp;#39;,
    #plot_bgcolor =&amp;#39;rgb(0,0,0)&amp;#39;,
    title = &amp;quot;Fama French Factors&amp;quot;,
    scene = list(
      xaxis = c(ax, title = &amp;quot;Factors&amp;quot;, tickangle = -45),
      yaxis = c(ax, title = &amp;quot;Date&amp;quot;, tickangle = -45),
      zaxis = c(ax, title = &amp;quot;Fama French Factor&amp;quot;)
    ),
    titlefont = list(
      family = &amp;quot;Agency FB&amp;quot;,
      size = 50,
      color = &amp;#39;white&amp;#39;)
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-2&#34; style=&#34;width:672px;height:480px;&#34; class=&#34;plotly html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-2&#34;&gt;{&#34;x&#34;:{&#34;visdat&#34;:{&#34;1b9c64f422fb&#34;:[&#34;function () &#34;,&#34;plotlyVisDat&#34;]},&#34;cur_data&#34;:&#34;1b9c64f422fb&#34;,&#34;attrs&#34;:{&#34;1b9c64f422fb&#34;:{&#34;x&#34;:[&#34;Mkt_Rf&#34;,&#34;SMB&#34;,&#34;HML&#34;,&#34;RMW&#34;,&#34;CMA&#34;],&#34;y&#34;:[&#34;1993-07-31&#34;,&#34;1993-08-31&#34;,&#34;1993-09-30&#34;,&#34;1993-10-31&#34;,&#34;1993-11-30&#34;,&#34;1993-12-31&#34;,&#34;1994-01-31&#34;,&#34;1994-02-28&#34;,&#34;1994-03-31&#34;,&#34;1994-04-30&#34;,&#34;1994-05-31&#34;,&#34;1994-06-30&#34;,&#34;1994-07-31&#34;,&#34;1994-08-31&#34;,&#34;1994-09-30&#34;,&#34;1994-10-31&#34;,&#34;1994-11-30&#34;,&#34;1994-12-31&#34;,&#34;1995-01-31&#34;,&#34;1995-02-28&#34;,&#34;1995-03-31&#34;,&#34;1995-04-30&#34;,&#34;1995-05-31&#34;,&#34;1995-06-30&#34;,&#34;1995-07-31&#34;,&#34;1995-08-31&#34;,&#34;1995-09-30&#34;,&#34;1995-10-31&#34;,&#34;1995-11-30&#34;,&#34;1995-12-31&#34;,&#34;1996-01-31&#34;,&#34;1996-02-29&#34;,&#34;1996-03-31&#34;,&#34;1996-04-30&#34;,&#34;1996-05-31&#34;,&#34;1996-06-30&#34;,&#34;1996-07-31&#34;,&#34;1996-08-31&#34;,&#34;1996-09-30&#34;,&#34;1996-10-31&#34;,&#34;1996-11-30&#34;,&#34;1996-12-31&#34;,&#34;1997-01-31&#34;,&#34;1997-02-28&#34;,&#34;1997-03-31&#34;,&#34;1997-04-30&#34;,&#34;1997-05-31&#34;,&#34;1997-06-30&#34;,&#34;1997-07-31&#34;,&#34;1997-08-31&#34;,&#34;1997-09-30&#34;,&#34;1997-10-31&#34;,&#34;1997-11-30&#34;,&#34;1997-12-31&#34;,&#34;1998-01-31&#34;,&#34;1998-02-28&#34;,&#34;1998-03-31&#34;,&#34;1998-04-30&#34;,&#34;1998-05-31&#34;,&#34;1998-06-30&#34;,&#34;1998-07-31&#34;,&#34;1998-08-31&#34;,&#34;1998-09-30&#34;,&#34;1998-10-31&#34;,&#34;1998-11-30&#34;,&#34;1998-12-31&#34;,&#34;1999-01-31&#34;,&#34;1999-02-28&#34;,&#34;1999-03-31&#34;,&#34;1999-04-30&#34;,&#34;1999-05-31&#34;,&#34;1999-06-30&#34;,&#34;1999-07-31&#34;,&#34;1999-08-31&#34;,&#34;1999-09-30&#34;,&#34;1999-10-31&#34;,&#34;1999-11-30&#34;,&#34;1999-12-31&#34;,&#34;2000-01-31&#34;,&#34;2000-02-29&#34;,&#34;2000-03-31&#34;,&#34;2000-04-30&#34;,&#34;2000-05-31&#34;,&#34;2000-06-30&#34;,&#34;2000-07-31&#34;,&#34;2000-08-31&#34;,&#34;2000-09-30&#34;,&#34;2000-10-31&#34;,&#34;2000-11-30&#34;,&#34;2000-12-31&#34;,&#34;2001-01-31&#34;,&#34;2001-02-28&#34;,&#34;2001-03-31&#34;,&#34;2001-04-30&#34;,&#34;2001-05-31&#34;,&#34;2001-06-30&#34;,&#34;2001-07-31&#34;,&#34;2001-08-31&#34;,&#34;2001-09-30&#34;,&#34;2001-10-31&#34;,&#34;2001-11-30&#34;,&#34;2001-12-31&#34;,&#34;2002-01-31&#34;,&#34;2002-02-28&#34;,&#34;2002-03-31&#34;,&#34;2002-04-30&#34;,&#34;2002-05-31&#34;,&#34;2002-06-30&#34;,&#34;2002-07-31&#34;,&#34;2002-08-31&#34;,&#34;2002-09-30&#34;,&#34;2002-10-31&#34;,&#34;2002-11-30&#34;,&#34;2002-12-31&#34;,&#34;2003-01-31&#34;,&#34;2003-02-28&#34;,&#34;2003-03-31&#34;,&#34;2003-04-30&#34;,&#34;2003-05-31&#34;,&#34;2003-06-30&#34;,&#34;2003-07-31&#34;,&#34;2003-08-31&#34;,&#34;2003-09-30&#34;,&#34;2003-10-31&#34;,&#34;2003-11-30&#34;,&#34;2003-12-31&#34;,&#34;2004-01-31&#34;,&#34;2004-02-29&#34;,&#34;2004-03-31&#34;,&#34;2004-04-30&#34;,&#34;2004-05-31&#34;,&#34;2004-06-30&#34;,&#34;2004-07-31&#34;,&#34;2004-08-31&#34;,&#34;2004-09-30&#34;,&#34;2004-10-31&#34;,&#34;2004-11-30&#34;,&#34;2004-12-31&#34;,&#34;2005-01-31&#34;,&#34;2005-02-28&#34;,&#34;2005-03-31&#34;,&#34;2005-04-30&#34;,&#34;2005-05-31&#34;,&#34;2005-06-30&#34;,&#34;2005-07-31&#34;,&#34;2005-08-31&#34;,&#34;2005-09-30&#34;,&#34;2005-10-31&#34;,&#34;2005-11-30&#34;,&#34;2005-12-31&#34;,&#34;2006-01-31&#34;,&#34;2006-02-28&#34;,&#34;2006-03-31&#34;,&#34;2006-04-30&#34;,&#34;2006-05-31&#34;,&#34;2006-06-30&#34;,&#34;2006-07-31&#34;,&#34;2006-08-31&#34;,&#34;2006-09-30&#34;,&#34;2006-10-31&#34;,&#34;2006-11-30&#34;,&#34;2006-12-31&#34;,&#34;2007-01-31&#34;,&#34;2007-02-28&#34;,&#34;2007-03-31&#34;,&#34;2007-04-30&#34;,&#34;2007-05-31&#34;,&#34;2007-06-30&#34;,&#34;2007-07-31&#34;,&#34;2007-08-31&#34;,&#34;2007-09-30&#34;,&#34;2007-10-31&#34;,&#34;2007-11-30&#34;,&#34;2007-12-31&#34;,&#34;2008-01-31&#34;,&#34;2008-02-29&#34;,&#34;2008-03-31&#34;,&#34;2008-04-30&#34;,&#34;2008-05-31&#34;,&#34;2008-06-30&#34;,&#34;2008-07-31&#34;,&#34;2008-08-31&#34;,&#34;2008-09-30&#34;,&#34;2008-10-31&#34;,&#34;2008-11-30&#34;,&#34;2008-12-31&#34;,&#34;2009-01-31&#34;,&#34;2009-02-28&#34;,&#34;2009-03-31&#34;,&#34;2009-04-30&#34;,&#34;2009-05-31&#34;,&#34;2009-06-30&#34;,&#34;2009-07-31&#34;,&#34;2009-08-31&#34;,&#34;2009-09-30&#34;,&#34;2009-10-31&#34;,&#34;2009-11-30&#34;,&#34;2009-12-31&#34;,&#34;2010-01-31&#34;,&#34;2010-02-28&#34;,&#34;2010-03-31&#34;,&#34;2010-04-30&#34;,&#34;2010-05-31&#34;,&#34;2010-06-30&#34;,&#34;2010-07-31&#34;,&#34;2010-08-31&#34;,&#34;2010-09-30&#34;,&#34;2010-10-31&#34;,&#34;2010-11-30&#34;,&#34;2010-12-31&#34;,&#34;2011-01-31&#34;,&#34;2011-02-28&#34;,&#34;2011-03-31&#34;,&#34;2011-04-30&#34;,&#34;2011-05-31&#34;,&#34;2011-06-30&#34;,&#34;2011-07-31&#34;,&#34;2011-08-31&#34;,&#34;2011-09-30&#34;,&#34;2011-10-31&#34;,&#34;2011-11-30&#34;,&#34;2011-12-31&#34;,&#34;2012-01-31&#34;,&#34;2012-02-29&#34;,&#34;2012-03-31&#34;,&#34;2012-04-30&#34;,&#34;2012-05-31&#34;,&#34;2012-06-30&#34;,&#34;2012-07-31&#34;,&#34;2012-08-31&#34;,&#34;2012-09-30&#34;,&#34;2012-10-31&#34;,&#34;2012-11-30&#34;,&#34;2012-12-31&#34;,&#34;2013-01-31&#34;,&#34;2013-02-28&#34;,&#34;2013-03-31&#34;,&#34;2013-04-30&#34;,&#34;2013-05-31&#34;,&#34;2013-06-30&#34;,&#34;2013-07-31&#34;,&#34;2013-08-31&#34;,&#34;2013-09-30&#34;,&#34;2013-10-31&#34;,&#34;2013-11-30&#34;,&#34;2013-12-31&#34;,&#34;2014-01-31&#34;,&#34;2014-02-28&#34;,&#34;2014-03-31&#34;,&#34;2014-04-30&#34;,&#34;2014-05-31&#34;,&#34;2014-06-30&#34;,&#34;2014-07-31&#34;,&#34;2014-08-31&#34;,&#34;2014-09-30&#34;,&#34;2014-10-31&#34;,&#34;2014-11-30&#34;,&#34;2014-12-31&#34;,&#34;2015-01-31&#34;,&#34;2015-02-28&#34;,&#34;2015-03-31&#34;,&#34;2015-04-30&#34;,&#34;2015-05-31&#34;,&#34;2015-06-30&#34;,&#34;2015-07-31&#34;,&#34;2015-08-31&#34;,&#34;2015-09-30&#34;,&#34;2015-10-31&#34;,&#34;2015-11-30&#34;,&#34;2015-12-31&#34;,&#34;2016-01-31&#34;,&#34;2016-02-29&#34;,&#34;2016-03-31&#34;,&#34;2016-04-30&#34;,&#34;2016-05-31&#34;,&#34;2016-06-30&#34;,&#34;2016-07-31&#34;,&#34;2016-08-31&#34;,&#34;2016-09-30&#34;,&#34;2016-10-31&#34;,&#34;2016-11-30&#34;,&#34;2016-12-31&#34;,&#34;2017-01-31&#34;,&#34;2017-02-28&#34;,&#34;2017-03-31&#34;,&#34;2017-04-30&#34;,&#34;2017-05-31&#34;,&#34;2017-06-30&#34;,&#34;2017-07-31&#34;,&#34;2017-08-31&#34;,&#34;2017-09-30&#34;,&#34;2017-10-31&#34;,&#34;2017-11-30&#34;,&#34;2017-12-31&#34;,&#34;2018-01-31&#34;,&#34;2018-02-28&#34;,&#34;2018-03-31&#34;,&#34;2018-04-30&#34;,&#34;2018-05-31&#34;,&#34;2018-06-30&#34;,&#34;2018-07-31&#34;,&#34;2018-08-31&#34;,&#34;2018-09-30&#34;,&#34;2018-10-31&#34;,&#34;2018-11-30&#34;,&#34;2018-12-31&#34;,&#34;2019-01-31&#34;,&#34;2019-02-28&#34;,&#34;2019-03-31&#34;,&#34;2019-04-30&#34;,&#34;2019-05-31&#34;,&#34;2019-06-30&#34;,&#34;2019-07-31&#34;,&#34;2019-08-31&#34;,&#34;2019-09-30&#34;],&#34;z&#34;:[[0.235656331824658,0.12719361125789,0.161546203443221,0.0304390482130936,0.0440128290737087],[0.416750972441865,0.168795189900192,0.152453640019518,0.0469779927089966,0.0104393828074874],[0.502715210710106,0.236251162933698,0.153373120334683,0.033770819843445,-0.030401149082101],[0.560093004360497,0.315955130282715,0.135474135913219,0.00331619536480243,-0.0335757459746789],[0.445501580890665,0.297007271192553,0.147597868297894,0.0124536827325159,0.00387471213061752],[0.433515663967857,0.292403873601807,0.172888642184766,-0.000455927336921125,0.0277961309077646],[0.414680750189819,0.257035205070242,0.194923524240401,-0.030846803386302,0.0913122279704728],[0.285437333389163,0.231085846540227,0.195646624708927,-0.00117080011257586,0.0815771584817113],[0.196963905678594,0.176869191257498,0.250480392793265,-0.00696748748434617,0.116952257012042],[0.206316122912184,0.164401858229985,0.255915652823187,-0.00209236544113756,0.132129148505063],[0.173240840144559,0.137403933873663,0.27084611862598,-0.0132756409134801,0.158457733354018],[0.192197832000845,0.121393688174807,0.291192799721722,-0.0234861521684404,0.169586821215297],[0.178556337576989,0.111213596190166,0.331600536630724,-0.0457818627558735,0.190034974625445],[0.200011899756623,0.104833001340247,0.320491446794146,-0.0486116911581397,0.184263942216673],[0.195251400917186,0.116459391106515,0.315437188637601,-0.047945586120943,0.189233378281525],[0.191952530614014,0.0854067246806089,0.298557393134282,-0.0224544740251954,0.189353188212845],[0.192698666783412,0.09064707096754,0.312498960238484,-0.0332841450482498,0.191021452378257],[0.0935238866937333,0.122519553524729,0.38232894820008,-0.0598284071391612,0.2507033517076],[0.116314809422852,0.012975203797587,0.351441890896562,-0.0305858683034936,0.227075146257368],[0.145383204955348,-0.00769368404727278,0.297172810768038,-0.0155752051975765,0.200554919569283],[0.204147981767266,-0.00298463751559075,0.2243748354899,-0.0139877433232731,0.174302345823063],[0.216173982573999,0.0518785863811539,0.200701694819175,-0.0225403920102994,0.151263457623384],[0.247936102134843,0.0360576911683621,0.204270255433855,-0.00513371332929846,0.146701740109274],[0.307373778299483,0.0932451049461138,0.137411887339277,0.00893226123481994,0.102296433544678],[0.306491014100766,0.126781584452029,0.11828128151939,-0.000410624446992025,0.0781126107690535],[0.344075368621888,0.146884533437943,0.146221482111235,-0.0507962731179592,0.0981855782968859],[0.377173441446655,0.125421832633012,0.147147160675428,-0.0573470234760132,0.118573646746753],[0.34252585288411,0.0567636068466464,0.177923990907149,-0.0606662240975765,0.144058109683463],[0.347973257562028,0.015993090589461,0.211250029744542,-0.0781897093423642,0.191187177023668],[0.340937352238925,0.00479867581857851,0.180283602301764,-0.0753131118981941,0.211623636183806],[0.363698945174488,-0.0434551990962814,0.122246069261056,-0.0522054100652527,0.205826393905415],[0.374287091473872,0.00300864221549735,0.0265709543179899,-0.027429641696892,0.129189274109536],[0.354009843983882,0.00958052451334535,0.013306725072691,-0.00471526492904928,0.0984404624529147],[0.417672353843713,0.0626683513919197,-0.0455355182360554,0.0309918575250425,0.0484722747166004],[0.408570566357946,0.0766604472046852,-0.0318064493521603,0.0307864192750624,0.0566584808769306],[0.39002935028702,0.0272743146978776,-0.0316164025270259,0.0683509152732753,0.0596804824494583],[0.314402377002984,-0.020985530963431,-0.00233727298283182,0.101119753015762,0.0765288717081505],[0.305265770404778,-0.00288086887943817,-0.00811620418896331,0.0909914769432321,0.0550887950998713],[0.37377781355228,-0.0462127535603084,-0.0375712486485237,0.098722826864678,0.0269038317890493],[0.368644215665075,-0.0881580452462788,0.0438375711391912,0.0917702600346066,0.0546054979661184],[0.482721143361634,-0.112487398406493,0.0749247953123675,0.0959931143578587,0.0602411191994521],[0.433715211414997,-0.0938713232568118,0.0698212948004988,0.0963223073237252,0.079280360806264],[0.4625567127525,-0.107299484281944,0.0335134803815706,0.129249927020376,0.0530448895850839],[0.496503289427253,-0.147471007489256,0.0944554606278381,0.109186262341304,0.120244659541414],[0.491953216519579,-0.145924079881878,0.11716021947087,0.124145094784313,0.130712176277564],[0.540740872640734,-0.191043444146704,0.0971618758155439,0.157880655455308,0.101399480135523],[0.630976837983005,-0.134348616976711,0.0438689897555926,0.172761331759985,0.056715509998446],[0.749363695711662,-0.121554453161668,0.0329368196563609,0.175797758231381,0.0425140164856161],[0.825763296856934,-0.130853958136341,0.0246124855212335,0.178273866627175,0.0176228226854103],[0.68360543177435,-0.0703607705168348,0.0539411900929401,0.160399991791368,0.0214453652680864],[0.813073864181017,-0.0718988597529627,0.0667291519545328,0.140103140360734,0.00345752031211677],[0.724902238088593,-0.0619771920960762,0.111577925074181,0.136499495507757,0.0288295196672432],[0.843960238465473,-0.115498012967471,0.134742826699399,0.159934797883648,0.0619744026420159],[0.8532814766617,-0.12872072753232,0.176825100517058,0.152208818019029,0.081229168659235],[0.827691240274222,-0.124987435403811,0.136248922290186,0.154601893400139,0.0696865645440461],[0.887303286902871,-0.12155359660131,0.121118508339388,0.143785411640161,0.0501572859297159],[0.935108817593125,-0.123583972169411,0.153935067989936,0.14113829305818,0.0534209326328559],[0.9102900144695,-0.121916947989936,0.141876992555499,0.125988916141387,0.032236205675334],[0.803028733299559,-0.131034780760477,0.160938352861888,0.138259741162324,0.0555397977875467],[0.809889037748211,-0.188802751954098,0.166913946607316,0.132932295650013,0.0542347825831937],[0.698780019600734,-0.246620609461188,0.174325200929141,0.144310058587335,0.0940803868824052],[0.414607543439043,-0.290243167968015,0.170876375082066,0.214962314879126,0.150848708843285],[0.452992087693615,-0.283403352686716,0.139697096988293,0.189029931507835,0.113228097261483],[0.580398323385506,-0.277350132493539,0.129961969539393,0.178876260125701,0.111671290412851],[0.609138367946255,-0.270808999226358,0.0838364584266291,0.19888971295085,0.0904494744831099],[0.687834967665635,-0.284445516499356,0.0367699777229393,0.212244129221552,0.0115937835210702],[0.702826962009956,-0.279676620628594,-0.00917271509803308,0.188382009571607,-0.0674121673897199],[0.612000553526612,-0.323578948490959,0.0294217605655285,0.165825308091227,-0.0076345512976107],[0.652128703773085,-0.356135756177754,-0.00273490886903516,0.137020932052855,-0.0273199800957551],[0.690196185426843,-0.361046533135117,0.0626527816422324,0.108618040537601,-0.00169952656337924],[0.619702395041897,-0.358815680181268,0.0931126962785895,0.112263720192583,0.0305425955790051],[0.713977716337787,-0.323253636220458,0.0355127043345604,0.091246951738569,-0.0171892917764586],[0.758191791185991,-0.283221939732876,-0.00713124401207743,0.0886661548483718,-0.0330456716695445],[0.685888162207606,-0.311140179292285,-0.024385517722365,0.10349662214449,-0.0114217568421809],[0.564353743343398,-0.277037513216707,-0.0399159937163092,0.0837014894776758,-0.00339362349416816],[0.631059973441547,-0.308438389272701,-0.116069707523365,0.0530774871879585,-0.0400044422104336],[0.577673134581722,-0.247744739467366,-0.208478638930302,0.0229063281991708,-0.0820782621637022],[0.719069882452169,-0.24570353903177,-0.282108532983297,-0.0352470893183078,-0.161594691409598],[0.567584730383172,-0.212201399236759,-0.270810616708794,-0.103333832248695,-0.115233611959491],[0.59921019769292,-0.0563562186936151,-0.403169664294586,-0.23732464638257,-0.195728091791677],[0.796651860548267,-0.181979153154105,-0.369999648526716,-0.159693838293407,-0.218299745422938],[0.645172839389433,-0.155284647540919,-0.323877439520509,-0.13472297471351,-0.148134988712772],[0.487968120396763,-0.209881413796043,-0.261646380980994,-0.108960905222514,-0.0905179370402545],[0.484816859456377,-0.159936337208494,-0.345560160234489,-0.161442647694013,-0.142697627835499],[0.352664007566271,-0.148787344152928,-0.282741812525804,-0.113863140162991,-0.0808413007066509],[0.510448957474189,-0.210437264675086,-0.298194412615014,-0.14678214764108,-0.0753562836885152],[0.3556082440527,-0.22398406145976,-0.231168824049575,-0.0999115840323502,0.0200672474965569],[0.36772069173982,-0.245012397056348,-0.198575357375914,-0.0207123655048754,0.0845104819375362],[0.196438787107622,-0.204457861271901,-0.0788898022838032,0.0839225444460361,0.204451013089104],[0.197618707016012,-0.150330528956728,-0.0110550704137208,0.0921669513093166,0.275044570509885],[0.236664981492182,-0.107691691218474,-0.0763389566949494,0.0129384959981884,0.148131602469016],[0.0427462973557569,-0.0844381921422784,0.0910158843671702,0.119735230787535,0.334276847377688],[-0.0781979507923356,-0.0646108564563991,0.192177523097374,0.174620891116606,0.445088766243454],[-0.0157571296469586,-0.0656389620298383,0.0886131875583314,0.150675913211874,0.359168498552319],[0.0215217275257378,-0.00508475424039256,0.0784599896563007,0.132467215148983,0.344759884825204],[-0.026630477533061,0.0831429934083177,0.106073160223084,0.142551215363916,0.359603015388057],[-0.0207245949923834,0.104381091318285,0.161354300458175,0.205426400379512,0.421195769440871],[0.0965356769743508,0.179299386318344,0.185071698052216,0.199527086837687,0.436464595439161],[-0.0623735408605962,0.120292946613076,0.248193651710127,0.263287706994205,0.557383581353241],[-0.103014239323061,0.221316260930201,0.175574235930518,0.235147945181147,0.45674641084667],[-0.0867393134064126,0.216690524070304,0.216529883661904,0.200948027066875,0.413118934389933],[-0.123631769646343,0.29846100734031,0.298603463454983,0.198206680835976,0.491379439638278],[-0.165771379793959,0.332450055912979,0.403263780271012,0.28113220690749,0.648040945270779],[-0.148971909458007,0.384255179324311,0.446371206242631,0.397503890060391,0.696651997860647],[-0.141395503000695,0.489390299668806,0.496118439869156,0.412290786445199,0.744410642550786],[-0.220063885129441,0.513715052377395,0.556044236512522,0.493161984893271,0.860425969886399],[-0.212254962034088,0.426669487850039,0.576574950149059,0.501170601022019,0.895059630729313],[-0.302824578698618,0.439047178368702,0.67129356120007,0.54558128692538,1.0130856172173],[-0.33882691081384,0.332874091428508,0.59654079824355,0.57764095407812,0.960505022737744],[-0.325687914009573,0.347089609925205,0.653665034533189,0.590205541069284,0.934265742569261],[-0.377174285388762,0.348789325049832,0.738747153300134,0.643645690950813,0.938604872408816],[-0.365853397648029,0.389617855498958,0.679903873658941,0.631359582468384,0.948748508287792],[-0.347046054812814,0.359258247310594,0.807110997316257,0.537612820457131,1.12637200878098],[-0.423796033058605,0.32483999460011,1.06512826988946,0.713190809930958,1.2562302907156],[-0.412900408527014,0.29957056691019,1.05542604790978,0.797365451448357,1.17373281079596],[-0.432135371529818,0.103543467341974,1.39222047766962,1.14307799338573,1.24693318363389],[-0.464028919885347,0.283133477929722,1.14053417319356,0.95571560910595,1.24468039319512],[-0.390849769888612,0.338524347884759,0.99231876105194,0.769299400454565,1.09564645493395],[-0.328513712126047,0.426226904053024,0.904288713171937,0.645360895833609,1.06525998920943],[-0.342440931100859,0.346748412894352,1.12636010088142,0.750073573425975,1.16133379250493],[-0.312842364316652,0.421134760403188,0.926119912009178,0.590147342521044,1.08417277318488],[-0.342478924033391,0.464065467235922,0.990127566577475,0.624730220735638,1.13844592301948],[-0.312673710425014,0.459563778138093,0.816812608882647,0.585091190277961,0.961567214065054],[-0.249468852368124,0.552656684260796,0.753794894045749,0.420663242579728,0.847001972471013],[-0.150809445181372,0.600678606693605,0.524401304265839,0.241381650405121,0.628579239646941],[-0.12554288877199,0.490465946572226,0.396098556989886,0.228681778534667,0.520950608872603],[-0.135367297963511,0.466677314227051,0.544950664442598,0.266077009849014,0.736428548196585],[-0.0272762320323171,0.430859269042255,0.329042228305028,0.172054545338931,0.516285454030384],[0.0371661928200955,0.444825064924655,0.205938280716681,0.142981372307737,0.390919414830308],[-0.0577259398129899,0.416497995531313,0.278826106105841,0.236931563143562,0.467093416369843],[-0.0538013552703623,0.365727948546277,0.261017602912055,0.222636805856705,0.446759181462919],[-0.0151967594021603,0.328950324263422,0.275750882275018,0.219120694455492,0.47746277392739],[-0.0317057782571175,0.339392861964417,0.286139934539788,0.178054857868906,0.389018680010861],[0.0338116749536603,0.296258538199118,0.255573537558038,0.142951776761723,0.277578785912568],[0.164421226738052,0.423210987313067,0.235684976012698,0.0953930050837164,0.187435085801423],[0.155893583733916,0.35759909774428,0.330502387538424,0.112030201394222,0.284070536586888],[0.122527804585852,0.41695585669518,0.356251450980353,0.146327421546198,0.32571606750322],[0.1407452814971,0.341720453589879,0.332619190021156,0.135836809511755,0.319284375690581],[0.128571457474619,0.322943025901922,0.314160787834695,0.117321261901983,0.265537164776865],[0.17970750694391,0.336385404736539,0.272866457232386,0.0630823656931492,0.181011054608512],[0.112496087499762,0.270235356774811,0.279542550476653,0.0840593256927322,0.19446381842],[0.13996222850788,0.153405883087138,0.187772568484328,0.0550687451543186,0.110135567569],[0.193351112970671,0.209112832526642,0.144717255749182,0.0351598209965953,0.0580863447091007],[0.29944965818947,0.220576418173703,0.146395070761516,0.0105060290974381,0.0234741239590555],[0.475139108920238,0.324776689988596,0.169619198293223,-0.0197094114861801,0.0224421879599033],[0.456074780044641,0.327040127549381,0.174121285613933,-0.0343290538432751,0.035277056486632],[0.634925086805798,0.289734811827267,0.178200118864204,-0.0479061497470602,0.0372783042303748],[0.481845629584651,0.317684889016272,0.252686926891501,-0.034547564826561,0.0337480277194804],[0.453717291540783,0.305421951667473,0.257769336575613,0.0379629450343124,-0.0160364346363264],[0.540306673167684,0.297137667591447,0.209166302474551,-0.0106776654006702,0.000973307697599068],[0.634433893223865,0.360707708046822,0.218031336127323,0.00145695218539332,-0.0141823793997248],[0.653552995829983,0.367849088831888,0.22557709380517,-0.0236489345469594,0.0176342758988879],[0.662900662274723,0.406083864201053,0.251198479102953,-0.0337740567072131,0.0160001783061157],[0.555711005231767,0.394251656651594,0.287954159309205,0.0180310749157169,0.00316627909735545],[0.413923574450204,0.307846575090108,0.309464875957375,0.0709240822509309,0.00504839219134667],[0.385230021466583,0.281645760450485,0.316662614132236,0.0790001122421069,0.0129501938838097],[0.346039470687939,0.20074903969079,0.362821628792156,0.139837950774987,0.00753549278801402],[0.341180596501066,0.175599400768869,0.333645198893981,0.145320184062586,0.00802914075116345],[0.373717071095249,0.144604092719545,0.342437585581326,0.130942832735518,0.0209422442355658],[0.337832534251286,0.137585399139505,0.289520191166643,0.15657033519462,-0.00430826568173326],[0.34126016983372,0.110126824568269,0.281973153047524,0.154827987597159,-0.0266800387877657],[0.291598125657902,0.132070134394331,0.288903418765788,0.145325138125712,-0.0173360130318683],[0.280717780980992,0.111371712591781,0.262819983341604,0.187078703524697,-0.0303495149193215],[0.239587449328957,0.130734752342554,0.256060911173852,0.163505178346562,-0.0242628155090754],[0.265678745570651,0.103244715891344,0.256936563636577,0.154672495833234,-0.0279926226724045],[0.343966818474265,0.110336279721683,0.276980305134897,0.12591947435253,-0.0122212830139099],[0.376218836733128,0.112450146386484,0.273805316807858,0.163121978334288,-0.0303384365152497],[0.325237778296718,0.0984762878253973,0.249287299161275,0.165204145973275,-0.0324697737514034],[0.330473149496976,0.0975747890253764,0.165552973984296,0.136287820604877,-0.0478227692065888],[0.33885177888705,0.0953545507548688,0.136833454617444,0.113586910959555,-0.0425600069019322],[0.361804273137171,0.0382707619138725,0.109557634452675,0.114818012067149,-0.0612417628648212],[0.370645418329681,0.0394064996208188,0.0638667053777624,0.111371038361376,-0.0764668766791181],[0.23846714946849,-0.0396051332587163,0.042616722733017,0.128550903819241,-0.0584276674640306],[0.19207857157028,-0.0308383629835175,0.0372892552588777,0.153249638588099,-0.0737911002106129],[0.146398963269919,-0.0341554050268595,0.069077316121344,0.114692498815554,-0.0475671132888651],[0.0967067185802344,-0.0338668347863537,0.0455349135642085,0.115895561755798,-0.0668398282013811],[0.100945414197205,-0.0221205349053366,0.0348304805054689,0.113582025691342,-0.0616771163242104],[0.187098473792538,-0.000742782701518285,0.0384600091974914,0.131587567818878,-0.0773693990856632],[0.17482486893257,0.00502423048645118,0.0161556851116724,0.161441151825378,-0.0819079895328878],[0.072149924977108,-0.0175518366584808,-0.0370861533998864,0.208476994599815,-0.0916739456903903],[0.0147446084134004,-0.0177433470217051,-0.00957711634779113,0.169178889837766,-0.0491362701555037],[0.0321186222547014,0.00719002643103983,-0.015127613286949,0.196491771463212,-0.0282214510627434],[-0.0792544633215342,-0.0026548391774025,0.0124410202877092,0.166632796774291,0.0378926459912741],[-0.229343164366065,-0.0206570922332457,0.00979704012223293,0.213872582420457,0.0768813813870892],[-0.315474526146099,-0.0758558915437424,-0.01152305093601,0.251276866552052,0.116032794970138],[-0.306247273128598,-0.0371231776876773,-0.0293680866212863,0.25002646496661,0.100860817749433],[-0.379919535843031,-0.103415434794105,-0.102431605524669,0.281571294645318,0.0814869144128898],[-0.438149492963744,-0.10980675046977,-0.157159211702211,0.317391205817944,0.0363322123115577],[-0.397035777360105,-0.13280290511433,-0.151434191863609,0.290701543664147,0.0202892729573176],[-0.341483913431637,-0.0803347102759999,-0.137466370535563,0.292101712991593,0.0181309094303606],[-0.272858672908575,-0.0748795469702124,-0.15635827754642,0.260065074268208,-0.0303371793982284],[-0.270518952197975,-0.0539176031704436,-0.187383765798862,0.234253223229426,-0.0267490681508772],[-0.20518461293785,-0.00776487250452607,-0.170488962686628,0.206246293341623,-0.015416428916567],[-0.19825828674099,-0.010331848953768,-0.118472039084559,0.20415787425752,-0.00982329991335051],[-0.172860172662618,0.0441777702383348,-0.113485724330944,0.225251730913683,-0.0329143771090472],[-0.221157385394722,-0.0134969200382707,-0.127072150011696,0.262992990510587,-0.036709922977292],[-0.190306827729504,-0.0323655449404027,-0.131601410458652,0.276585854117973,-0.033198537520344],[-0.171160580834285,0.0252629809057698,-0.147052436296615,0.303582357559303,-0.0556602517255865],[-0.210952733132471,0.0321411845425663,-0.132958390911491,0.283449309988389,-0.0440191215152251],[-0.167103388836322,0.0290938235016966,-0.115678039958058,0.285122814605224,-0.0355548577757483],[-0.122775789213438,0.0474245250511114,-0.106877065037258,0.260993248545182,-0.020069976667634],[-0.139161452307275,0.105508589852709,-0.0783875739473077,0.257263234992001,-0.00901997241291308],[-0.235050016545398,0.109378256883897,-0.102461597439412,0.241177788623636,0.00848921978856465],[-0.264321459022391,0.0829172370417046,-0.130374174572184,0.230950670937171,0.00495491292037586],[-0.18524572892663,0.113270050769876,-0.0944310745931531,0.220346382555001,0.047310906290732],[-0.226602581267794,0.107403014929191,-0.106418698807815,0.246337532690554,0.0136077170217317],[-0.184591973142496,0.164461280027677,-0.10165927776285,0.24883996725072,0.0497479590050935],[-0.17208033707754,0.166312018130433,-0.0780606264542125,0.259835256607204,0.0566069876877766],[-0.117171766244837,0.255609483570858,-0.0679212468036735,0.235212666147095,0.0498245015926055],[-0.051658720844001,0.264096704732172,-0.0311261943109282,0.170048190096305,0.0887934094599552],[0.0331358150660057,0.249668126183209,-0.063812873736634,0.175444442025764,0.0762492166932811],[0.0990739094304516,0.266589160149848,-0.0551549308721156,0.130398987077997,0.0922358262809522],[0.11833832547214,0.294355228825805,-0.076017831742057,0.143259679946415,0.0815044858773271],[0.0977272390687673,0.319408966955074,-0.0976087871417335,0.128751308373491,0.101117835672438],[0.0559274320743501,0.27128813806885,-0.0829161025135795,0.137610339538985,0.102228729372673],[0.125061443099413,0.253659340591667,-0.0565707146018506,0.109099884855266,0.118775017226122],[0.116605771071244,0.213206889652318,-0.0864913518418985,0.166161524461698,0.0572920091448565],[0.0400941170875524,0.151952999724667,-0.112413537131732,0.159877711015495,0.0277101744143315],[0.0561524401215596,0.11401095390376,-0.147428494292897,0.209707923463144,-0.0207538155561487],[0.444103030027715,0.194996276131678,-0.142277004832431,0.169963925977702,-0.0527949782223657],[0.557884638657838,0.243582523133574,-0.116430243780942,0.159597157013343,-0.0662710972225153],[0.539926756616166,0.183910571779305,-0.0739794063313113,0.160525113125787,-0.0255836805023775],[0.752519888313339,0.230444533924196,-0.0368387420892894,0.115750018411518,-0.0122410087744682],[1.02866039446125,0.227831596800887,0.0214235505846665,0.106483358183461,0.0123089999058841],[0.90897651528057,0.209715847989548,0.0216262340950513,0.118881562258044,0.0475548002906001],[0.716834780578181,0.128286095465304,-0.0235030964835055,0.114913506279195,0.062253984344748],[0.501224789390293,0.142739536704489,-0.0192077986973689,0.157546220441809,0.127332568504128],[0.560960806368137,0.129686086556018,0.0137855206323865,0.151494299723633,0.132050381166262],[0.45790708322927,0.0818967808967739,-0.0236328395668965,0.172999089290449,0.114677055100159],[0.454227643881186,0.0872933131239129,-0.0691120422775174,0.183410323810778,0.0742933518962967],[0.430022974851596,0.0628621219718795,-0.0746235162723219,0.143943909666966,0.0955966194976399],[0.446640888895018,0.0972368480064212,-0.0193814017921629,0.0917860660895147,0.132455952119656],[0.376613458138258,0.119640867363367,-0.0233156790166676,0.0945022220903349,0.15210712481584],[0.353498430645496,0.0816473668405155,0.00302864774619538,0.0676060121142743,0.164826091468765],[0.479339936701153,0.0803563614295262,0.0105844191039821,0.0716037271682393,0.168944105736945],[0.440113393205558,0.0573224088020681,-0.0129152478961886,0.0760047842466622,0.179203114543652],[0.405421661892805,0.0479664932783059,-0.0313963380518569,0.0970302903071669,0.194672684322997],[0.396458513538897,-0.019978697670004,-0.0490764441482607,0.0894361328386639,0.190192956475722],[0.553927625278306,-0.00825829142328305,-0.0140301214510221,0.0722762376150063,0.176773299313304],[0.619373466004313,0.0192059464847671,0.0288826633326094,0.0712028880278039,0.183158524209096],[0.600295293333294,0.0357974344780776,0.0197171244134828,0.0571869493210877,0.15627909044328],[0.632281103403058,0.0581702369344557,0.023058747350629,0.0580268197872813,0.166905777664413],[0.548035298760441,0.0433413315168953,0.0295212682202917,0.0617369629285052,0.152658129058022],[0.551015441793958,0.0188176881994795,0.0521090380461506,0.0702662393340601,0.158644169476579],[0.581478794385487,-0.00985097952281477,0.043288962278099,0.0757338921644755,0.157838035972322],[0.519451310078876,-0.0283282864807718,0.0105408878954112,0.108311603895654,0.124640807322442],[0.438993994189232,-0.00112505264974405,-0.0165689968572815,0.0723633732303763,0.0976467618681403],[0.44881695098064,-0.0175113116092227,-0.0247969056485153,0.0923636277453741,0.0936853299456086],[0.451557917033476,-0.0460938505897358,0.0383849872625808,0.0868072442334149,0.109095462596162],[0.415689086317793,-0.076505209940313,0.0796868032181168,0.105826908286145,0.126841882899351],[0.465407765151122,-0.0854539835191694,0.0903063144645331,0.077301245802369,0.123775491966245],[0.535445087260149,-0.0543138570038015,0.0956536279875801,0.0265306710245361,0.0980590347202901],[0.538901881357541,-0.0864178390920175,0.115157176446316,0.0143508111310304,0.120015734455566],[0.702329433124968,-0.0545968611049092,0.12287374182724,0.00435917587560253,0.121142964462063],[0.816476003077452,-0.0534152302678359,0.0950915306450977,-0.0106049836247348,0.108613727581226],[0.661303752187096,-0.0639542222824739,0.0590269547109399,0.00309910263989055,0.104841423063836],[0.706032444731414,-0.0788465023025495,0.0294268224364107,-0.00153255644489902,0.0938104835888018],[0.697020213138594,-0.0554006436589423,0.00598087329194885,-0.0187974107912291,0.0713989461992857],[0.556125782979657,-0.0880780766839334,0.00243538249771991,0.0178867863873573,0.0761868350508768],[0.583423618321421,-0.0709818509225358,-0.0135587999114977,0.00479532123840753,0.0526653862608426],[0.527756381739808,-0.0364832512350493,-0.0305849648569793,0.0121842663830034,0.0324118341818227],[0.554664329284541,-0.050974418648593,0.0038183356383219,-0.00522750448705533,0.0244978758710217],[0.682969959890018,-0.0432579890070085,-0.0190615686974176,-0.0391368813543788,-0.0075707558359116],[0.594554823188643,-0.0226726444134747,-0.0330651821222224,-0.032241663907053,-0.0249023242991862],[0.59518626753007,-0.0497540056981319,-0.0870184553199301,-0.03157034210023,-0.0474068265558438],[0.460287779160701,-0.0539043753377273,-0.0608554020992473,-0.0187415135852265,-0.0280584809755815],[0.372926204823753,-0.0901809042928746,-0.0606689529037142,0.0132147977981161,-0.0384721401079861],[0.500770100688199,-0.105894217322458,-0.0843587203490838,0.0246762721293343,-0.0591481374861739],[0.497787944502033,-0.0860351394080596,-0.0897990864618133,-0.00410905495152758,-0.0742629730402438],[0.442341697790457,-0.131051854480387,-0.135847242777663,0.00570417358054276,-0.0773873584796554],[0.290891026779706,-0.161683963971917,-0.112043723641189,0.0417018527115263,-0.0727828722561955],[0.281940712608293,-0.141222795972038,-0.105382053067326,0.0566664443705907,-0.0598577496648088],[0.322607812641861,-0.135344844669793,-0.0838206645089966,0.0506853135533987,-0.073691508498464],[0.320648780629456,-0.0891635915091824,-0.0498440018273528,0.00851979061354413,-0.0587362505631677],[0.30596488703814,-0.108987783578955,-0.085868873795984,0.0214927485197449,-0.0725099152789151],[0.324663206399673,-0.112695185311636,-0.0915105351362836,0.0271222175747132,-0.0522100623352892],[0.302478951736721,-0.109992114433556,-0.119455681963211,0.0545648109802113,-0.0659805574216004],[0.34203304732655,-0.101293523350928,-0.086110582239658,0.0383455665168322,-0.0466751315134004],[0.297048699371471,-0.107371816517835,-0.0850002579495777,0.0193741968410555,-0.0353743200024649],[0.22053914980724,-0.122511863911856,-0.0638100243845494,0.00372854801114531,-0.0376744706552161],[0.241318831801234,-0.083531726582407,0.00421827295787769,-0.0261812422873728,-0.0129798230949463],[0.230676191777997,-0.0768004473833441,0.0361588021437755,-0.0192211927808703,-0.00386276925204809],[0.301652236385612,-0.0906562402911183,0.0295430116770625,0.0111278162099226,-0.00940750639314081],[0.283504678468089,-0.10891031955822,0.00100204429830897,0.0164894744649628,-0.0182778889196537],[0.27814717533793,-0.0968637076555565,-0.0731002180315402,0.0148904348826759,-0.0507458021823892],[0.285669438015729,-0.0692670995690533,-0.117398899714761,0.00404232023520801,-0.0752857532155109],[0.272432009991445,-0.0769512668236559,-0.151784804615923,0.0267155380982336,-0.0825750620835444],[0.249661392423032,-0.0808066427854418,-0.141731257977406,0.0226237839611161,-0.0692518527171977],[0.301082011286262,-0.0530103890219149,-0.134955000669812,0.00750311870258624,-0.0703689739181772],[0.251194280890028,-0.0709279379251053,-0.146757029463099,0.0145191571336625,-0.0882213292350511],[0.314427369611584,-0.00221159171317864,-0.10293806014629,-0.00814605930684842,-0.0641157781008013],[0.313783231921879,-0.0390400849503172,-0.08631720441357,0.00471203924621411,-0.093250555042833],[0.322265886324818,-0.0175062446355847,-0.0684258583184014,0.0207763257008022,-0.0940654072649614],[0.340549723229911,-0.0392901736763341,-0.0774801344152769,0.0461088545322705,-0.0921793532898015],[0.461370013213338,-0.0550442977642412,-0.0677875819941745,0.0259263607174771,-0.0918121861930534],[0.322323031268404,-0.0618121094185707,-0.0789348322297531,0.0451993940568822,-0.0988545567521113],[0.30934071001,-0.0576932357526032,-0.0713111980562231,0.039868877147192,-0.0921458281001653],[0.299498963994694,-0.0306543042103539,-0.087674966277132,0.0254335180237324,-0.0794861441220276],[0.318927116822733,-0.0064279007807807,-0.102542760674734,0.0261614395962064,-0.0907910253800416],[0.347106452923331,-0.0296806851603626,-0.0989980136285842,0.0408870879516761,-0.0738960090873662],[0.374568494417859,-0.00172112135070224,-0.0461316510213025,0.0415055591863474,-0.046050378761296],[0.506370427230116,0.00345440224747962,-0.130464759066043,0.0471184633975312,-0.088849148536589],[0.559518106038752,0.0113116590546927,-0.144617575611614,0.0367979581403115,-0.0785242341547834],[0.337040585843138,-0.00584147626798848,-0.124013102066176,0.0376263196368782,-0.053211494607542],[0.352613880869882,-0.042330606775917,-0.111500271288274,0.0527811111503163,-0.0360353274063081],[0.254443647383888,-0.0340288287541604,-0.0984394341165215,0.0575467433806518,-0.0444844201541413],[0.445131856432483,0.0266933474729989,-0.146257964848876,0.0221339058723342,-0.0799324664950635],[0.490679598965165,0.0300290647582806,-0.177620609110782,0.00403948188954328,-0.112317838920501],[0.406532825341337,-0.0192905535148742,-0.221086238811634,0.0179775112496399,-0.133263744155052],[0.445201350405111,-0.0534279630697875,-0.241356765608826,0.0660301897036897,-0.165621672412058],[0.328176958583177,-0.0589551127870885,-0.233026015805885,0.0611264508310527,-0.137250758364619],[0.422581367492382,-0.0594232011710984,-0.242167632804993,0.0619723912004249,-0.163829341358765],[0.383567155624086,-0.0874368532573123,-0.226706446951865,0.0494108646411293,-0.150481217982387],[0.34333997157129,-0.128806382576314,-0.257963690293995,0.0724655425098955,-0.153632315218944],[0.359137671057578,-0.13774787435684,-0.204012420531773,0.106058483330912,-0.125581078244624]],&#34;colors&#34;:[&#34;darkblue&#34;,&#34;yellow&#34;,&#34;darkred&#34;],&#34;alpha_stroke&#34;:1,&#34;sizes&#34;:[10,100],&#34;spans&#34;:[1,20],&#34;type&#34;:&#34;surface&#34;}},&#34;layout&#34;:{&#34;margin&#34;:{&#34;b&#34;:40,&#34;l&#34;:60,&#34;t&#34;:25,&#34;r&#34;:10},&#34;xaxis&#34;:{&#34;zeroline&#34;:true,&#34;showline&#34;:true,&#34;mirror&#34;:&#34;ticks&#34;,&#34;gridcolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;gridwidth&#34;:2,&#34;zerolinecolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;zerolinewidth&#34;:4,&#34;linecolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;linewidth&#34;:6,&#34;color&#34;:&#34;white&#34;},&#34;yaxis&#34;:{&#34;zeroline&#34;:true,&#34;showline&#34;:true,&#34;mirror&#34;:&#34;ticks&#34;,&#34;gridcolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;gridwidth&#34;:2,&#34;zerolinecolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;zerolinewidth&#34;:4,&#34;linecolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;linewidth&#34;:6,&#34;color&#34;:&#34;white&#34;},&#34;paper_bgcolor&#34;:&#34;rgb(0,0,0)&#34;,&#34;title&#34;:&#34;Fama French Factors&#34;,&#34;scene&#34;:{&#34;xaxis&#34;:{&#34;zeroline&#34;:true,&#34;showline&#34;:true,&#34;mirror&#34;:&#34;ticks&#34;,&#34;gridcolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;gridwidth&#34;:2,&#34;zerolinecolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;zerolinewidth&#34;:4,&#34;linecolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;linewidth&#34;:6,&#34;color&#34;:&#34;white&#34;,&#34;title&#34;:&#34;Factors&#34;,&#34;tickangle&#34;:-45},&#34;yaxis&#34;:{&#34;zeroline&#34;:true,&#34;showline&#34;:true,&#34;mirror&#34;:&#34;ticks&#34;,&#34;gridcolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;gridwidth&#34;:2,&#34;zerolinecolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;zerolinewidth&#34;:4,&#34;linecolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;linewidth&#34;:6,&#34;color&#34;:&#34;white&#34;,&#34;title&#34;:&#34;Date&#34;,&#34;tickangle&#34;:-45},&#34;zaxis&#34;:{&#34;zeroline&#34;:true,&#34;showline&#34;:true,&#34;mirror&#34;:&#34;ticks&#34;,&#34;gridcolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;gridwidth&#34;:2,&#34;zerolinecolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;zerolinewidth&#34;:4,&#34;linecolor&#34;:&#34;rgba(255,255,255,1)&#34;,&#34;linewidth&#34;:6,&#34;color&#34;:&#34;white&#34;,&#34;title&#34;:&#34;Fama French Factor&#34;}},&#34;titlefont&#34;:{&#34;family&#34;:&#34;Agency FB&#34;,&#34;size&#34;:50,&#34;color&#34;:&#34;white&#34;},&#34;hovermode&#34;:&#34;closest&#34;,&#34;showlegend&#34;:false,&#34;legend&#34;:{&#34;yanchor&#34;:&#34;top&#34;,&#34;y&#34;:0.5}},&#34;source&#34;:&#34;A&#34;,&#34;config&#34;:{&#34;showSendToCloud&#34;:false},&#34;data&#34;:[{&#34;colorbar&#34;:{&#34;title&#34;:&#34;&#34;,&#34;ticklen&#34;:2,&#34;len&#34;:0.5,&#34;lenmode&#34;:&#34;fraction&#34;,&#34;y&#34;:1,&#34;yanchor&#34;:&#34;top&#34;},&#34;colorscale&#34;:[[&#34;0&#34;,&#34;rgba(0,0,139,1)&#34;],[&#34;0.0416666666666667&#34;,&#34;rgba(61,23,136,1)&#34;],[&#34;0.0833333333333334&#34;,&#34;rgba(89,44,132,1)&#34;],[&#34;0.125&#34;,&#34;rgba(112,64,128,1)&#34;],[&#34;0.166666666666667&#34;,&#34;rgba(131,84,124,1)&#34;],[&#34;0.208333333333333&#34;,&#34;rgba(149,104,118,1)&#34;],[&#34;0.25&#34;,&#34;rgba(166,124,112,1)&#34;],[&#34;0.291666666666667&#34;,&#34;rgba(182,145,105,1)&#34;],[&#34;0.333333333333333&#34;,&#34;rgba(197,167,97,1)&#34;],[&#34;0.375&#34;,&#34;rgba(212,188,86,1)&#34;],[&#34;0.416666666666667&#34;,&#34;rgba(227,210,72,1)&#34;],[&#34;0.458333333333333&#34;,&#34;rgba(241,232,52,1)&#34;],[&#34;0.5&#34;,&#34;rgba(255,255,0,1)&#34;],[&#34;0.541666666666667&#34;,&#34;rgba(247,235,0,1)&#34;],[&#34;0.583333333333333&#34;,&#34;rgba(238,216,0,1)&#34;],[&#34;0.625&#34;,&#34;rgba(229,197,0,1)&#34;],[&#34;0.666666666666667&#34;,&#34;rgba(220,177,0,1)&#34;],[&#34;0.708333333333333&#34;,&#34;rgba(211,158,0,1)&#34;],[&#34;0.75&#34;,&#34;rgba(202,140,0,1)&#34;],[&#34;0.791666666666667&#34;,&#34;rgba(192,121,0,1)&#34;],[&#34;0.833333333333333&#34;,&#34;rgba(182,102,0,1)&#34;],[&#34;0.875&#34;,&#34;rgba(172,82,1,1)&#34;],[&#34;0.916666666666667&#34;,&#34;rgba(161,62,1,1)&#34;],[&#34;0.958333333333333&#34;,&#34;rgba(150,39,2,1)&#34;],[&#34;1&#34;,&#34;rgba(139,0,0,1)&#34;]],&#34;showscale&#34;:true,&#34;x&#34;:[&#34;Mkt_Rf&#34;,&#34;SMB&#34;,&#34;HML&#34;,&#34;RMW&#34;,&#34;CMA&#34;],&#34;y&#34;:[&#34;1993-07-31&#34;,&#34;1993-08-31&#34;,&#34;1993-09-30&#34;,&#34;1993-10-31&#34;,&#34;1993-11-30&#34;,&#34;1993-12-31&#34;,&#34;1994-01-31&#34;,&#34;1994-02-28&#34;,&#34;1994-03-31&#34;,&#34;1994-04-30&#34;,&#34;1994-05-31&#34;,&#34;1994-06-30&#34;,&#34;1994-07-31&#34;,&#34;1994-08-31&#34;,&#34;1994-09-30&#34;,&#34;1994-10-31&#34;,&#34;1994-11-30&#34;,&#34;1994-12-31&#34;,&#34;1995-01-31&#34;,&#34;1995-02-28&#34;,&#34;1995-03-31&#34;,&#34;1995-04-30&#34;,&#34;1995-05-31&#34;,&#34;1995-06-30&#34;,&#34;1995-07-31&#34;,&#34;1995-08-31&#34;,&#34;1995-09-30&#34;,&#34;1995-10-31&#34;,&#34;1995-11-30&#34;,&#34;1995-12-31&#34;,&#34;1996-01-31&#34;,&#34;1996-02-29&#34;,&#34;1996-03-31&#34;,&#34;1996-04-30&#34;,&#34;1996-05-31&#34;,&#34;1996-06-30&#34;,&#34;1996-07-31&#34;,&#34;1996-08-31&#34;,&#34;1996-09-30&#34;,&#34;1996-10-31&#34;,&#34;1996-11-30&#34;,&#34;1996-12-31&#34;,&#34;1997-01-31&#34;,&#34;1997-02-28&#34;,&#34;1997-03-31&#34;,&#34;1997-04-30&#34;,&#34;1997-05-31&#34;,&#34;1997-06-30&#34;,&#34;1997-07-31&#34;,&#34;1997-08-31&#34;,&#34;1997-09-30&#34;,&#34;1997-10-31&#34;,&#34;1997-11-30&#34;,&#34;1997-12-31&#34;,&#34;1998-01-31&#34;,&#34;1998-02-28&#34;,&#34;1998-03-31&#34;,&#34;1998-04-30&#34;,&#34;1998-05-31&#34;,&#34;1998-06-30&#34;,&#34;1998-07-31&#34;,&#34;1998-08-31&#34;,&#34;1998-09-30&#34;,&#34;1998-10-31&#34;,&#34;1998-11-30&#34;,&#34;1998-12-31&#34;,&#34;1999-01-31&#34;,&#34;1999-02-28&#34;,&#34;1999-03-31&#34;,&#34;1999-04-30&#34;,&#34;1999-05-31&#34;,&#34;1999-06-30&#34;,&#34;1999-07-31&#34;,&#34;1999-08-31&#34;,&#34;1999-09-30&#34;,&#34;1999-10-31&#34;,&#34;1999-11-30&#34;,&#34;1999-12-31&#34;,&#34;2000-01-31&#34;,&#34;2000-02-29&#34;,&#34;2000-03-31&#34;,&#34;2000-04-30&#34;,&#34;2000-05-31&#34;,&#34;2000-06-30&#34;,&#34;2000-07-31&#34;,&#34;2000-08-31&#34;,&#34;2000-09-30&#34;,&#34;2000-10-31&#34;,&#34;2000-11-30&#34;,&#34;2000-12-31&#34;,&#34;2001-01-31&#34;,&#34;2001-02-28&#34;,&#34;2001-03-31&#34;,&#34;2001-04-30&#34;,&#34;2001-05-31&#34;,&#34;2001-06-30&#34;,&#34;2001-07-31&#34;,&#34;2001-08-31&#34;,&#34;2001-09-30&#34;,&#34;2001-10-31&#34;,&#34;2001-11-30&#34;,&#34;2001-12-31&#34;,&#34;2002-01-31&#34;,&#34;2002-02-28&#34;,&#34;2002-03-31&#34;,&#34;2002-04-30&#34;,&#34;2002-05-31&#34;,&#34;2002-06-30&#34;,&#34;2002-07-31&#34;,&#34;2002-08-31&#34;,&#34;2002-09-30&#34;,&#34;2002-10-31&#34;,&#34;2002-11-30&#34;,&#34;2002-12-31&#34;,&#34;2003-01-31&#34;,&#34;2003-02-28&#34;,&#34;2003-03-31&#34;,&#34;2003-04-30&#34;,&#34;2003-05-31&#34;,&#34;2003-06-30&#34;,&#34;2003-07-31&#34;,&#34;2003-08-31&#34;,&#34;2003-09-30&#34;,&#34;2003-10-31&#34;,&#34;2003-11-30&#34;,&#34;2003-12-31&#34;,&#34;2004-01-31&#34;,&#34;2004-02-29&#34;,&#34;2004-03-31&#34;,&#34;2004-04-30&#34;,&#34;2004-05-31&#34;,&#34;2004-06-30&#34;,&#34;2004-07-31&#34;,&#34;2004-08-31&#34;,&#34;2004-09-30&#34;,&#34;2004-10-31&#34;,&#34;2004-11-30&#34;,&#34;2004-12-31&#34;,&#34;2005-01-31&#34;,&#34;2005-02-28&#34;,&#34;2005-03-31&#34;,&#34;2005-04-30&#34;,&#34;2005-05-31&#34;,&#34;2005-06-30&#34;,&#34;2005-07-31&#34;,&#34;2005-08-31&#34;,&#34;2005-09-30&#34;,&#34;2005-10-31&#34;,&#34;2005-11-30&#34;,&#34;2005-12-31&#34;,&#34;2006-01-31&#34;,&#34;2006-02-28&#34;,&#34;2006-03-31&#34;,&#34;2006-04-30&#34;,&#34;2006-05-31&#34;,&#34;2006-06-30&#34;,&#34;2006-07-31&#34;,&#34;2006-08-31&#34;,&#34;2006-09-30&#34;,&#34;2006-10-31&#34;,&#34;2006-11-30&#34;,&#34;2006-12-31&#34;,&#34;2007-01-31&#34;,&#34;2007-02-28&#34;,&#34;2007-03-31&#34;,&#34;2007-04-30&#34;,&#34;2007-05-31&#34;,&#34;2007-06-30&#34;,&#34;2007-07-31&#34;,&#34;2007-08-31&#34;,&#34;2007-09-30&#34;,&#34;2007-10-31&#34;,&#34;2007-11-30&#34;,&#34;2007-12-31&#34;,&#34;2008-01-31&#34;,&#34;2008-02-29&#34;,&#34;2008-03-31&#34;,&#34;2008-04-30&#34;,&#34;2008-05-31&#34;,&#34;2008-06-30&#34;,&#34;2008-07-31&#34;,&#34;2008-08-31&#34;,&#34;2008-09-30&#34;,&#34;2008-10-31&#34;,&#34;2008-11-30&#34;,&#34;2008-12-31&#34;,&#34;2009-01-31&#34;,&#34;2009-02-28&#34;,&#34;2009-03-31&#34;,&#34;2009-04-30&#34;,&#34;2009-05-31&#34;,&#34;2009-06-30&#34;,&#34;2009-07-31&#34;,&#34;2009-08-31&#34;,&#34;2009-09-30&#34;,&#34;2009-10-31&#34;,&#34;2009-11-30&#34;,&#34;2009-12-31&#34;,&#34;2010-01-31&#34;,&#34;2010-02-28&#34;,&#34;2010-03-31&#34;,&#34;2010-04-30&#34;,&#34;2010-05-31&#34;,&#34;2010-06-30&#34;,&#34;2010-07-31&#34;,&#34;2010-08-31&#34;,&#34;2010-09-30&#34;,&#34;2010-10-31&#34;,&#34;2010-11-30&#34;,&#34;2010-12-31&#34;,&#34;2011-01-31&#34;,&#34;2011-02-28&#34;,&#34;2011-03-31&#34;,&#34;2011-04-30&#34;,&#34;2011-05-31&#34;,&#34;2011-06-30&#34;,&#34;2011-07-31&#34;,&#34;2011-08-31&#34;,&#34;2011-09-30&#34;,&#34;2011-10-31&#34;,&#34;2011-11-30&#34;,&#34;2011-12-31&#34;,&#34;2012-01-31&#34;,&#34;2012-02-29&#34;,&#34;2012-03-31&#34;,&#34;2012-04-30&#34;,&#34;2012-05-31&#34;,&#34;2012-06-30&#34;,&#34;2012-07-31&#34;,&#34;2012-08-31&#34;,&#34;2012-09-30&#34;,&#34;2012-10-31&#34;,&#34;2012-11-30&#34;,&#34;2012-12-31&#34;,&#34;2013-01-31&#34;,&#34;2013-02-28&#34;,&#34;2013-03-31&#34;,&#34;2013-04-30&#34;,&#34;2013-05-31&#34;,&#34;2013-06-30&#34;,&#34;2013-07-31&#34;,&#34;2013-08-31&#34;,&#34;2013-09-30&#34;,&#34;2013-10-31&#34;,&#34;2013-11-30&#34;,&#34;2013-12-31&#34;,&#34;2014-01-31&#34;,&#34;2014-02-28&#34;,&#34;2014-03-31&#34;,&#34;2014-04-30&#34;,&#34;2014-05-31&#34;,&#34;2014-06-30&#34;,&#34;2014-07-31&#34;,&#34;2014-08-31&#34;,&#34;2014-09-30&#34;,&#34;2014-10-31&#34;,&#34;2014-11-30&#34;,&#34;2014-12-31&#34;,&#34;2015-01-31&#34;,&#34;2015-02-28&#34;,&#34;2015-03-31&#34;,&#34;2015-04-30&#34;,&#34;2015-05-31&#34;,&#34;2015-06-30&#34;,&#34;2015-07-31&#34;,&#34;2015-08-31&#34;,&#34;2015-09-30&#34;,&#34;2015-10-31&#34;,&#34;2015-11-30&#34;,&#34;2015-12-31&#34;,&#34;2016-01-31&#34;,&#34;2016-02-29&#34;,&#34;2016-03-31&#34;,&#34;2016-04-30&#34;,&#34;2016-05-31&#34;,&#34;2016-06-30&#34;,&#34;2016-07-31&#34;,&#34;2016-08-31&#34;,&#34;2016-09-30&#34;,&#34;2016-10-31&#34;,&#34;2016-11-30&#34;,&#34;2016-12-31&#34;,&#34;2017-01-31&#34;,&#34;2017-02-28&#34;,&#34;2017-03-31&#34;,&#34;2017-04-30&#34;,&#34;2017-05-31&#34;,&#34;2017-06-30&#34;,&#34;2017-07-31&#34;,&#34;2017-08-31&#34;,&#34;2017-09-30&#34;,&#34;2017-10-31&#34;,&#34;2017-11-30&#34;,&#34;2017-12-31&#34;,&#34;2018-01-31&#34;,&#34;2018-02-28&#34;,&#34;2018-03-31&#34;,&#34;2018-04-30&#34;,&#34;2018-05-31&#34;,&#34;2018-06-30&#34;,&#34;2018-07-31&#34;,&#34;2018-08-31&#34;,&#34;2018-09-30&#34;,&#34;2018-10-31&#34;,&#34;2018-11-30&#34;,&#34;2018-12-31&#34;,&#34;2019-01-31&#34;,&#34;2019-02-28&#34;,&#34;2019-03-31&#34;,&#34;2019-04-30&#34;,&#34;2019-05-31&#34;,&#34;2019-06-30&#34;,&#34;2019-07-31&#34;,&#34;2019-08-31&#34;,&#34;2019-09-30&#34;],&#34;z&#34;:[[0.235656331824658,0.12719361125789,0.161546203443221,0.0304390482130936,0.0440128290737087],[0.416750972441865,0.168795189900192,0.152453640019518,0.0469779927089966,0.0104393828074874],[0.502715210710106,0.236251162933698,0.153373120334683,0.033770819843445,-0.030401149082101],[0.560093004360497,0.315955130282715,0.135474135913219,0.00331619536480243,-0.0335757459746789],[0.445501580890665,0.297007271192553,0.147597868297894,0.0124536827325159,0.00387471213061752],[0.433515663967857,0.292403873601807,0.172888642184766,-0.000455927336921125,0.0277961309077646],[0.414680750189819,0.257035205070242,0.194923524240401,-0.030846803386302,0.0913122279704728],[0.285437333389163,0.231085846540227,0.195646624708927,-0.00117080011257586,0.0815771584817113],[0.196963905678594,0.176869191257498,0.250480392793265,-0.00696748748434617,0.116952257012042],[0.206316122912184,0.164401858229985,0.255915652823187,-0.00209236544113756,0.132129148505063],[0.173240840144559,0.137403933873663,0.27084611862598,-0.0132756409134801,0.158457733354018],[0.192197832000845,0.121393688174807,0.291192799721722,-0.0234861521684404,0.169586821215297],[0.178556337576989,0.111213596190166,0.331600536630724,-0.0457818627558735,0.190034974625445],[0.200011899756623,0.104833001340247,0.320491446794146,-0.0486116911581397,0.184263942216673],[0.195251400917186,0.116459391106515,0.315437188637601,-0.047945586120943,0.189233378281525],[0.191952530614014,0.0854067246806089,0.298557393134282,-0.0224544740251954,0.189353188212845],[0.192698666783412,0.09064707096754,0.312498960238484,-0.0332841450482498,0.191021452378257],[0.0935238866937333,0.122519553524729,0.38232894820008,-0.0598284071391612,0.2507033517076],[0.116314809422852,0.012975203797587,0.351441890896562,-0.0305858683034936,0.227075146257368],[0.145383204955348,-0.00769368404727278,0.297172810768038,-0.0155752051975765,0.200554919569283],[0.204147981767266,-0.00298463751559075,0.2243748354899,-0.0139877433232731,0.174302345823063],[0.216173982573999,0.0518785863811539,0.200701694819175,-0.0225403920102994,0.151263457623384],[0.247936102134843,0.0360576911683621,0.204270255433855,-0.00513371332929846,0.146701740109274],[0.307373778299483,0.0932451049461138,0.137411887339277,0.00893226123481994,0.102296433544678],[0.306491014100766,0.126781584452029,0.11828128151939,-0.000410624446992025,0.0781126107690535],[0.344075368621888,0.146884533437943,0.146221482111235,-0.0507962731179592,0.0981855782968859],[0.377173441446655,0.125421832633012,0.147147160675428,-0.0573470234760132,0.118573646746753],[0.34252585288411,0.0567636068466464,0.177923990907149,-0.0606662240975765,0.144058109683463],[0.347973257562028,0.015993090589461,0.211250029744542,-0.0781897093423642,0.191187177023668],[0.340937352238925,0.00479867581857851,0.180283602301764,-0.0753131118981941,0.211623636183806],[0.363698945174488,-0.0434551990962814,0.122246069261056,-0.0522054100652527,0.205826393905415],[0.374287091473872,0.00300864221549735,0.0265709543179899,-0.027429641696892,0.129189274109536],[0.354009843983882,0.00958052451334535,0.013306725072691,-0.00471526492904928,0.0984404624529147],[0.417672353843713,0.0626683513919197,-0.0455355182360554,0.0309918575250425,0.0484722747166004],[0.408570566357946,0.0766604472046852,-0.0318064493521603,0.0307864192750624,0.0566584808769306],[0.39002935028702,0.0272743146978776,-0.0316164025270259,0.0683509152732753,0.0596804824494583],[0.314402377002984,-0.020985530963431,-0.00233727298283182,0.101119753015762,0.0765288717081505],[0.305265770404778,-0.00288086887943817,-0.00811620418896331,0.0909914769432321,0.0550887950998713],[0.37377781355228,-0.0462127535603084,-0.0375712486485237,0.098722826864678,0.0269038317890493],[0.368644215665075,-0.0881580452462788,0.0438375711391912,0.0917702600346066,0.0546054979661184],[0.482721143361634,-0.112487398406493,0.0749247953123675,0.0959931143578587,0.0602411191994521],[0.433715211414997,-0.0938713232568118,0.0698212948004988,0.0963223073237252,0.079280360806264],[0.4625567127525,-0.107299484281944,0.0335134803815706,0.129249927020376,0.0530448895850839],[0.496503289427253,-0.147471007489256,0.0944554606278381,0.109186262341304,0.120244659541414],[0.491953216519579,-0.145924079881878,0.11716021947087,0.124145094784313,0.130712176277564],[0.540740872640734,-0.191043444146704,0.0971618758155439,0.157880655455308,0.101399480135523],[0.630976837983005,-0.134348616976711,0.0438689897555926,0.172761331759985,0.056715509998446],[0.749363695711662,-0.121554453161668,0.0329368196563609,0.175797758231381,0.0425140164856161],[0.825763296856934,-0.130853958136341,0.0246124855212335,0.178273866627175,0.0176228226854103],[0.68360543177435,-0.0703607705168348,0.0539411900929401,0.160399991791368,0.0214453652680864],[0.813073864181017,-0.0718988597529627,0.0667291519545328,0.140103140360734,0.00345752031211677],[0.724902238088593,-0.0619771920960762,0.111577925074181,0.136499495507757,0.0288295196672432],[0.843960238465473,-0.115498012967471,0.134742826699399,0.159934797883648,0.0619744026420159],[0.8532814766617,-0.12872072753232,0.176825100517058,0.152208818019029,0.081229168659235],[0.827691240274222,-0.124987435403811,0.136248922290186,0.154601893400139,0.0696865645440461],[0.887303286902871,-0.12155359660131,0.121118508339388,0.143785411640161,0.0501572859297159],[0.935108817593125,-0.123583972169411,0.153935067989936,0.14113829305818,0.0534209326328559],[0.9102900144695,-0.121916947989936,0.141876992555499,0.125988916141387,0.032236205675334],[0.803028733299559,-0.131034780760477,0.160938352861888,0.138259741162324,0.0555397977875467],[0.809889037748211,-0.188802751954098,0.166913946607316,0.132932295650013,0.0542347825831937],[0.698780019600734,-0.246620609461188,0.174325200929141,0.144310058587335,0.0940803868824052],[0.414607543439043,-0.290243167968015,0.170876375082066,0.214962314879126,0.150848708843285],[0.452992087693615,-0.283403352686716,0.139697096988293,0.189029931507835,0.113228097261483],[0.580398323385506,-0.277350132493539,0.129961969539393,0.178876260125701,0.111671290412851],[0.609138367946255,-0.270808999226358,0.0838364584266291,0.19888971295085,0.0904494744831099],[0.687834967665635,-0.284445516499356,0.0367699777229393,0.212244129221552,0.0115937835210702],[0.702826962009956,-0.279676620628594,-0.00917271509803308,0.188382009571607,-0.0674121673897199],[0.612000553526612,-0.323578948490959,0.0294217605655285,0.165825308091227,-0.0076345512976107],[0.652128703773085,-0.356135756177754,-0.00273490886903516,0.137020932052855,-0.0273199800957551],[0.690196185426843,-0.361046533135117,0.0626527816422324,0.108618040537601,-0.00169952656337924],[0.619702395041897,-0.358815680181268,0.0931126962785895,0.112263720192583,0.0305425955790051],[0.713977716337787,-0.323253636220458,0.0355127043345604,0.091246951738569,-0.0171892917764586],[0.758191791185991,-0.283221939732876,-0.00713124401207743,0.0886661548483718,-0.0330456716695445],[0.685888162207606,-0.311140179292285,-0.024385517722365,0.10349662214449,-0.0114217568421809],[0.564353743343398,-0.277037513216707,-0.0399159937163092,0.0837014894776758,-0.00339362349416816],[0.631059973441547,-0.308438389272701,-0.116069707523365,0.0530774871879585,-0.0400044422104336],[0.577673134581722,-0.247744739467366,-0.208478638930302,0.0229063281991708,-0.0820782621637022],[0.719069882452169,-0.24570353903177,-0.282108532983297,-0.0352470893183078,-0.161594691409598],[0.567584730383172,-0.212201399236759,-0.270810616708794,-0.103333832248695,-0.115233611959491],[0.59921019769292,-0.0563562186936151,-0.403169664294586,-0.23732464638257,-0.195728091791677],[0.796651860548267,-0.181979153154105,-0.369999648526716,-0.159693838293407,-0.218299745422938],[0.645172839389433,-0.155284647540919,-0.323877439520509,-0.13472297471351,-0.148134988712772],[0.487968120396763,-0.209881413796043,-0.261646380980994,-0.108960905222514,-0.0905179370402545],[0.484816859456377,-0.159936337208494,-0.345560160234489,-0.161442647694013,-0.142697627835499],[0.352664007566271,-0.148787344152928,-0.282741812525804,-0.113863140162991,-0.0808413007066509],[0.510448957474189,-0.210437264675086,-0.298194412615014,-0.14678214764108,-0.0753562836885152],[0.3556082440527,-0.22398406145976,-0.231168824049575,-0.0999115840323502,0.0200672474965569],[0.36772069173982,-0.245012397056348,-0.198575357375914,-0.0207123655048754,0.0845104819375362],[0.196438787107622,-0.204457861271901,-0.0788898022838032,0.0839225444460361,0.204451013089104],[0.197618707016012,-0.150330528956728,-0.0110550704137208,0.0921669513093166,0.275044570509885],[0.236664981492182,-0.107691691218474,-0.0763389566949494,0.0129384959981884,0.148131602469016],[0.0427462973557569,-0.0844381921422784,0.0910158843671702,0.119735230787535,0.334276847377688],[-0.0781979507923356,-0.0646108564563991,0.192177523097374,0.174620891116606,0.445088766243454],[-0.0157571296469586,-0.0656389620298383,0.0886131875583314,0.150675913211874,0.359168498552319],[0.0215217275257378,-0.00508475424039256,0.0784599896563007,0.132467215148983,0.344759884825204],[-0.026630477533061,0.0831429934083177,0.106073160223084,0.142551215363916,0.359603015388057],[-0.0207245949923834,0.104381091318285,0.161354300458175,0.205426400379512,0.421195769440871],[0.0965356769743508,0.179299386318344,0.185071698052216,0.199527086837687,0.436464595439161],[-0.0623735408605962,0.120292946613076,0.248193651710127,0.263287706994205,0.557383581353241],[-0.103014239323061,0.221316260930201,0.175574235930518,0.235147945181147,0.45674641084667],[-0.0867393134064126,0.216690524070304,0.216529883661904,0.200948027066875,0.413118934389933],[-0.123631769646343,0.29846100734031,0.298603463454983,0.198206680835976,0.491379439638278],[-0.165771379793959,0.332450055912979,0.403263780271012,0.28113220690749,0.648040945270779],[-0.148971909458007,0.384255179324311,0.446371206242631,0.397503890060391,0.696651997860647],[-0.141395503000695,0.489390299668806,0.496118439869156,0.412290786445199,0.744410642550786],[-0.220063885129441,0.513715052377395,0.556044236512522,0.493161984893271,0.860425969886399],[-0.212254962034088,0.426669487850039,0.576574950149059,0.501170601022019,0.895059630729313],[-0.302824578698618,0.439047178368702,0.67129356120007,0.54558128692538,1.0130856172173],[-0.33882691081384,0.332874091428508,0.59654079824355,0.57764095407812,0.960505022737744],[-0.325687914009573,0.347089609925205,0.653665034533189,0.590205541069284,0.934265742569261],[-0.377174285388762,0.348789325049832,0.738747153300134,0.643645690950813,0.938604872408816],[-0.365853397648029,0.389617855498958,0.679903873658941,0.631359582468384,0.948748508287792],[-0.347046054812814,0.359258247310594,0.807110997316257,0.537612820457131,1.12637200878098],[-0.423796033058605,0.32483999460011,1.06512826988946,0.713190809930958,1.2562302907156],[-0.412900408527014,0.29957056691019,1.05542604790978,0.797365451448357,1.17373281079596],[-0.432135371529818,0.103543467341974,1.39222047766962,1.14307799338573,1.24693318363389],[-0.464028919885347,0.283133477929722,1.14053417319356,0.95571560910595,1.24468039319512],[-0.390849769888612,0.338524347884759,0.99231876105194,0.769299400454565,1.09564645493395],[-0.328513712126047,0.426226904053024,0.904288713171937,0.645360895833609,1.06525998920943],[-0.342440931100859,0.346748412894352,1.12636010088142,0.750073573425975,1.16133379250493],[-0.312842364316652,0.421134760403188,0.926119912009178,0.590147342521044,1.08417277318488],[-0.342478924033391,0.464065467235922,0.990127566577475,0.624730220735638,1.13844592301948],[-0.312673710425014,0.459563778138093,0.816812608882647,0.585091190277961,0.961567214065054],[-0.249468852368124,0.552656684260796,0.753794894045749,0.420663242579728,0.847001972471013],[-0.150809445181372,0.600678606693605,0.524401304265839,0.241381650405121,0.628579239646941],[-0.12554288877199,0.490465946572226,0.396098556989886,0.228681778534667,0.520950608872603],[-0.135367297963511,0.466677314227051,0.544950664442598,0.266077009849014,0.736428548196585],[-0.0272762320323171,0.430859269042255,0.329042228305028,0.172054545338931,0.516285454030384],[0.0371661928200955,0.444825064924655,0.205938280716681,0.142981372307737,0.390919414830308],[-0.0577259398129899,0.416497995531313,0.278826106105841,0.236931563143562,0.467093416369843],[-0.0538013552703623,0.365727948546277,0.261017602912055,0.222636805856705,0.446759181462919],[-0.0151967594021603,0.328950324263422,0.275750882275018,0.219120694455492,0.47746277392739],[-0.0317057782571175,0.339392861964417,0.286139934539788,0.178054857868906,0.389018680010861],[0.0338116749536603,0.296258538199118,0.255573537558038,0.142951776761723,0.277578785912568],[0.164421226738052,0.423210987313067,0.235684976012698,0.0953930050837164,0.187435085801423],[0.155893583733916,0.35759909774428,0.330502387538424,0.112030201394222,0.284070536586888],[0.122527804585852,0.41695585669518,0.356251450980353,0.146327421546198,0.32571606750322],[0.1407452814971,0.341720453589879,0.332619190021156,0.135836809511755,0.319284375690581],[0.128571457474619,0.322943025901922,0.314160787834695,0.117321261901983,0.265537164776865],[0.17970750694391,0.336385404736539,0.272866457232386,0.0630823656931492,0.181011054608512],[0.112496087499762,0.270235356774811,0.279542550476653,0.0840593256927322,0.19446381842],[0.13996222850788,0.153405883087138,0.187772568484328,0.0550687451543186,0.110135567569],[0.193351112970671,0.209112832526642,0.144717255749182,0.0351598209965953,0.0580863447091007],[0.29944965818947,0.220576418173703,0.146395070761516,0.0105060290974381,0.0234741239590555],[0.475139108920238,0.324776689988596,0.169619198293223,-0.0197094114861801,0.0224421879599033],[0.456074780044641,0.327040127549381,0.174121285613933,-0.0343290538432751,0.035277056486632],[0.634925086805798,0.289734811827267,0.178200118864204,-0.0479061497470602,0.0372783042303748],[0.481845629584651,0.317684889016272,0.252686926891501,-0.034547564826561,0.0337480277194804],[0.453717291540783,0.305421951667473,0.257769336575613,0.0379629450343124,-0.0160364346363264],[0.540306673167684,0.297137667591447,0.209166302474551,-0.0106776654006702,0.000973307697599068],[0.634433893223865,0.360707708046822,0.218031336127323,0.00145695218539332,-0.0141823793997248],[0.653552995829983,0.367849088831888,0.22557709380517,-0.0236489345469594,0.0176342758988879],[0.662900662274723,0.406083864201053,0.251198479102953,-0.0337740567072131,0.0160001783061157],[0.555711005231767,0.394251656651594,0.287954159309205,0.0180310749157169,0.00316627909735545],[0.413923574450204,0.307846575090108,0.309464875957375,0.0709240822509309,0.00504839219134667],[0.385230021466583,0.281645760450485,0.316662614132236,0.0790001122421069,0.0129501938838097],[0.346039470687939,0.20074903969079,0.362821628792156,0.139837950774987,0.00753549278801402],[0.341180596501066,0.175599400768869,0.333645198893981,0.145320184062586,0.00802914075116345],[0.373717071095249,0.144604092719545,0.342437585581326,0.130942832735518,0.0209422442355658],[0.337832534251286,0.137585399139505,0.289520191166643,0.15657033519462,-0.00430826568173326],[0.34126016983372,0.110126824568269,0.281973153047524,0.154827987597159,-0.0266800387877657],[0.291598125657902,0.132070134394331,0.288903418765788,0.145325138125712,-0.0173360130318683],[0.280717780980992,0.111371712591781,0.262819983341604,0.187078703524697,-0.0303495149193215],[0.239587449328957,0.130734752342554,0.256060911173852,0.163505178346562,-0.0242628155090754],[0.265678745570651,0.103244715891344,0.256936563636577,0.154672495833234,-0.0279926226724045],[0.343966818474265,0.110336279721683,0.276980305134897,0.12591947435253,-0.0122212830139099],[0.376218836733128,0.112450146386484,0.273805316807858,0.163121978334288,-0.0303384365152497],[0.325237778296718,0.0984762878253973,0.249287299161275,0.165204145973275,-0.0324697737514034],[0.330473149496976,0.0975747890253764,0.165552973984296,0.136287820604877,-0.0478227692065888],[0.33885177888705,0.0953545507548688,0.136833454617444,0.113586910959555,-0.0425600069019322],[0.361804273137171,0.0382707619138725,0.109557634452675,0.114818012067149,-0.0612417628648212],[0.370645418329681,0.0394064996208188,0.0638667053777624,0.111371038361376,-0.0764668766791181],[0.23846714946849,-0.0396051332587163,0.042616722733017,0.128550903819241,-0.0584276674640306],[0.19207857157028,-0.0308383629835175,0.0372892552588777,0.153249638588099,-0.0737911002106129],[0.146398963269919,-0.0341554050268595,0.069077316121344,0.114692498815554,-0.0475671132888651],[0.0967067185802344,-0.0338668347863537,0.0455349135642085,0.115895561755798,-0.0668398282013811],[0.100945414197205,-0.0221205349053366,0.0348304805054689,0.113582025691342,-0.0616771163242104],[0.187098473792538,-0.000742782701518285,0.0384600091974914,0.131587567818878,-0.0773693990856632],[0.17482486893257,0.00502423048645118,0.0161556851116724,0.161441151825378,-0.0819079895328878],[0.072149924977108,-0.0175518366584808,-0.0370861533998864,0.208476994599815,-0.0916739456903903],[0.0147446084134004,-0.0177433470217051,-0.00957711634779113,0.169178889837766,-0.0491362701555037],[0.0321186222547014,0.00719002643103983,-0.015127613286949,0.196491771463212,-0.0282214510627434],[-0.0792544633215342,-0.0026548391774025,0.0124410202877092,0.166632796774291,0.0378926459912741],[-0.229343164366065,-0.0206570922332457,0.00979704012223293,0.213872582420457,0.0768813813870892],[-0.315474526146099,-0.0758558915437424,-0.01152305093601,0.251276866552052,0.116032794970138],[-0.306247273128598,-0.0371231776876773,-0.0293680866212863,0.25002646496661,0.100860817749433],[-0.379919535843031,-0.103415434794105,-0.102431605524669,0.281571294645318,0.0814869144128898],[-0.438149492963744,-0.10980675046977,-0.157159211702211,0.317391205817944,0.0363322123115577],[-0.397035777360105,-0.13280290511433,-0.151434191863609,0.290701543664147,0.0202892729573176],[-0.341483913431637,-0.0803347102759999,-0.137466370535563,0.292101712991593,0.0181309094303606],[-0.272858672908575,-0.0748795469702124,-0.15635827754642,0.260065074268208,-0.0303371793982284],[-0.270518952197975,-0.0539176031704436,-0.187383765798862,0.234253223229426,-0.0267490681508772],[-0.20518461293785,-0.00776487250452607,-0.170488962686628,0.206246293341623,-0.015416428916567],[-0.19825828674099,-0.010331848953768,-0.118472039084559,0.20415787425752,-0.00982329991335051],[-0.172860172662618,0.0441777702383348,-0.113485724330944,0.225251730913683,-0.0329143771090472],[-0.221157385394722,-0.0134969200382707,-0.127072150011696,0.262992990510587,-0.036709922977292],[-0.190306827729504,-0.0323655449404027,-0.131601410458652,0.276585854117973,-0.033198537520344],[-0.171160580834285,0.0252629809057698,-0.147052436296615,0.303582357559303,-0.0556602517255865],[-0.210952733132471,0.0321411845425663,-0.132958390911491,0.283449309988389,-0.0440191215152251],[-0.167103388836322,0.0290938235016966,-0.115678039958058,0.285122814605224,-0.0355548577757483],[-0.122775789213438,0.0474245250511114,-0.106877065037258,0.260993248545182,-0.020069976667634],[-0.139161452307275,0.105508589852709,-0.0783875739473077,0.257263234992001,-0.00901997241291308],[-0.235050016545398,0.109378256883897,-0.102461597439412,0.241177788623636,0.00848921978856465],[-0.264321459022391,0.0829172370417046,-0.130374174572184,0.230950670937171,0.00495491292037586],[-0.18524572892663,0.113270050769876,-0.0944310745931531,0.220346382555001,0.047310906290732],[-0.226602581267794,0.107403014929191,-0.106418698807815,0.246337532690554,0.0136077170217317],[-0.184591973142496,0.164461280027677,-0.10165927776285,0.24883996725072,0.0497479590050935],[-0.17208033707754,0.166312018130433,-0.0780606264542125,0.259835256607204,0.0566069876877766],[-0.117171766244837,0.255609483570858,-0.0679212468036735,0.235212666147095,0.0498245015926055],[-0.051658720844001,0.264096704732172,-0.0311261943109282,0.170048190096305,0.0887934094599552],[0.0331358150660057,0.249668126183209,-0.063812873736634,0.175444442025764,0.0762492166932811],[0.0990739094304516,0.266589160149848,-0.0551549308721156,0.130398987077997,0.0922358262809522],[0.11833832547214,0.294355228825805,-0.076017831742057,0.143259679946415,0.0815044858773271],[0.0977272390687673,0.319408966955074,-0.0976087871417335,0.128751308373491,0.101117835672438],[0.0559274320743501,0.27128813806885,-0.0829161025135795,0.137610339538985,0.102228729372673],[0.125061443099413,0.253659340591667,-0.0565707146018506,0.109099884855266,0.118775017226122],[0.116605771071244,0.213206889652318,-0.0864913518418985,0.166161524461698,0.0572920091448565],[0.0400941170875524,0.151952999724667,-0.112413537131732,0.159877711015495,0.0277101744143315],[0.0561524401215596,0.11401095390376,-0.147428494292897,0.209707923463144,-0.0207538155561487],[0.444103030027715,0.194996276131678,-0.142277004832431,0.169963925977702,-0.0527949782223657],[0.557884638657838,0.243582523133574,-0.116430243780942,0.159597157013343,-0.0662710972225153],[0.539926756616166,0.183910571779305,-0.0739794063313113,0.160525113125787,-0.0255836805023775],[0.752519888313339,0.230444533924196,-0.0368387420892894,0.115750018411518,-0.0122410087744682],[1.02866039446125,0.227831596800887,0.0214235505846665,0.106483358183461,0.0123089999058841],[0.90897651528057,0.209715847989548,0.0216262340950513,0.118881562258044,0.0475548002906001],[0.716834780578181,0.128286095465304,-0.0235030964835055,0.114913506279195,0.062253984344748],[0.501224789390293,0.142739536704489,-0.0192077986973689,0.157546220441809,0.127332568504128],[0.560960806368137,0.129686086556018,0.0137855206323865,0.151494299723633,0.132050381166262],[0.45790708322927,0.0818967808967739,-0.0236328395668965,0.172999089290449,0.114677055100159],[0.454227643881186,0.0872933131239129,-0.0691120422775174,0.183410323810778,0.0742933518962967],[0.430022974851596,0.0628621219718795,-0.0746235162723219,0.143943909666966,0.0955966194976399],[0.446640888895018,0.0972368480064212,-0.0193814017921629,0.0917860660895147,0.132455952119656],[0.376613458138258,0.119640867363367,-0.0233156790166676,0.0945022220903349,0.15210712481584],[0.353498430645496,0.0816473668405155,0.00302864774619538,0.0676060121142743,0.164826091468765],[0.479339936701153,0.0803563614295262,0.0105844191039821,0.0716037271682393,0.168944105736945],[0.440113393205558,0.0573224088020681,-0.0129152478961886,0.0760047842466622,0.179203114543652],[0.405421661892805,0.0479664932783059,-0.0313963380518569,0.0970302903071669,0.194672684322997],[0.396458513538897,-0.019978697670004,-0.0490764441482607,0.0894361328386639,0.190192956475722],[0.553927625278306,-0.00825829142328305,-0.0140301214510221,0.0722762376150063,0.176773299313304],[0.619373466004313,0.0192059464847671,0.0288826633326094,0.0712028880278039,0.183158524209096],[0.600295293333294,0.0357974344780776,0.0197171244134828,0.0571869493210877,0.15627909044328],[0.632281103403058,0.0581702369344557,0.023058747350629,0.0580268197872813,0.166905777664413],[0.548035298760441,0.0433413315168953,0.0295212682202917,0.0617369629285052,0.152658129058022],[0.551015441793958,0.0188176881994795,0.0521090380461506,0.0702662393340601,0.158644169476579],[0.581478794385487,-0.00985097952281477,0.043288962278099,0.0757338921644755,0.157838035972322],[0.519451310078876,-0.0283282864807718,0.0105408878954112,0.108311603895654,0.124640807322442],[0.438993994189232,-0.00112505264974405,-0.0165689968572815,0.0723633732303763,0.0976467618681403],[0.44881695098064,-0.0175113116092227,-0.0247969056485153,0.0923636277453741,0.0936853299456086],[0.451557917033476,-0.0460938505897358,0.0383849872625808,0.0868072442334149,0.109095462596162],[0.415689086317793,-0.076505209940313,0.0796868032181168,0.105826908286145,0.126841882899351],[0.465407765151122,-0.0854539835191694,0.0903063144645331,0.077301245802369,0.123775491966245],[0.535445087260149,-0.0543138570038015,0.0956536279875801,0.0265306710245361,0.0980590347202901],[0.538901881357541,-0.0864178390920175,0.115157176446316,0.0143508111310304,0.120015734455566],[0.702329433124968,-0.0545968611049092,0.12287374182724,0.00435917587560253,0.121142964462063],[0.816476003077452,-0.0534152302678359,0.0950915306450977,-0.0106049836247348,0.108613727581226],[0.661303752187096,-0.0639542222824739,0.0590269547109399,0.00309910263989055,0.104841423063836],[0.706032444731414,-0.0788465023025495,0.0294268224364107,-0.00153255644489902,0.0938104835888018],[0.697020213138594,-0.0554006436589423,0.00598087329194885,-0.0187974107912291,0.0713989461992857],[0.556125782979657,-0.0880780766839334,0.00243538249771991,0.0178867863873573,0.0761868350508768],[0.583423618321421,-0.0709818509225358,-0.0135587999114977,0.00479532123840753,0.0526653862608426],[0.527756381739808,-0.0364832512350493,-0.0305849648569793,0.0121842663830034,0.0324118341818227],[0.554664329284541,-0.050974418648593,0.0038183356383219,-0.00522750448705533,0.0244978758710217],[0.682969959890018,-0.0432579890070085,-0.0190615686974176,-0.0391368813543788,-0.0075707558359116],[0.594554823188643,-0.0226726444134747,-0.0330651821222224,-0.032241663907053,-0.0249023242991862],[0.59518626753007,-0.0497540056981319,-0.0870184553199301,-0.03157034210023,-0.0474068265558438],[0.460287779160701,-0.0539043753377273,-0.0608554020992473,-0.0187415135852265,-0.0280584809755815],[0.372926204823753,-0.0901809042928746,-0.0606689529037142,0.0132147977981161,-0.0384721401079861],[0.500770100688199,-0.105894217322458,-0.0843587203490838,0.0246762721293343,-0.0591481374861739],[0.497787944502033,-0.0860351394080596,-0.0897990864618133,-0.00410905495152758,-0.0742629730402438],[0.442341697790457,-0.131051854480387,-0.135847242777663,0.00570417358054276,-0.0773873584796554],[0.290891026779706,-0.161683963971917,-0.112043723641189,0.0417018527115263,-0.0727828722561955],[0.281940712608293,-0.141222795972038,-0.105382053067326,0.0566664443705907,-0.0598577496648088],[0.322607812641861,-0.135344844669793,-0.0838206645089966,0.0506853135533987,-0.073691508498464],[0.320648780629456,-0.0891635915091824,-0.0498440018273528,0.00851979061354413,-0.0587362505631677],[0.30596488703814,-0.108987783578955,-0.085868873795984,0.0214927485197449,-0.0725099152789151],[0.324663206399673,-0.112695185311636,-0.0915105351362836,0.0271222175747132,-0.0522100623352892],[0.302478951736721,-0.109992114433556,-0.119455681963211,0.0545648109802113,-0.0659805574216004],[0.34203304732655,-0.101293523350928,-0.086110582239658,0.0383455665168322,-0.0466751315134004],[0.297048699371471,-0.107371816517835,-0.0850002579495777,0.0193741968410555,-0.0353743200024649],[0.22053914980724,-0.122511863911856,-0.0638100243845494,0.00372854801114531,-0.0376744706552161],[0.241318831801234,-0.083531726582407,0.00421827295787769,-0.0261812422873728,-0.0129798230949463],[0.230676191777997,-0.0768004473833441,0.0361588021437755,-0.0192211927808703,-0.00386276925204809],[0.301652236385612,-0.0906562402911183,0.0295430116770625,0.0111278162099226,-0.00940750639314081],[0.283504678468089,-0.10891031955822,0.00100204429830897,0.0164894744649628,-0.0182778889196537],[0.27814717533793,-0.0968637076555565,-0.0731002180315402,0.0148904348826759,-0.0507458021823892],[0.285669438015729,-0.0692670995690533,-0.117398899714761,0.00404232023520801,-0.0752857532155109],[0.272432009991445,-0.0769512668236559,-0.151784804615923,0.0267155380982336,-0.0825750620835444],[0.249661392423032,-0.0808066427854418,-0.141731257977406,0.0226237839611161,-0.0692518527171977],[0.301082011286262,-0.0530103890219149,-0.134955000669812,0.00750311870258624,-0.0703689739181772],[0.251194280890028,-0.0709279379251053,-0.146757029463099,0.0145191571336625,-0.0882213292350511],[0.314427369611584,-0.00221159171317864,-0.10293806014629,-0.00814605930684842,-0.0641157781008013],[0.313783231921879,-0.0390400849503172,-0.08631720441357,0.00471203924621411,-0.093250555042833],[0.322265886324818,-0.0175062446355847,-0.0684258583184014,0.0207763257008022,-0.0940654072649614],[0.340549723229911,-0.0392901736763341,-0.0774801344152769,0.0461088545322705,-0.0921793532898015],[0.461370013213338,-0.0550442977642412,-0.0677875819941745,0.0259263607174771,-0.0918121861930534],[0.322323031268404,-0.0618121094185707,-0.0789348322297531,0.0451993940568822,-0.0988545567521113],[0.30934071001,-0.0576932357526032,-0.0713111980562231,0.039868877147192,-0.0921458281001653],[0.299498963994694,-0.0306543042103539,-0.087674966277132,0.0254335180237324,-0.0794861441220276],[0.318927116822733,-0.0064279007807807,-0.102542760674734,0.0261614395962064,-0.0907910253800416],[0.347106452923331,-0.0296806851603626,-0.0989980136285842,0.0408870879516761,-0.0738960090873662],[0.374568494417859,-0.00172112135070224,-0.0461316510213025,0.0415055591863474,-0.046050378761296],[0.506370427230116,0.00345440224747962,-0.130464759066043,0.0471184633975312,-0.088849148536589],[0.559518106038752,0.0113116590546927,-0.144617575611614,0.0367979581403115,-0.0785242341547834],[0.337040585843138,-0.00584147626798848,-0.124013102066176,0.0376263196368782,-0.053211494607542],[0.352613880869882,-0.042330606775917,-0.111500271288274,0.0527811111503163,-0.0360353274063081],[0.254443647383888,-0.0340288287541604,-0.0984394341165215,0.0575467433806518,-0.0444844201541413],[0.445131856432483,0.0266933474729989,-0.146257964848876,0.0221339058723342,-0.0799324664950635],[0.490679598965165,0.0300290647582806,-0.177620609110782,0.00403948188954328,-0.112317838920501],[0.406532825341337,-0.0192905535148742,-0.221086238811634,0.0179775112496399,-0.133263744155052],[0.445201350405111,-0.0534279630697875,-0.241356765608826,0.0660301897036897,-0.165621672412058],[0.328176958583177,-0.0589551127870885,-0.233026015805885,0.0611264508310527,-0.137250758364619],[0.422581367492382,-0.0594232011710984,-0.242167632804993,0.0619723912004249,-0.163829341358765],[0.383567155624086,-0.0874368532573123,-0.226706446951865,0.0494108646411293,-0.150481217982387],[0.34333997157129,-0.128806382576314,-0.257963690293995,0.0724655425098955,-0.153632315218944],[0.359137671057578,-0.13774787435684,-0.204012420531773,0.106058483330912,-0.125581078244624]],&#34;type&#34;:&#34;surface&#34;,&#34;frame&#34;:null}],&#34;highlight&#34;:{&#34;on&#34;:&#34;plotly_click&#34;,&#34;persistent&#34;:false,&#34;dynamic&#34;:false,&#34;selectize&#34;:false,&#34;opacityDim&#34;:0.2,&#34;selected&#34;:{&#34;opacity&#34;:1},&#34;debounce&#34;:0},&#34;shinyEvents&#34;:[&#34;plotly_hover&#34;,&#34;plotly_click&#34;,&#34;plotly_selected&#34;,&#34;plotly_relayout&#34;,&#34;plotly_brushed&#34;,&#34;plotly_brushing&#34;,&#34;plotly_clickannotation&#34;,&#34;plotly_doubleclick&#34;,&#34;plotly_deselect&#34;,&#34;plotly_afterplot&#34;],&#34;base_url&#34;:&#34;https://plot.ly&#34;},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-sharpe1964capital&#34;&gt;
&lt;p&gt;Sharpe, William F. 1964. “Capital Asset Prices: A Theory of Market Equilibrium Under Conditions of Risk.” &lt;em&gt;The Journal of Finance&lt;/em&gt; 19 (3): 425–42.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-sharpe1966mutual&#34;&gt;
&lt;p&gt;———. 1966. “Mutual Fund Performance.” &lt;em&gt;The Journal of Business&lt;/em&gt; 39 (1): 119–38.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Learning the Quantstrat and Blotter packages</title>
      <link>/post/quantstrat-rolling-logistic/quantstrat/</link>
      <pubDate>Sun, 29 Sep 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/quantstrat-rolling-logistic/quantstrat/</guid>
      <description>
&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;Load packages:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(knitr)
library(kableExtra)
library(dplyr)
library(ggplot2)
library(quantstrat)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;::: Note :::&lt;/strong&gt; This post is mostly for my future reference/documentation for learning the &lt;code&gt;quantstrat&lt;/code&gt; package. An example of a strategy I developed can be found below in which it uses a naive rolling logistic regression model trained on &lt;code&gt;t&lt;/code&gt; days to predict &lt;code&gt;t+1&lt;/code&gt; market movement. &lt;strong&gt;::: END Note :::&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;I have been playing around with backtesting trading models using the &lt;code&gt;quantstrat&lt;/code&gt; package for a while but the most difficult thing about it was understanding the syntax of &lt;code&gt;blotter&lt;/code&gt; and &lt;code&gt;quantstrat&lt;/code&gt;, it didn’t seem very intuitive to me at first and there does not seem to be &lt;em&gt;much&lt;/em&gt; detailed information online, despite the package being around since 2010. In this post I will give my comments and observations what certain functions do, I will update this post over time.&lt;/p&gt;
&lt;div id=&#34;backgorund&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Backgorund&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;quantstrat&lt;/code&gt; package is built on the &lt;code&gt;blotter&lt;/code&gt; package which was developed in 2008. It works best with time series &lt;code&gt;xts&lt;/code&gt; objects which can be easily collected using the &lt;code&gt;quantmod&lt;/code&gt; package. The &lt;code&gt;blotter&lt;/code&gt; package is the accounting package behind the &lt;code&gt;quantstrat&lt;/code&gt; system, it can support multiple accounts or multiple portfolios and computes the P&amp;amp;L of trading systems.&lt;/p&gt;
&lt;p&gt;The main blotter functions are the following:&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;initialisation&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Initialisation&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;initPortf&lt;/code&gt; - which initialises a portfolio&lt;/li&gt;
&lt;li&gt;&lt;code&gt;initAcct&lt;/code&gt; - which initialises an account&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;performance&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Performance&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;addTxn&lt;/code&gt; - which adds transactions to the portfolio&lt;/li&gt;
&lt;li&gt;&lt;code&gt;updatePortf&lt;/code&gt; - which computes the P&amp;amp;L for each symbol in a given period&lt;/li&gt;
&lt;li&gt;&lt;code&gt;updateAcct&lt;/code&gt; - which computes the equity from the assets&lt;/li&gt;
&lt;li&gt;&lt;code&gt;updateEndEq&lt;/code&gt; - which updates the final equity for an account&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getEndEq&lt;/code&gt; - which provides us with the latest value of our account&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getPosQty&lt;/code&gt; - which gets a position at a given date.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;chart.Posn&lt;/code&gt;- which plots a chart of the position size, and cumulative P&amp;amp;L&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PortfReturns&lt;/code&gt;- which calcualtes the portfolio returns&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getAccount&lt;/code&gt; - which gets our account info!&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getPortfolio&lt;/code&gt; - &#34;&#34;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getTxns&lt;/code&gt; - &#34;&#34;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tradeStats&lt;/code&gt; - which collects trade statistics&lt;/li&gt;
&lt;li&gt;&lt;code&gt;perTradeStats&lt;/code&gt; - which calculates per trade statistics&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;code&gt;blotter&lt;/code&gt; package loads in a number of additional packages as we can see by running the below.&lt;/p&gt;
&lt;p&gt;The packages are: &lt;code&gt;xts&lt;/code&gt; and &lt;code&gt;zoo&lt;/code&gt; for time series, &lt;code&gt;FinancialInstrument&lt;/code&gt;, &lt;code&gt;quantmod&lt;/code&gt;, &lt;code&gt;TTR&lt;/code&gt;, &lt;code&gt;PerformanceAnalytics&lt;/code&gt; for finance, where &lt;code&gt;TTR&lt;/code&gt; stands for Technical Trading Rules.&lt;/p&gt;
&lt;p&gt;The blotter package creates a new environment &lt;code&gt;.blotter&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;download-financial-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Download Financial Data&lt;/h3&gt;
&lt;p&gt;Lets first download some data for the S&amp;amp;P500 from 2018 to 2019 in order to gather some data. For the &lt;code&gt;quantstrat&lt;/code&gt; package its quite usual to find the initiation date, start date, end date set outside the parameters of the model. Therefore I first set these parameters as &lt;code&gt;initDate&lt;/code&gt;, &lt;code&gt;startDate&lt;/code&gt; and &lt;code&gt;endDate&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;initDate &amp;lt;- &amp;#39;2010-01-01&amp;#39; # this is used for later but is must be before the startDate
startDate &amp;lt;- &amp;#39;2018-01-01&amp;#39;
endDate &amp;lt;- &amp;#39;2019-01-01&amp;#39;
symbols &amp;lt;- c(&amp;#39;SPY&amp;#39;)
getSymbols(symbols, from = startDate, to = endDate, src = &amp;quot;yahoo&amp;quot;, adjust=TRUE) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;SPY&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;font-size: 12px; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption style=&#34;font-size: initial !important;&#34;&gt;
&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 1: &lt;/span&gt;SPY stocks
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SPY.Open
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SPY.High
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SPY.Low
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SPY.Close
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SPY.Volume
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SPY.Adjusted
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-01-02
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
262.8473
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
263.7992
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
262.4155
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
263.7599
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
86655700
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
260.1310
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-01-03
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
263.9464
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
265.5951
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
263.9464
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
265.4283
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
90070400
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
261.7763
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-01-04
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
266.1447
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
267.0868
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
265.4970
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
266.5470
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
80636400
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
262.8796
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-01-05
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
267.4302
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
268.4606
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
266.8807
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
268.3233
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
83524000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
264.6314
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-01-08
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
268.2153
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
268.9906
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
267.8915
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
268.8140
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
57319200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
265.1154
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-01-09
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
269.2850
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
270.1191
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
268.9709
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
269.4224
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
57254000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
265.7154
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;plot-the-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Plot the data&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chartSeries(SPY, name = &amp;quot;Daily time series for SPY&amp;quot;, type = &amp;quot;candlesticks&amp;quot;, theme = chartTheme(&amp;quot;white&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/quantstrat-rolling-logistic/quantstrat_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Once we have the data and after loading the &lt;code&gt;blotter&lt;/code&gt; package we must define a few initialisation parameters, namely the &lt;code&gt;currency()&lt;/code&gt; and &lt;code&gt;stocks&lt;/code&gt; parameter from the &lt;code&gt;FinancialInstrument&lt;/code&gt; package.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;currency(&amp;quot;USD&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;USD&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;stock(&amp;quot;SPY&amp;quot;, currency = &amp;quot;USD&amp;quot;, multiplier = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;SPY&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ls(all = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;.blotter&amp;quot;     &amp;quot;.getSymbols&amp;quot;  &amp;quot;.Random.seed&amp;quot; &amp;quot;.strategy&amp;quot;   
## [5] &amp;quot;endDate&amp;quot;      &amp;quot;initDate&amp;quot;     &amp;quot;SPY&amp;quot;          &amp;quot;startDate&amp;quot;   
## [9] &amp;quot;symbols&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ls(envir = FinancialInstrument:::.instrument)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;SPY&amp;quot; &amp;quot;USD&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can see that we have the SPY index and the USD currency set. We can convert the data from daily time series to monthly time series using the &lt;code&gt;to.period&lt;/code&gt; fucntion.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;SPY_monthly &amp;lt;- to.period(SPY, period = &amp;quot;months&amp;quot;)
chartSeries(SPY_monthly, name = &amp;quot;Monthly time series for SPY&amp;quot;, type = &amp;quot;candlesticks&amp;quot;, theme = chartTheme(&amp;quot;white&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/quantstrat-rolling-logistic/quantstrat_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(SPY_monthly)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##            SPY.Open SPY.High  SPY.Low SPY.Close SPY.Volume SPY.Adjusted
## 2018-01-31 262.8473 281.2870 262.4155  276.6452 1985506700     272.8389
## 2018-02-28 275.8307 277.7836 248.2054  266.5862 2923722000     262.9184
## 2018-03-29 266.3507 275.1830 254.0372  259.2790 2323561800     255.7117
## 2018-04-30 258.6878 267.3091 250.9237  260.6190 1998466500     257.0332
## 2018-05-31 259.9884 270.2157 255.2393  266.9544 1606397200     263.2814
## 2018-06-29 268.4028 275.3688 265.7283  268.4896 1599001000     264.7955&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;portfolio-parameters&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Portfolio parameters&lt;/h3&gt;
&lt;p&gt;Now that we have our data we should initialise the portfolio with &lt;code&gt;initPortf&lt;/code&gt;, which will consist of the transactions over the period of analysis.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;name&lt;/code&gt; - “MyFirstPortfolio” - the initial name of the portfolio&lt;/li&gt;
&lt;li&gt;&lt;code&gt;symbols&lt;/code&gt; - “SPY” - since we are using the SPY500&lt;/li&gt;
&lt;li&gt;&lt;code&gt;initPosQty&lt;/code&gt; - 100 - the initial quantity of our position&lt;/li&gt;
&lt;li&gt;&lt;code&gt;initDate&lt;/code&gt; - “initDate” - the initial account equity and position (prior to the closing price of our first position)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;currency&lt;/code&gt; the currency we are using&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;initDate &amp;lt;- &amp;#39;2010-01-01&amp;#39; # NOTE: We already created this parameter --&amp;gt; which was quoted as &amp;quot;this is used for later but is must be before the startDate&amp;quot;
initPortf(&amp;quot;MyFirstPortfolio&amp;quot;, &amp;quot;SPY&amp;quot;, initDate = initDate)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;MyFirstPortfolio&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;account-parameters&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Account parameters&lt;/h3&gt;
&lt;p&gt;We also need to initialise the account using &lt;code&gt;initAcct&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;name&lt;/code&gt; - “MyFirstPortfolio” - the initial name of the portfolio&lt;/li&gt;
&lt;li&gt;&lt;code&gt;portfolios&lt;/code&gt; - the name of our previous portfolio created&lt;/li&gt;
&lt;li&gt;&lt;code&gt;initDate&lt;/code&gt; - “initDate” - the initial account equity and position (prior to the closing price of our first position)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;initEq&lt;/code&gt; - the initial equity we began with&lt;/li&gt;
&lt;li&gt;&lt;code&gt;currency&lt;/code&gt; the currency we are using&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;initEq = 1000000
initAcct(&amp;quot;MyFirstPortfolio&amp;quot;, portfolios = &amp;quot;MyFirstPortfolio&amp;quot;, initDate = initDate, initEQ = initEq)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;MyFirstPortfolio&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;first(SPY) # print the first observation in our data&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##            SPY.Open SPY.High  SPY.Low SPY.Close SPY.Volume SPY.Adjusted
## 2018-01-02 262.8473 263.7992 262.4155  263.7599   86655700      260.131&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;last(SPY) # print the last observation in our data&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##            SPY.Open SPY.High SPY.Low SPY.Close SPY.Volume SPY.Adjusted
## 2018-12-31   249.56   250.19  247.47    249.92  144299400     246.4814&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;a-simple-strategy&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;A simple Strategy&lt;/h1&gt;
&lt;p&gt;A trading strategy can be broken down into the following blocks:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Assets&lt;/em&gt; - which are the stocks we want to trade, &lt;code&gt;SPY&lt;/code&gt;, &lt;code&gt;MSFT&lt;/code&gt;, &lt;code&gt;AAPL&lt;/code&gt;, &lt;code&gt;MSFT&lt;/code&gt; etc.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Indicators&lt;/em&gt; - which are the variables, Open, High, Low, Close, SMA, EMA, RSI, Momentum etc.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Signals&lt;/em&gt; - we can create signals based on the interaction between the &lt;em&gt;indicators&lt;/em&gt; and the time-series data.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Rules&lt;/em&gt; - Create &lt;em&gt;buy&lt;/em&gt; and &lt;em&gt;sell&lt;/em&gt; rules based on the &lt;em&gt;signals&lt;/em&gt; created.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Orders&lt;/em&gt; - Once a &lt;em&gt;rule&lt;/em&gt; is activated, push an &lt;em&gt;order&lt;/em&gt; through.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Analysis&lt;/em&gt; - Analyse the performance of the strategy.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I wanted to test a basic backtesting concept. What happens if I trained a machine learning model each day on the last 100 days of data to predict the next days stock market direction but test this over many periods?. That is to continuously train a machine learning model at every step to predict the next price. One method is to use the &lt;code&gt;rolling_origin&lt;/code&gt; fucntion from the &lt;code&gt;rsample&lt;/code&gt; package but I write a more simple function for this.&lt;/p&gt;
&lt;p&gt;I load in the parameters of the model and download data for MSFT.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(quantstrat)
library(PerformanceAnalytics)
library(e1071)

initDate = &amp;quot;2010-01-01&amp;quot;
from &amp;lt;- &amp;quot;2018-01-01&amp;quot;
to &amp;lt;- &amp;quot;2019-09-20&amp;quot;

init_equity &amp;lt;- 1000
adjustment &amp;lt;- TRUE

.orderqty &amp;lt;- 10                  # The profitability of the strategy depends heavily on this value
.txnfees &amp;lt;- -10
.stoploss &amp;lt;- 3e-3 # 0.003 or 0.3%

currency(&amp;#39;USD&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;USD&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;Sys.setenv(TZ=&amp;quot;UTC&amp;quot;)

symbols &amp;lt;- c(&amp;#39;MSFT&amp;#39;)

getSymbols(symbols, from = from, to = to, src = &amp;quot;yahoo&amp;quot;, adjust = TRUE) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;MSFT&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I created a simple time series pre-processing function to clean up the data, create some features and set the data to &lt;code&gt;xts&lt;/code&gt;. Ignore the &lt;code&gt;Scale_Me&lt;/code&gt; function.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;Scale_Me &amp;lt;- function(x){
  (x - mean(x, na.rm = TRUE)) / sd(x, na.rm = TRUE)
}


TS_preprocess &amp;lt;- function(dat){
  dat = data.frame(dat)
  colnames(dat) = c(&amp;quot;open&amp;quot;, &amp;quot;high&amp;quot;, &amp;quot;low&amp;quot;, &amp;quot;close&amp;quot;, &amp;quot;volume&amp;quot;, &amp;quot;adjusted&amp;quot;)
  dat$Y = with(dat, ifelse(close &amp;gt;= open, 1, 0))
  dat$X1 = SMA(lag(dat$close), n = 10)
  dat$X2 = RSI(lag(dat$close), nFast = 14, nSlow = 26, nSig = 9, maType = SMA)
  dat$X3 = momentum(lag(dat$close), n = 12)
  dat = dat[complete.cases(dat), ]
  #dat = cbind(dat[, &amp;#39;Y&amp;#39;], apply(dat[, 8:ncol(dat)], 2, Scale_Me))
  #colnames(dat)[1] = &amp;quot;Y&amp;quot; 
  dat = dat[, c(&amp;quot;Y&amp;quot;, &amp;quot;X1&amp;quot;, &amp;quot;X2&amp;quot;, &amp;quot;X3&amp;quot;)]
  dat = as.xts(dat)
  return(dat)
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I next set the training period &lt;code&gt;n_train&lt;/code&gt; = 100 periods and &lt;code&gt;n_test&lt;/code&gt; = 1 period, or train on &lt;code&gt;t&lt;/code&gt; days of data and test of &lt;code&gt;t+1&lt;/code&gt; days of data. This can be quite computationally expensive depending on the machine learning model you input but for a simple binary logistic regression classifier its relatively fast. I create the logistic function which returns the predicted probabilities.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;RollingBacktest&lt;/code&gt; function, runs the model on &lt;code&gt;n_train&lt;/code&gt; periods of data and makes a prediction on &lt;code&gt;n_test&lt;/code&gt;. That is, say we have 1000 days of data, the model will train on the first 100 days and predict on day 101, then retrain on days 2 to 101 days and predict on day 102 and so on, continuing until all 1000 days have passed.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df &amp;lt;- TS_preprocess(MSFT)

n_train &amp;lt;- 100
n_test &amp;lt;- 1

LogistFun &amp;lt;- function(frm, dat, trainIndex, testIndex){
  LogitModel &amp;lt;- glm(frm, data = dat[trainIndex, ])
  pred &amp;lt;- predict(LogitModel, newdata = dat[testIndex, ], type = &amp;#39;response&amp;#39;)
  return(pred)
}

RollingBacktest &amp;lt;- function(dat, ntrain = n_train, ntest = n_test){
  stopifnot(&amp;#39;Y&amp;#39; %in% names(dat))
  frm_ &amp;lt;- formula(reformulate(paste0(&amp;quot;X&amp;quot;, seq(2:ncol(dat))), &amp;quot;Y&amp;quot;))
  
  stride &amp;lt;- ntrain + ntest
  startPosn &amp;lt;- seq(1, dim(dat)[1] - stride)
  
  train_index_list &amp;lt;- lapply(startPosn, function(i) seq(i, i + ntrain))
  test_index_list &amp;lt;- lapply(startPosn, function(i) seq((i + ntrain + 1), (i + ntrain + ntest))) 
  
  mapply(LogistFun, trainIndex = train_index_list, testIndex = test_index_list, MoreArgs = list(frm = frm_, dat = dat), SIMPLIFY = FALSE
  )
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now that I have the &lt;em&gt;pre-process function&lt;/em&gt;, the &lt;em&gt;logistic function&lt;/em&gt; and the &lt;em&gt;backtest function&lt;/em&gt;, we can run the model through the &lt;code&gt;TS_postprocess&lt;/code&gt; function, which applies everything.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;TS_postprocess &amp;lt;- function(dat, ntrain){
  results = tail(dat, -(ntrain + 1))
  results$probs &amp;lt;- RollingBacktest(dat)
  results$predictions &amp;lt;- ifelse(results$probs &amp;gt; 0.6, 1, 0)
  print(paste0(&amp;quot;Model Accuracy at the 0.60 prob cut-off &amp;quot;, mean(results$Y == results$predictions)))
  return(results)
}

out &amp;lt;- TS_postprocess(df, ntrain = n_train)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Model Accuracy at the 0.60 prob cut-off 0.518987341772152&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;out &amp;lt;- na.omit(cbind(MSFT, out))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The model is not very accurate…&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;na.omit&lt;/code&gt; removes the &lt;code&gt;NA&lt;/code&gt; values which were created from the &lt;code&gt;SMA&lt;/code&gt;, &lt;code&gt;RSI&lt;/code&gt; and &lt;code&gt;momentum&lt;/code&gt; calculations which are the first few observations of the time series data.&lt;/p&gt;
&lt;p&gt;The data looks like:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;out %&amp;gt;%
  head() %&amp;gt;%
  kable() %&amp;gt;%
  kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.Open
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.High
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.Low
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.Close
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.Volume
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.Adjusted
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Y
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
X1
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
X2
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
X3
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
probs
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
predictions
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.73225
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.05627
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.58513
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.91896
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28653100
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.91896
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.33186
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
63.01370
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.98113024
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6709360
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.41915
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.54701
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.17396
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.90953
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26180800
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.90952
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.20142
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.54048
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.06865286
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7426882
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.11548
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.48817
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.93857
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.19357
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23198200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.19357
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.14061
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
63.88638
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.19615593
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7523711
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.47763
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.83069
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.71263
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.47763
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38923100
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.47763
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.16611
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.80598
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1.02979581
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7586200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.07551
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.18340
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.42748
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.49649
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35433300
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.49649
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.04646
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43.39626
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2.03996476
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7851164
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.91822
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.15397
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.84957
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.17322
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26897200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.17323
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.78558
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32.78984
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2.44207828
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6282847
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We can see that the model outputs predicted probabilities, I simply set the &lt;code&gt;predictions&lt;/code&gt; column to give a &lt;code&gt;1&lt;/code&gt; if the models predicted probability is &lt;code&gt;&amp;gt; 0.5&lt;/code&gt; or a &lt;code&gt;0&lt;/code&gt; if it is &lt;code&gt;&amp;lt; 0.5&lt;/code&gt;. The &lt;code&gt;Y&lt;/code&gt; variable is the observed and the &lt;code&gt;X1&lt;/code&gt;, &lt;code&gt;X2&lt;/code&gt; and &lt;code&gt;X3&lt;/code&gt; variables are the &lt;code&gt;SMA&lt;/code&gt;, &lt;code&gt;RSI&lt;/code&gt; and &lt;code&gt;momentum&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We can now use the &lt;code&gt;quantstrat&lt;/code&gt; package to backtest the model and see how the performance went.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;MSFT &amp;lt;- out

stock(&amp;quot;MSFT&amp;quot;, currency = &amp;quot;USD&amp;quot;, multiplier = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;MSFT&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;strategy.st &amp;lt;- portfolio.st &amp;lt;- account.st &amp;lt;- &amp;quot;RollingLogitStrategy&amp;quot;

rm.strat(strategy.st)
rm.strat(portfolio.st)
rm.strat(account.st)


initPortf(name = portfolio.st,
          symbols = symbols,
          initDate = initDate,
          currency = &amp;#39;USD&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;RollingLogitStrategy&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;initAcct(name = account.st,
         portfolios = portfolio.st,
         initDate = initDate,
         currency = &amp;#39;USD&amp;#39;,
         initEq = init_equity)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;RollingLogitStrategy&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;initOrders(portfolio.st,
           symbols = symbols,
           initDate = initDate)

strategy(strategy.st, store = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I add the signals to the strategy and give it some rules.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1a)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The signal is that the first time the Logistic model produces a probability greater than &lt;code&gt;0.6&lt;/code&gt; then assign the signal. The &lt;code&gt;sigThreshold&lt;/code&gt; is a &lt;code&gt;quantstrat&lt;/code&gt; function, the others are &lt;code&gt;sigComparison&lt;/code&gt;, &lt;code&gt;sigCrossover&lt;/code&gt; and &lt;code&gt;sigFormula&lt;/code&gt;. It calls upon the &lt;code&gt;threshold&lt;/code&gt; value in the &lt;code&gt;list&lt;/code&gt; of &lt;code&gt;arguments&lt;/code&gt;, the column it looks for is the &lt;code&gt;probs&lt;/code&gt; column which the predicted probabilities are output to, &lt;code&gt;gt&lt;/code&gt; means greater than. It basically creates a new column called &lt;code&gt;logSig&lt;/code&gt; and it would be similar to &lt;code&gt;ifelse(df$probs &amp;gt; 0.6, 1, 0)&lt;/code&gt; as far as I understand.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1b)
The rule for the strategy is to take &lt;code&gt;sigcol&lt;/code&gt; which is the &lt;code&gt;label&lt;/code&gt; we gave our signal in the previous lines which is called &lt;code&gt;longSig&lt;/code&gt;. If &lt;code&gt;longSig = 1&lt;/code&gt;, execute a market order going long, buying at the next days open price, the transaction fees were set at the start of the strategy. We call this &lt;code&gt;rule&lt;/code&gt;, &lt;code&gt;EnterLONG&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;nMult_orderqty &amp;lt;- 2
addPosLimit(portfolio.st, symbol = &amp;quot;MSFT&amp;quot;, timestamp = initDate, maxpos = nMult_orderqty * .orderqty)

# Objective: Buy when the probability is gt 0.60, using cross = TRUE

# 1.a)
add.signal(strategy = strategy.st,
           name = &amp;quot;sigThreshold&amp;quot;,
           arguments = list(threshold = 0.6,
                            column = &amp;quot;probs&amp;quot;,
                            relationship = &amp;quot;gt&amp;quot;,
                            cross = TRUE),
           label = &amp;quot;longSig&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;RollingLogitStrategy&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 1.b)
# # Adding the rules, enter at the open price when prob &amp;gt; 0.60 for the first time, taking transaction fees into account
add.rule(strategy = strategy.st,
         name = &amp;quot;ruleSignal&amp;quot;,
         arguments = list(sigcol = &amp;quot;longSig&amp;quot;,   # check the ifelse predictions statement
                          sigval = 1,
                          orderqty = .orderqty,
                          ordertype = &amp;quot;market&amp;quot;,
                          orderside = &amp;quot;long&amp;quot;,
                          osFUN = osMaxPos,
                          prefer = &amp;quot;Open&amp;quot;,
                          replace = TRUE,
                          TxnFees = .txnfees),
         type = &amp;quot;enter&amp;quot;,
         label = &amp;quot;EnterLONG&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;RollingLogitStrategy&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;From the Logistic model we have added our signal to buy when the probability of the next days price is greater than &lt;code&gt;0.60&lt;/code&gt;. So far we just keep buying when the probability of the logistic model passes over &lt;code&gt;0.60&lt;/code&gt; but we have no position to sell when the model predicts something different.&lt;/p&gt;
&lt;p&gt;I thought it might be interesting to exit the strategy when the model is undecided or makes a very low predicted probability. I set this threshold to be less than 0.4 based on the probability density plot below. So we are making trades at the tail ends of the distribution, buying when the model is &lt;em&gt;confident&lt;/em&gt; and selling when it is &lt;em&gt;unsure&lt;/em&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(density(out$probs))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/quantstrat-rolling-logistic/quantstrat_files/figure-html/unnamed-chunk-16-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Add the signals and rules for exiting the strategy. Using a similar principle as before, I create a &lt;code&gt;signal&lt;/code&gt; when the probability is less than 0.4 and call it &lt;code&gt;exitlongSig&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Careful here when setting &lt;code&gt;type = &#34;exit&#34;&lt;/code&gt; and &lt;code&gt;orderside = &#34;long&#34;&lt;/code&gt;. Previously had it set to &lt;code&gt;type = exit&lt;/code&gt; and &lt;code&gt;orderside = short&lt;/code&gt;! which is completely wrong.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 2.a) # create the signal of when we should be looking to exit
# #exit when prob drops below 0.4 for the first time
add.signal(strategy = strategy.st,
           name = &amp;quot;sigThreshold&amp;quot;,
           arguments = list(threshold = 0.4,
                            column = &amp;quot;probs&amp;quot;,
                            relationship = &amp;quot;lt&amp;quot;,
                            cross = TRUE),
           label = &amp;quot;exitlongSig&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;RollingLogitStrategy&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# 2.b) # Add that signal to the rule of exiting
add.rule(strategy.st,
         name = &amp;quot;ruleSignal&amp;quot;,
         arguments = list(sigcol = &amp;quot;exitlongSig&amp;quot;,
                          sigval = 1,
                          orderqty = &amp;quot;all&amp;quot;,
                          ordertype = &amp;quot;market&amp;quot;,
                          orderside = &amp;quot;long&amp;quot;,
                          osFUN = osMaxPos,
                          prefer = &amp;quot;Open&amp;quot;,
                          replace = TRUE,
                          TxnFees = .txnfees),
         type = &amp;quot;exit&amp;quot;,
         label = &amp;quot;ExitLong&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;RollingLogitStrategy&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can finally apply the strategy and see how it performs. It doesn’t make many transactions due to the backtesting being quite restrictive.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;applyStrategy(strategy.st, portfolios = portfolio.st)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;2018-07-05 00:00:00 MSFT 10 @ 97.5851340312762&amp;quot;
## [1] &amp;quot;2018-07-11 00:00:00 MSFT 10 @ 99.2033819340086&amp;quot;
## [1] &amp;quot;2018-12-06 00:00:00 MSFT -20 @ 104.632969498356&amp;quot;
## [1] &amp;quot;2018-12-19 00:00:00 MSFT 10 @ 102.487313341245&amp;quot;
## [1] &amp;quot;2019-01-09 00:00:00 MSFT 10 @ 102.694956688076&amp;quot;
## [1] &amp;quot;2019-02-21 00:00:00 MSFT -20 @ 106.15227613615&amp;quot;
## [1] &amp;quot;2019-04-11 00:00:00 MSFT 10 @ 119.69686840234&amp;quot;
## [1] &amp;quot;2019-04-24 00:00:00 MSFT 10 @ 124.91014659961&amp;quot;
## [1] &amp;quot;2019-06-13 00:00:00 MSFT -20 @ 131.541967172209&amp;quot;
## [1] &amp;quot;2019-06-27 00:00:00 MSFT 10 @ 133.694801331394&amp;quot;
## [1] &amp;quot;2019-07-09 00:00:00 MSFT 10 @ 135.548629168169&amp;quot;
## [1] &amp;quot;2019-08-23 00:00:00 MSFT -20 @ 137.190002&amp;quot;
## [1] &amp;quot;2019-08-28 00:00:00 MSFT 10 @ 134.880005&amp;quot;
## [1] &amp;quot;2019-09-05 00:00:00 MSFT -10 @ 139.110001&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;updatePortf(portfolio.st)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;RollingLogitStrategy&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;updateAcct(account.st)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;RollingLogitStrategy&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;updateEndEq(account.st)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;RollingLogitStrategy&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chart.Posn(portfolio.st, Symbol = &amp;quot;MSFT&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/quantstrat-rolling-logistic/quantstrat_files/figure-html/unnamed-chunk-18-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;           #TA=&amp;quot;add_SMA(n = 10, col = 2); add_SMA(n = 30, col = 4)&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Look at the &lt;code&gt;mktdata&lt;/code&gt; which is where our &lt;code&gt;signals&lt;/code&gt; and &lt;code&gt;predictions&lt;/code&gt; are stored.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mktdata %&amp;gt;%
  data.frame() %&amp;gt;%
  head(10) %&amp;gt;%
  kable() %&amp;gt;%
  kable_styling(bootstrap_options = c(&amp;quot;striped&amp;quot;, &amp;quot;hover&amp;quot;, &amp;quot;condensed&amp;quot;, &amp;quot;responsive&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.Open
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.High
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.Low
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.Close
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.Volume
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
MSFT.Adjusted
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Y
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
X1
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
X2
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
X3
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
probs
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
predictions
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
longSig
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
exitlongSig
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-06-19
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.73225
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.05627
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.58513
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.91896
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28653100
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.91896
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.33186
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
63.01370
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.9811302
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6709360
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-06-20
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.41915
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.54701
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.17396
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.90953
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26180800
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.90952
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.20142
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.54048
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0686529
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7426882
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-06-21
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.11548
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100.48817
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.93857
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.19357
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23198200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.19357
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.14061
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
63.88638
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1961559
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7523711
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-06-22
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.47763
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.83069
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.71263
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.47763
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38923100
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.47763
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.16611
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.80598
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1.0297958
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7586200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-06-25
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.07551
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.18340
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.42748
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.49649
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35433300
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.49649
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99.04646
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43.39626
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2.0399648
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7851164
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-06-26
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.91822
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.15397
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.84957
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.17322
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26897200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.17323
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.78558
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32.78984
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2.4420783
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6282847
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-06-27
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.66360
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.09512
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.52555
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.66285
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31298400
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.66285
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.56687
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35.08314
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2.5009206
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7361390
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-06-28
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.50593
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.20264
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95.38824
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.73187
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26650700
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.73187
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.24224
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35.29932
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3.4424524
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6387378
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-06-29
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.02610
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.98725
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.43765
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.71226
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28053200
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.71226
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.96861
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37.17949
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2.6284247
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6327528
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
2018-07-02
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.21207
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.13435
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96.11400
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.08532
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19564500
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.08531
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
97.81954
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.04847
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2.1968885
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5659825
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;So if we trained a simple logistic model on 100 days of data to give us the next days prediction everyday since June 2018 and only invest if the logistic models prediction is greater than 0.60 and only sell if the logistic models prediction is less than 0.40 then out cumulative P&amp;amp;L would be $334 with a max drawdown of $61.&lt;/p&gt;
&lt;p&gt;I have probably (almost certainly) gone wrong at somepoint using the &lt;code&gt;quantstrat&lt;/code&gt; package so the results will probably not generalise well to other assets, especially using a logistic model with 3 regressors! But it was a fun exercise using the &lt;code&gt;quantstrat&lt;/code&gt; package.&lt;/p&gt;
&lt;p&gt;I will revist and modify this markdown file.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Need for Funds (NFO) and Working Capital (WC) Calculations</title>
      <link>/post/nfo-wc-calculations/nfo-wc-calculations-plots/</link>
      <pubDate>Wed, 25 Sep 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/nfo-wc-calculations/nfo-wc-calculations-plots/</guid>
      <description>
&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;


&lt;div id=&#34;corporate-finance-and-managerial-finance&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Corporate Finance and Managerial Finance&lt;/h4&gt;
&lt;p&gt;I created a script to download any company from Yahoo Finance and compute the &lt;em&gt;DuPont&lt;/em&gt;, &lt;em&gt;Need for Funds&lt;/em&gt; and &lt;em&gt;Working Capital&lt;/em&gt; based on companies fundamentals and plot these for each company. I suggest you first watch these two short videos from IESE Business School - part 1 &lt;a href=&#34;https://www.coursera.org/lecture/operational-finance/4-need-of-funds-nfo-and-working-capital-wc-cRBRP&#34;&gt;here&lt;/a&gt; and part 2 &lt;a href=&#34;https://www.coursera.org/lecture/operational-finance/5-need-of-funds-nfo-and-working-capital-wc-continued-hxJP6&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Firstly load in some packages:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(knitr)
library(kableExtra)
library(tidyquant)
library(quantmod)
library(tibble)
library(tidyr)
library(reshape2)
library(ggplot2)
library(rvest)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I first define the function to scrape Yahoo Finance and collect the Balance Sheet, Income Statement and Cash Flows (it looks complicated but it works):&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;getFin &amp;lt;- function(stock){
  for (i in 1:length(stock)) {
    tryCatch(
      {
        # Collect the Income Statement data
        link &amp;lt;- &amp;quot;https://finance.yahoo.com/quote/&amp;quot;
        link &amp;lt;- paste0(link, stock[i], &amp;quot;/financials?p=&amp;quot;, stock[i])
        wahis.session &amp;lt;- html_session(link)
        p &amp;lt;- wahis.session %&amp;gt;%
          html_nodes(xpath = &amp;#39;//*[@id=&amp;quot;Col1-1-Financials-Proxy&amp;quot;]/section/div[3]/table&amp;#39;)%&amp;gt;%
          html_table(fill = TRUE)
        IncomeStatement &amp;lt;- p[[1]]
        colnames(IncomeStatement) &amp;lt;- paste(IncomeStatement[1,])
        IncomeStatement &amp;lt;- IncomeStatement[-c(1,5,12,20,25),]
        names_row &amp;lt;- paste(IncomeStatement[,1])
        IncomeStatement &amp;lt;- IncomeStatement[,-1]
        IncomeStatement &amp;lt;- apply(IncomeStatement, 2, function(x){gsub(&amp;quot;,&amp;quot;,&amp;quot;&amp;quot;,x)})
        IncomeStatement &amp;lt;- as.data.frame(apply(IncomeStatement, 2, as.numeric))
        rownames(IncomeStatement) &amp;lt;- paste(names_row)
        temp1 &amp;lt;- IncomeStatement
        
        # Collect the Balance Sheet data
        link &amp;lt;- &amp;quot;https://finance.yahoo.com/quote/&amp;quot;
        link &amp;lt;- paste0(link, stock[i],&amp;quot;/balance-sheet?p=&amp;quot;, stock[i])
        wahis.session &amp;lt;- html_session(link)
        p &amp;lt;- wahis.session %&amp;gt;%
          html_nodes(xpath = &amp;#39;//*[@id=&amp;quot;Col1-1-Financials-Proxy&amp;quot;]/section/div[3]/table&amp;#39;)%&amp;gt;%
          html_table(fill = TRUE)
        BalanceSheet &amp;lt;- p[[1]]
        colnames(BalanceSheet) &amp;lt;- BalanceSheet[1,]
        BalanceSheet &amp;lt;- BalanceSheet[-c(1,2,17,28),]
        names_row &amp;lt;- BalanceSheet[,1]
        BalanceSheet &amp;lt;- BalanceSheet[,-1]
        BalanceSheet &amp;lt;- apply(BalanceSheet, 2, function(x){gsub(&amp;quot;,&amp;quot;,&amp;quot;&amp;quot;,x)})
        BalanceSheet &amp;lt;- as.data.frame(apply(BalanceSheet, 2, as.numeric))
        rownames(BalanceSheet) &amp;lt;- paste(names_row)
        temp2 &amp;lt;- BalanceSheet
        
        # Collect the Cash Flow data
        link &amp;lt;- &amp;quot;https://finance.yahoo.com/quote/&amp;quot;
        link &amp;lt;- paste0(link, stock[i], &amp;quot;/cash-flow?p=&amp;quot;, stock[i])
        wahis.session &amp;lt;- html_session(link)
        p &amp;lt;- wahis.session %&amp;gt;%
          html_nodes(xpath = &amp;#39;//*[@id=&amp;quot;Col1-1-Financials-Proxy&amp;quot;]/section/div[3]/table&amp;#39;)%&amp;gt;%
          html_table(fill = TRUE)
        CashFlow &amp;lt;- p[[1]]
        colnames(CashFlow) &amp;lt;- CashFlow[1,]
        CashFlow &amp;lt;- CashFlow[-c(1,3,11,16),]
        names_row &amp;lt;- CashFlow[,1]
        CashFlow &amp;lt;- CashFlow[,-1]
        CashFlow &amp;lt;- apply(CashFlow, 2, function(x){gsub(&amp;quot;,&amp;quot;,&amp;quot;&amp;quot;,x)})
        CashFlow &amp;lt;- as.data.frame(apply(CashFlow, 2, as.numeric))
        rownames(CashFlow) &amp;lt;- paste(names_row)
        temp3 &amp;lt;- CashFlow
        
        assign(paste0(stock[i],&amp;#39;.f&amp;#39;),value = list(IncomeStatement = temp1, BalanceSheet = temp2, CashFlow = temp3), envir = parent.frame())
        },
      error = function(cond){
        message(stock[i], &amp;quot;Give error &amp;quot;,cond)
        }
      )
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Next I collect some tickers, I choose &lt;code&gt;Ford&lt;/code&gt;, &lt;code&gt;General Electric&lt;/code&gt;, &lt;code&gt;International Business Machine&lt;/code&gt; and &lt;code&gt;Unilever&lt;/code&gt; but feel free to add in more tickers - what ever financial data can be found on Yahoo Finance will work- just add to the &lt;code&gt;symbols&lt;/code&gt; part of the code.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;symbols &amp;lt;- c(&amp;quot;F&amp;quot;, &amp;quot;GE&amp;quot;, &amp;quot;IBM&amp;quot;, &amp;quot;UN&amp;quot;)
getFin(symbols)
symbols.f &amp;lt;- sapply(symbols, function(x) { paste0(x, &amp;quot;.f&amp;quot;) })

tickers &amp;lt;- list2env(mget(symbols.f))

IS &amp;lt;- lapply(tickers, &amp;quot;[[&amp;quot;, &amp;quot;IncomeStatement&amp;quot;)
BS &amp;lt;- lapply(tickers, &amp;quot;[[&amp;quot;, &amp;quot;BalanceSheet&amp;quot;)
CF &amp;lt;- lapply(tickers, &amp;quot;[[&amp;quot;, &amp;quot;CashFlow&amp;quot;)

IS &amp;lt;- as.data.frame(IS)
BS &amp;lt;- as.data.frame(BS)
CF &amp;lt;- as.data.frame(CF)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Where &lt;code&gt;IS&lt;/code&gt; is Income Statement, &lt;code&gt;BS&lt;/code&gt; is Balance Sheet&lt;code&gt;and&lt;/code&gt;CF` is Cash Flow.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;how-the-income-statement-looks&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;How the Income Statement looks:&lt;/h4&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;font-size: 12px; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption style=&#34;font-size: initial !important;&#34;&gt;
&lt;span id=&#34;tab:unnamed-chunk-4&#34;&gt;Table 1: &lt;/span&gt;Income Statement
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2015
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2015
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2015
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2015
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total Revenue
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50982000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53715000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
52713000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53272000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79591000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79139000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79919000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
81741000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
121615000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
118243000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
119468000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115834000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
160338000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
156776000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
151800000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
149558000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Cost of Revenue
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28769000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30547000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30229000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30808000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42655000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42196000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41402000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41057000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98396000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106858000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
94886000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
90111000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
145459000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
140218000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134933000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
131410000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Gross Profit
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22213000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23168000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22464000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36936000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36943000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38517000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40684000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23219000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11385000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24582000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
25723000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14879000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16558000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16867000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18148000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Research Development
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
900000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
900000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
978000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1005000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5379000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5590000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5726000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5247000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Selling General and Administrative
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8803000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13507000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13799000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14065000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20325000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20900000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20225000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19589000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15389000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14707000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16327000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10460000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9676000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12504000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10097000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Non Recurring
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Others
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41427000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44031000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44031000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44031000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-998000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1445000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1604000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-669000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total Operating Expenses
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38472000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44954000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45006000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45878000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67361000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67241000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65749000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65224000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
113530000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
122247000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
109593000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106438000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
155919000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
149894000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
147437000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
141507000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Operating Income or Loss
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12510000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8761000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7707000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7394000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12230000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14170000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16517000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8085000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4004000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9875000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9396000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4419000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6882000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4363000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8051000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total Other Income/Expenses Net
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-127000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-608000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-238000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-174000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-888000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-498000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1840000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-572000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-28220000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7147000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2843000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1211000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-74000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1277000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2421000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2201000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Earnings Before Interest and Taxes
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12510000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8761000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7707000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7394000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12230000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14170000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16517000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8085000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4004000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9875000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9396000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4419000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6882000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4363000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8051000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Interest Expense
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-627000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-608000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-572000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-552000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-723000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-615000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-630000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-468000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2708000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2753000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2026000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1706000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1228000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1190000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-951000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-773000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Income Before Tax
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12383000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8153000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7469000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7220000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11342000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11400000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12330000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15945000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-20135000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-11151000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7032000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8185000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4345000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8159000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6784000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10252000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Income Tax Expense
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2575000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1667000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1922000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1961000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2619000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5642000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
449000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2581000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
583000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2611000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1133000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6485000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
650000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
402000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2184000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2881000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Minority Interest
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
720000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
758000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
626000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
643000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
131000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
146000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
162000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20882000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20859000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4688000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4836000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
113000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
109000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Net Income From Continuing Ops
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9808000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6486000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5547000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5259000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8723000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5758000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11881000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13364000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-20718000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8540000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8165000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1700000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3695000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7757000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4600000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7371000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Discontinued Operations
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-174000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1726000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-309000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-954000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7807000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Extraordinary Items
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Effect Of Accounting Changes
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Other Items
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Net Income
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9389000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6053000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5184000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4909000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8728000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5753000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11872000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13190000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22355000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7500000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3677000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7731000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4589000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7373000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Preferred Stock And Other Adjustments
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Net Income Applicable To Common Shares
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9389000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6053000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5184000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4909000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8728000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5753000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11872000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13190000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22809000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8944000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6829000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6135000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3677000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7731000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4589000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7373000
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;how-the-balance-sheet-looks&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;How the Balance Sheet looks:&lt;/h4&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;font-size: 12px; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption style=&#34;font-size: initial !important;&#34;&gt;
&lt;span id=&#34;tab:unnamed-chunk-5&#34;&gt;Table 2: &lt;/span&gt;Balance Sheet
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2015
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2015
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2015
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2015
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Cash And Cash Equivalents
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3230000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3317000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3382000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2302000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11379000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11972000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7826000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7686000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16369000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18211000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10525000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10372000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7111000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8934000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7828000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5386000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Short Term Investments
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
681000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
521000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
565000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
596000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
618000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
608000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
701000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
508000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15925000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17554000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19642000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18181000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Net Receivables
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4822000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4204000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3854000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3416000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8596000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10380000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10239000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9534000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19874000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24209000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24076000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43013000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3698000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10599000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11102000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11042000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Inventory
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4301000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3962000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4278000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4335000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1682000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1583000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1553000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1551000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19271000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19419000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22354000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22515000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11220000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11176000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8319000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Other Current Assets
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1387000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4356000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1120000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1352000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2902000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2266000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
532000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
293000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7441000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6720000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3885000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5109000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2567000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3649000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3145000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2704000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total Current Assets
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15481000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16983000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13884000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12686000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49146000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49735000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43889000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42504000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95974000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
116253000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
131436000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
280896000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
114649000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
116801000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
108461000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
102587000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Long Term Investments
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
637000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
565000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
491000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
592000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
439000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
581000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
659000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1131000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34920000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38696000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44313000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31973000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2595000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3448000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3523000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3244000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Property, plant and equipment
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10347000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10411000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11673000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11058000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10792000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11116000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10830000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10727000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50749000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53874000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50518000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
54095000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37883000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36901000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33692000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32177000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Goodwill
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17341000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16881000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17624000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16213000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36265000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36788000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36199000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32021000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
58710000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
83968000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68070000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65526000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
264000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Intangible Assets
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12152000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11520000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9809000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8846000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3087000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3742000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4688000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3487000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18159000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20273000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16436000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17797000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
178000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
213000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
198000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
124000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Accumulated Amortization
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Other Assets
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3498000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3925000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2948000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2903000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14505000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13844000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12184000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10612000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49713000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56181000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
52042000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42784000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16755000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18215000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14894000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16154000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Deferred Long Term Asset Charges
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1117000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1085000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1354000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1185000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5216000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4862000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5224000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4822000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12432000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8819000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1833000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3105000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10412000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10762000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9705000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11509000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total Assets
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59456000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
60285000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56429000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
52298000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
123382000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
125356000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
117470000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
110495000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
309129000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
369245000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
365183000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
493071000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
256540000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
258496000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
237951000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
224925000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Accounts Payable
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9121000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8217000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8591000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8296000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6558000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6451000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6209000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6028000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17153000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15172000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14435000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13680000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20426000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23282000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21296000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20272000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Short/Current Long Term Debt
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2012000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1537000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2173000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1495000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7055000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5215000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6239000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5271000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1700000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1960000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1361000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
961000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Other Current Liabilities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3194000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2787000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2392000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2759000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14680000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16451000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14693000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14281000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19710000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19531000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20772000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27453000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18868000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16402000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16277000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16084000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total Current Liabilities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19772000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23177000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20556000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20019000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38227000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37363000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36275000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34269000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49937000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
60043000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70364000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
138270000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95569000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
94600000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
90281000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
82336000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Long Term Debt
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21535000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16342000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11011000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9696000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35681000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39871000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34663000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33431000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95234000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
108575000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105080000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
144659000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11833000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13174000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13222000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11060000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Other Liabilities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5742000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6259000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7748000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6343000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32544000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30397000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28140000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28371000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74883000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
84243000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
83040000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79175000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23088000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
25526000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
25086000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23959000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Deferred Long Term Liability Charges
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2676000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2136000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1496000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1626000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5739000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5534000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
232000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Minority Interest
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
720000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
758000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
626000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
643000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
131000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
146000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
162000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20882000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20859000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4688000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4836000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
113000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
109000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Negative Goodwill
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total Liabilities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47164000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39449000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36216000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106452000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
107631000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99078000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96071000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
257266000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
292356000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
284667000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
389961000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
220474000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
222792000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
208668000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
196174000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Misc. Stocks Options Warrants
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Redeemable Preferred Stock
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Preferred Stock
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Common Stock
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
464000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55151000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
54566000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53935000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53262000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
702000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
702000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
702000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
702000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Retained Earnings
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26265000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26648000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23179000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22619000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
159206000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
153126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
152759000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
146124000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
93109000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
117245000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
139532000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
140020000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22668000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21906000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15634000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14414000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Treasury Stock
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-15286000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-13633000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7443000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7816000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-197561000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-190098000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-188448000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-185124000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-62836000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-61923000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-64412000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-42454000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8783000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8212000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8135000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7234000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Capital Surplus
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
129000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
130000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
152000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22006000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21843000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21630000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21421000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Other Stockholder Equity
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5105000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4425000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3279000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3697000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-29490000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-26591000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-29398000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-29606000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21089000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22979000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18626000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21085000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7366000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6959000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7013000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6257000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total stockholders’ equity
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11572000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13629000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16354000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15439000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16796000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17594000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18246000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14262000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30975000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56024000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75822000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98268000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35932000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35578000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
29170000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28642000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Net Tangible Assets
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-17921000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-14772000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-11079000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9620000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22556000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22936000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22641000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-21246000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-46798000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-48217000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-11052000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14945000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35932000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35290000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28922000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28512000
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;how-the-cash-flow-statement-looks&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;How the Cash Flow Statement looks:&lt;/h4&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;font-size: 12px; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption style=&#34;font-size: initial !important;&#34;&gt;
&lt;span id=&#34;tab:unnamed-chunk-6&#34;&gt;Table 3: &lt;/span&gt;Cash Flow Statements
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
UN.f.12.31.2015
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
IBM.f.12.31.2015
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
GE.f.12.31.2015
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2018
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2017
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2016
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
F.f.12.31.2015
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Net Income
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9389000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6053000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5184000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4909000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8728000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5753000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11872000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13190000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22355000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7500000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3677000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7731000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4589000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7373000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Depreciation
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1450000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1214000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1464000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1370000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4480000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4541000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4381000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3855000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7796000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7429000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7070000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6509000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8308000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8453000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8717000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7966000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Adjustments To Net Income
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3590000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-231000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
348000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
331000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1485000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-383000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-526000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2406000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18532000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9305000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-14391000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21411000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-677000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-910000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3607000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2153000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Changes In Accounts Receivables
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1298000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-506000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
142000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1006000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1297000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
712000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
812000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-430000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2846000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1460000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-52000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2239000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2297000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2855000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3563000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Changes In Liabilities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
976000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
542000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-281000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
847000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
197000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
81000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1697000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1343000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2953000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1537000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6781000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6089000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6595000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7758000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Changes In Inventories
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-471000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-104000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
190000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-129000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-127000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-14000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
133000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-902000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1183000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-815000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-314000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-828000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-970000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-803000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1155000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Changes In Other Operating Activities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-793000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-68000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-68000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-68000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-451000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5451000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
462000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3222000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-92000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2617000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2617000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total Cash Flow From Operating Activities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6753000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7292000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7047000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7330000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15247000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16724000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17084000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17255000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4246000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6032000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1160000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19891000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15022000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18096000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19850000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16226000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Capital Expenditure
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1329000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1509000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1804000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1867000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3395000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3229000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3567000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3579000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7695000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7371000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7199000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7309000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7785000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7049000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6992000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7196000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Investments
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-215000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-62000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-554000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1039000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-161000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-231000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3387000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2331000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2074000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-513000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Other Cash flows from Investing Activities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
264000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
292000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
291000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
295000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12953000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10133000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-10317000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5316000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
181000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
937000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
634000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total Cash Flows From Investing Activities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4644000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5879000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3188000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3539000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4913000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7081000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-10928000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8159000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18239000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6564000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49135000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59488000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-16261000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-19360000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-25302000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-26162000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Dividends Paid
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4066000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3916000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3609000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3331000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5666000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5506000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5256000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4897000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4474000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8650000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8806000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9295000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2705000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2384000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2383500
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2380000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Sale Purchase of Stock
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Net Borrowings
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-35000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8928000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1771000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1527000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-301000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3447000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2763000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22401000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8952000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-58411000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-57546000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3139000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6260000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11028000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17148000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Other Cash Flows from Financing Activities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1170000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1227000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-978000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-952000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
112000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
174000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
204000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4141000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1006000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1818000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8114000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-192000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-151000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-107000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-373000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Total Cash Flows From Financing Activities
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-11548000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1433000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3073000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3032000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-10469000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6418000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5917000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9413000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-31033000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-19146000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-90464000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-76054000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-122000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3394000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7400000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14266000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Effect Of Exchange Rate Changes
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
284000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-541000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-495000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
937000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-51000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-473000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-628000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
891000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1146000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3464000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-370000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
489000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-265000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-815000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Change In Cash and Cash Equivalents
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-79000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-29000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1070000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
218000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-630000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4161000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
188000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-790000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9176000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5660000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-41315000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-138000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1731000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2619000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1683000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3515000
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;As in previous posts let’s clean the data up and put it into a better format which is easier for computations.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;############# Combine and clean the data ###############

ISBSCF &amp;lt;- rbind(IS, BS, CF)

ISBSCF &amp;lt;- ISBSCF %&amp;gt;%
  t() %&amp;gt;%
  data.frame() %&amp;gt;%
  rownames_to_column(&amp;#39;rn&amp;#39;) %&amp;gt;%
  separate(rn, into = c(&amp;quot;symbol&amp;quot;, &amp;quot;year&amp;quot;),
           sep = -4, convert = TRUE)


ISBSCF$symbol &amp;lt;- gsub(&amp;quot;(f).*&amp;quot;, &amp;quot;&amp;quot;, ISBSCF$symbol)
ISBSCF$symbol &amp;lt;- gsub(&amp;#39;.$&amp;#39;, &amp;#39;&amp;#39;, ISBSCF$symbol)
ISBSCF$symbol &amp;lt;- gsub(&amp;#39;^X&amp;#39;, &amp;#39;&amp;#39;, ISBSCF$symbol)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;how-the-full-data-looks&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;How the full data looks:&lt;/h4&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;font-size: 12px; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption style=&#34;font-size: initial !important;&#34;&gt;
&lt;span id=&#34;tab:unnamed-chunk-8&#34;&gt;Table 4: &lt;/span&gt;Income Statment - Balance Sheet - Cash Flow
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
symbol
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
year
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.Revenue
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Cost.of.Revenue
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Gross.Profit
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Research.Development
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Selling.General.and.Administrative
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Non.Recurring
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Others
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.Operating.Expenses
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Operating.Income.or.Loss
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.Other.Income.Expenses.Net
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Earnings.Before.Interest.and.Taxes
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Interest.Expense
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Income.Before.Tax
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Income.Tax.Expense
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Minority.Interest
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Net.Income.From.Continuing.Ops
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Discontinued.Operations
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Extraordinary.Items
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Effect.Of.Accounting.Changes
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Other.Items
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Net.Income
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Preferred.Stock.And.Other.Adjustments
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Net.Income.Applicable.To.Common.Shares
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Cash.And.Cash.Equivalents
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Short.Term.Investments
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Net.Receivables
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Inventory
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Other.Current.Assets
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.Current.Assets
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Long.Term.Investments
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Property..plant.and.equipment
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Goodwill
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Intangible.Assets
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Accumulated.Amortization
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Other.Assets
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Deferred.Long.Term.Asset.Charges
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.Assets
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Accounts.Payable
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Short.Current.Long.Term.Debt
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Other.Current.Liabilities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.Current.Liabilities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Long.Term.Debt
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Other.Liabilities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Deferred.Long.Term.Liability.Charges
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Minority.Interest1
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Negative.Goodwill
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.Liabilities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Misc..Stocks.Options.Warrants
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Redeemable.Preferred.Stock
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Preferred.Stock
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Common.Stock
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Retained.Earnings
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Treasury.Stock
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Capital.Surplus
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Other.Stockholder.Equity
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.stockholders..equity
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Net.Tangible.Assets
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Net.Income1
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Depreciation
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Adjustments.To.Net.Income
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Changes.In.Accounts.Receivables
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Changes.In.Liabilities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Changes.In.Inventories
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Changes.In.Other.Operating.Activities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.Cash.Flow.From.Operating.Activities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Capital.Expenditure
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Investments
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Other.Cash.flows.from.Investing.Activities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.Cash.Flows.From.Investing.Activities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Dividends.Paid
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Sale.Purchase.of.Stock
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Net.Borrowings
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Other.Cash.Flows.from.Financing.Activities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Total.Cash.Flows.From.Financing.Activities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Effect.Of.Exchange.Rate.Changes
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Change.In.Cash.and.Cash.Equivalents
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50982000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28769000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22213000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
900000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8803000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41427000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38472000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12510000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-127000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12510000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-627000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12383000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2575000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
720000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9808000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9389000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9389000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3230000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
681000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4822000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4301000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1387000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15481000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
637000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10347000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17341000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12152000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3498000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1117000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59456000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9121000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2012000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3194000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19772000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21535000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5742000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
720000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47164000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
464000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26265000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-15286000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
129000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5105000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11572000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-17921000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9389000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1450000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3590000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1298000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
976000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-471000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-793000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6753000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1329000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
264000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4644000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4066000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-35000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1170000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-11548000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
72000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-79000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53715000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30547000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23168000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
900000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13507000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44031000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44954000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8761000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-608000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8761000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-608000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8153000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1667000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
758000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6486000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6053000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6053000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3317000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
521000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4204000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3962000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4356000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16983000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
565000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10411000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16881000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11520000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3925000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1085000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
60285000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8217000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1537000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2787000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23177000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16342000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6259000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
758000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26648000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-13633000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
130000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4425000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13629000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-14772000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6053000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1214000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-231000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-506000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
542000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-104000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-68000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7292000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1509000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-215000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
292000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5879000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3916000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8928000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1227000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1433000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-29000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
52713000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30229000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
978000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13799000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44031000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45006000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7707000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-238000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7707000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-572000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7469000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1922000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
626000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5547000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5184000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5184000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3382000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
565000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3854000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4278000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1120000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13884000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
491000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11673000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17624000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9809000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2948000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1354000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56429000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8591000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2173000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2392000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20556000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11011000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7748000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
626000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39449000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23179000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7443000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3279000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16354000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-11079000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5184000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1464000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
348000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
142000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-281000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
190000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-68000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7047000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1804000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
100000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
291000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3188000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3609000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1771000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-978000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3073000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
284000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1070000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53272000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30808000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22464000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1005000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14065000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44031000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
45878000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7394000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-174000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7394000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-552000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7220000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1961000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
643000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5259000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4909000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4909000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2302000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
596000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3416000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4335000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1352000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12686000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
592000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11058000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16213000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8846000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2903000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1185000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
52298000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8296000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1495000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2759000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20019000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9696000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6343000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
643000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36216000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22619000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7816000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
152000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3697000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15439000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9620000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4909000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1370000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
331000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
847000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-129000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-68000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7330000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1867000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-62000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
295000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3539000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3331000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1527000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-952000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3032000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-541000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
218000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79591000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42655000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36936000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5379000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20325000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-998000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67361000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12230000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-888000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12230000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-723000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11342000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2619000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8723000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8728000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8728000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11379000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
618000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8596000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1682000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2902000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49146000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
439000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10792000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36265000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3087000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14505000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5216000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
123382000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6558000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7055000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14680000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38227000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35681000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32544000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2676000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106452000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55151000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
159206000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-197561000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-29490000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16796000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22556000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8728000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4480000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1485000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1006000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-127000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-451000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15247000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3395000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-554000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4913000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5666000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-301000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
112000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-10469000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-495000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-630000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79139000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42196000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36943000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5590000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20900000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1445000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67241000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-498000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-615000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11400000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5642000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
131000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5758000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5753000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5753000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11972000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
608000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10380000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1583000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2266000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49735000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
581000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11116000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36788000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3742000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13844000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4862000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
125356000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6451000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5215000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16451000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37363000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39871000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30397000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2136000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
131000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
107631000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
54566000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
153126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-190098000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-26591000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17594000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22936000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5753000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4541000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-383000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1297000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5451000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16724000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3229000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1039000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7081000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5506000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3447000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
174000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6418000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
937000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4161000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79919000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41402000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38517000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5726000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20225000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1604000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65749000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14170000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1840000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14170000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-630000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12330000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
449000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
146000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11881000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11872000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11872000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7826000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
701000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10239000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1553000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
532000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43889000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
659000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10830000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36199000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4688000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12184000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5224000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
117470000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6209000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6239000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14693000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36275000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34663000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28140000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1496000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
146000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
99078000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53935000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
152759000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-188448000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-29398000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18246000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22641000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11872000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4381000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-526000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
712000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
197000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-14000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
462000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17084000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3567000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-161000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-10928000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5256000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2763000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
204000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5917000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-51000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
188000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
81741000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41057000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
40684000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5247000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19589000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-669000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65224000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16517000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-572000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16517000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-468000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15945000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2581000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
162000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13364000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-174000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13190000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13190000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7686000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
508000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9534000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1551000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
293000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42504000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1131000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10727000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32021000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3487000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10612000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4822000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
110495000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6028000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5271000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14281000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34269000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33431000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28371000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1626000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
162000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
96071000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53262000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
146124000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-185124000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-29606000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14262000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-21246000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13190000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3855000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2406000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
812000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
81000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
133000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3222000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17255000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3579000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-231000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8159000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4897000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9413000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-473000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-790000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
121615000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98396000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23219000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
113530000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8085000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-28220000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8085000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2708000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-20135000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
583000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20882000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-20718000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1726000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22355000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22809000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16369000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19874000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19271000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7441000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95974000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34920000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50749000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
58710000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18159000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49713000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12432000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
309129000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17153000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19710000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49937000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95234000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74883000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5739000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20882000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
257266000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
702000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
93109000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-62836000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21089000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30975000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-46798000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22355000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7796000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18532000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-430000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1697000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-902000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-92000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4246000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7695000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12953000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18239000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4474000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22401000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4141000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-31033000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-628000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9176000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
118243000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106858000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11385000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15389000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
122247000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4004000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7147000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4004000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2753000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-11151000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2611000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20859000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8540000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-309000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8944000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18211000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24209000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19419000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6720000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
116253000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
38696000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53874000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
83968000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20273000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56181000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8819000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
369245000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15172000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19531000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
60043000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
108575000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
84243000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20859000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
292356000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
702000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
117245000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-61923000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22979000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56024000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-48217000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8484000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7429000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9305000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2846000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1343000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1183000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6032000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7371000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10133000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6564000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8650000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8952000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1006000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-19146000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
891000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5660000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
119468000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
94886000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24582000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14707000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
109593000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9875000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2843000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9875000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2026000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7032000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1133000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4688000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8165000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-954000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7500000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6829000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10525000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24076000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22354000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3885000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
131436000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
44313000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50518000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
68070000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16436000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
52042000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1833000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
365183000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14435000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20772000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70364000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105080000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
83040000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5534000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4688000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
284667000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
702000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
139532000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-64412000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18626000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75822000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-11052000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7500000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7070000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-14391000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1460000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2953000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-815000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2617000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1160000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7199000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-10317000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49135000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8806000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-58411000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1818000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-90464000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1146000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-41315000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115834000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
90111000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
25723000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16327000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
106438000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9396000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1211000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9396000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1706000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8185000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6485000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4836000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1700000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7807000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6135000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10372000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43013000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22515000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5109000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
280896000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
31973000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
54095000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
65526000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17797000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42784000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3105000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
493071000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13680000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27453000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
138270000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
144659000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
79175000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4836000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
389961000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
702000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
140020000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-42454000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21085000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98268000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14945000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6509000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21411000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-52000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1537000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-314000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2617000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19891000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7309000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-5316000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59488000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-9295000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-57546000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8114000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-76054000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3464000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-138000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
160338000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
145459000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14879000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10460000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
155919000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4419000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-74000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4419000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1228000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4345000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
650000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3695000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3677000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3677000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7111000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15925000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3698000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11220000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2567000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
114649000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2595000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
37883000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
264000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
178000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16755000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10412000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
256540000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20426000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1700000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18868000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95569000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11833000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23088000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
220474000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22668000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8783000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22006000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7366000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35932000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35932000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3677000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8308000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-677000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2239000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6781000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-828000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15022000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7785000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3387000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
181000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-16261000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2705000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3139000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-192000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-122000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-370000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1731000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
156776000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
140218000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16558000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9676000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
149894000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6882000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1277000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6882000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1190000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8159000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
402000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7757000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7731000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7731000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8934000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17554000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10599000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11176000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3649000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
116801000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3448000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
36901000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
213000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18215000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10762000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
258496000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23282000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1960000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16402000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
94600000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13174000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
25526000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
232000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
126000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
222792000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21906000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8212000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21843000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6959000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35578000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35290000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7731000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8453000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-910000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2297000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6089000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-970000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18096000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7049000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2331000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-19360000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2384000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6260000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-151000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3394000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
489000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2619000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
151800000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
134933000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16867000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12504000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
147437000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4363000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2421000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4363000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-951000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6784000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2184000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
113000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4600000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4589000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4589000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7828000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19642000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11102000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3145000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
108461000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3523000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33692000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
50000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
198000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14894000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9705000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
237951000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21296000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1361000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16277000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
90281000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13222000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
25086000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
113000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
208668000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15634000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-8135000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21630000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7013000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
29170000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28922000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4589000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8717000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3607000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2855000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6595000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-803000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19850000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6992000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2074000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
937000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-25302000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2383500
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11028000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-107000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7400000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-265000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1683000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
149558000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
131410000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18148000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10097000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
141507000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8051000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2201000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8051000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-773000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10252000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2881000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
109000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7371000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7373000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7373000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5386000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18181000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11042000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8319000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2704000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
102587000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3244000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32177000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
124000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16154000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11509000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
224925000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20272000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
961000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16084000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
82336000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11060000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23959000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
109000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
196174000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
41000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14414000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7234000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21421000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6257000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28642000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28512000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7373000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7966000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2153000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-3563000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7758000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-1155000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16226000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7196000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-513000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
634000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-26162000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2380000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17148000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-373000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14266000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-815000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3515000
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Now that we have the full data, we can perform any number of calculations across different financial statements. Now the companies are in the “rows” and the “columns” consist of thefinancial entires.&lt;/p&gt;
&lt;p&gt;Some calculations are necessary for computing the &lt;code&gt;NFO&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;compute-the-cash-flow-cycle&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Compute the Cash Flow Cycle&lt;/h4&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;########## Create the Cash Cycle Calculations #############

#Set CashCycle data.frame up
CashCycle &amp;lt;- data.frame(matrix(&amp;quot;&amp;quot;, nrow = nrow(ISBSCF)))
CashCycle[,1] &amp;lt;- NULL
CashCycle$Ticker &amp;lt;- ISBSCF$symbol
CashCycle$Date &amp;lt;- ISBSCF$year

#CashCycle excluding accured expense Calculations
CashCycle$CollectionPeriod &amp;lt;- (ISBSCF$Net.Receivables / ISBSCF$Total.Revenue) * 365
CashCycle$DaysofInventory &amp;lt;- (ISBSCF$Inventory / ISBSCF$Cost.of.Revenue) * 365
CashCycle$DaysofPayable &amp;lt;- (ISBSCF$Accounts.Payable / ISBSCF$Cost.of.Revenue) * 365
CashCycle$CashCollectionCycle &amp;lt;- CashCycle$CollectionPeriod + CashCycle$DaysofInventory - CashCycle$DaysofPayable
#CashCycle including accured expense Calculations
CashCycle$DaysofPayableAccExp &amp;lt;- ((ISBSCF$Accounts.Payable + ISBSCF$Total.Current.Liabilities) / ISBSCF$Cost.of.Revenue) * 365
CashCycle$CashCollectionCycleAccExp &amp;lt;- CashCycle$CollectionPeriod + CashCycle$DaysofInventory - CashCycle$DaysofPayableAccExp

CashCycle &amp;lt;- CashCycle[Reduce(`&amp;amp;`, lapply(CashCycle, function(x) !is.nan(x)  &amp;amp; !is.infinite(x))),]&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;font-size: 12px; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption style=&#34;font-size: initial !important;&#34;&gt;
&lt;span id=&#34;tab:unnamed-chunk-10&#34;&gt;Table 5: &lt;/span&gt;Cash Flow Cycle
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Ticker
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Date
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CollectionPeriod
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DaysofInventory
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DaysofPayable
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CashCollectionCycle
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
DaysofPayableAccExp
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CashCollectionCycleAccExp
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.522577
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
54.56794
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115.72057
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-26.630053
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
366.5732
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-277.4827
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.566695
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47.34115
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.18329
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-22.275450
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
375.1206
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-299.2128
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26.686206
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.65470
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
103.73201
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-25.391103
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
351.9354
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-273.5945
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.405166
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.35922
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98.28746
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-23.523067
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
335.4640
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-260.6996
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.420789
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14.39292
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56.11699
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-2.303276
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
383.2265
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-329.4128
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47.873994
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13.69312
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.80185
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5.765263
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
378.9959
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-317.4288
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
46.762785
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13.69125
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
54.73854
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5.715492
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
374.5389
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-314.0849
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42.572393
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13.78851
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
53.58940
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2.771507
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
358.2435
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-301.8826
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59.647330
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
71.48578
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
63.62906
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67.504052
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
248.8704
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-117.7373
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74.729878
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
66.33041
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.82373
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
89.236560
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
256.9155
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-115.8552
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73.557271
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
85.98961
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.52742
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
104.019457
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
326.1981
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-166.6512
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
135.536587
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
91.19836
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55.41166
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
171.323283
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
615.4826
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-388.7476
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8.418279
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.15433
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51.25492
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-14.682320
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
291.0660
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-254.4934
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24.676194
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
29.09213
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
60.60513
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6.836807
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
306.8574
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-253.0891
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26.694532
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24.06950
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
57.60666
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6.842631
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
301.8209
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-251.0569
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26.948274
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.10657
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56.30683
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6.251977
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
285.0005
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-234.9457
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Where all the results are in days. So Unilever &lt;code&gt;2018&lt;/code&gt;, &lt;code&gt;CollectionPeriod&lt;/code&gt; was &lt;code&gt;34.5&lt;/code&gt; days, up from their &lt;code&gt;2017&lt;/code&gt;, &lt;code&gt;CollectionPeriod&lt;/code&gt; and up annually since &lt;code&gt;2015&lt;/code&gt;. Wheras &lt;code&gt;Ford&lt;/code&gt; has been decreasing their &lt;code&gt;CollectionPeriod&lt;/code&gt; over the sample period.&lt;/p&gt;
&lt;p&gt;Let us continue with some DuPont analysis…&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;########## Create the DuPont Calculations #############

#DuPont Analysis
#Set CashCycle data.frame up
DuPontAnalysis &amp;lt;- data.frame(matrix(&amp;quot;&amp;quot;, nrow = nrow(ISBSCF)))
DuPontAnalysis[,1] &amp;lt;- NULL
DuPontAnalysis$Ticker &amp;lt;- ISBSCF$symbol
DuPontAnalysis$Date &amp;lt;- ISBSCF$year
#DuPont Analysis Calculations
DuPontAnalysis$ROE &amp;lt;- ISBSCF$Net.Income / ISBSCF$Total.stockholders..equity
DuPontAnalysis$ROS &amp;lt;- ISBSCF$Net.Income / ISBSCF$Total.Revenue
DuPontAnalysis$Turnover &amp;lt;- ISBSCF$Total.Revenue / ISBSCF$Total.Assets
DuPontAnalysis$Leverage &amp;lt;- ISBSCF$Total.Assets / ISBSCF$Total.stockholders..equity

DuPontAnalysis &amp;lt;- DuPontAnalysis[Reduce(`&amp;amp;`, lapply(DuPontAnalysis, function(x) !is.nan(x)  &amp;amp; !is.infinite(x))),]&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;font-size: 12px; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption style=&#34;font-size: initial !important;&#34;&gt;
&lt;span id=&#34;tab:unnamed-chunk-12&#34;&gt;Table 6: &lt;/span&gt;DuPont Calculations
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Ticker
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Date
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ROE
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
ROS
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Turnover
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Leverage
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.8113550
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1841630
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.8574744
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5.137919
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.4441265
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1126873
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.8910177
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4.423289
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3169867
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0983439
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9341473
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3.450471
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3179610
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0921497
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1.0186240
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3.387396
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.5196475
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1096606
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6450779
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7.345916
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3269865
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0726949
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6313140
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7.124929
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6506632
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1485504
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6803354
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6.438123
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.9248352
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1613633
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.7397710
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7.747511
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.7217111
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.1838178
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3934118
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9.979952
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.1514351
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0717505
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3202291
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6.590836
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0989159
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0627783
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.3271456
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4.816320
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0623397
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.0528860
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2349236
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5.017615
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1023322
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0229328
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6250019
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7.139597
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2172972
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0493124
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6064929
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7.265614
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.1573192
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0302306
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6379465
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8.157388
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.2574192
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0492986
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.6649239
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7.852978
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;compute-the-need-for-funds-and-working-capital-calculations&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Compute the Need for Funds and Working Capital calculations&lt;/h4&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;########## Create the NFO &amp;amp; WC Calculations #############

#NFO-WC Analysis
NFO_WCAnalysis &amp;lt;- data.frame(matrix(&amp;quot;&amp;quot;, nrow = nrow(ISBSCF)))
NFO_WCAnalysis[,1] &amp;lt;- NULL
NFO_WCAnalysis$Ticker &amp;lt;- ISBSCF$symbol
NFO_WCAnalysis$Date &amp;lt;- ISBSCF$year
#NFO_WC Analysis Calculations
NFO_WCAnalysis$REC &amp;lt;- ISBSCF$Net.Receivables
NFO_WCAnalysis$INV &amp;lt;- ISBSCF$Inventory
NFO_WCAnalysis$OtherCurrentAssetsNotCash &amp;lt;- ISBSCF$Other.Current.Assets
NFO_WCAnalysis$Payables &amp;lt;- ISBSCF$Accounts.Payable
NFO_WCAnalysis$SpontaneousFunsIncDeftaxes &amp;lt;- ISBSCF$Total.Current.Liabilities + ISBSCF$Other.Current.Liabilities + ISBSCF$Income.Tax.Expense

####
NFO_WCAnalysis$NFO &amp;lt;- NFO_WCAnalysis$REC + NFO_WCAnalysis$INV + NFO_WCAnalysis$OtherCurrentAssetsNotCash - NFO_WCAnalysis$Payables - NFO_WCAnalysis$SpontaneousFunsIncDeftaxes
NFO_WCAnalysis$LTD &amp;lt;- ISBSCF$Long.Term.Debt
NFO_WCAnalysis$EQ &amp;lt;- ISBSCF$Total.stockholders..equity
NFO_WCAnalysis$OtherLongTermLiabilities &amp;lt;- ISBSCF$Minority.Interest + ISBSCF$Other.Liabilities
NFO_WCAnalysis$FA &amp;lt;- ISBSCF$Total.Assets - ISBSCF$Total.Current.Assets

###
NFO_WCAnalysis$WC &amp;lt;- NFO_WCAnalysis$LTD + NFO_WCAnalysis$EQ + NFO_WCAnalysis$OtherLongTermLiabilities - NFO_WCAnalysis$FA
NFO_WCAnalysis$CreditPlusCashMinus &amp;lt;- NFO_WCAnalysis$NFO - NFO_WCAnalysis$WC

NFO_WCAnalysis &amp;lt;- NFO_WCAnalysis[Reduce(`&amp;amp;`, lapply(NFO_WCAnalysis, function(x) !is.nan(x)  &amp;amp; !is.infinite(x))),]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Lets inspect the result.&lt;/p&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;font-size: 12px; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption style=&#34;font-size: initial !important;&#34;&gt;
&lt;span id=&#34;tab:unnamed-chunk-14&#34;&gt;Table 7: &lt;/span&gt;NFO WC Analysis
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Ticker
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Date
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
REC
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
INV
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
OtherCurrentAssetsNotCash
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Payables
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
SpontaneousFunsIncDeftaxes
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
NFO
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
LTD
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
EQ
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
OtherLongTermLiabilities
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
FA
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
WC
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
CreditPlusCashMinus
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4822000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4301000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1387000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9121000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
25541000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-24152000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21535000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11572000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6462000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43975000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-4406000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-19746000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4204000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3962000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4356000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8217000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
27631000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-23326000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16342000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13629000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7017000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43302000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6314000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-17012000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3854000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4278000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1120000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8591000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24870000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-24209000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11011000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16354000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8374000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
42545000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-6806000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-17403000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3416000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4335000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1352000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8296000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24739000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-23932000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9696000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15439000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6986000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39612000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-7491000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-16441000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8596000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1682000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2902000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6558000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
55526000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-48904000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35681000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16796000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
32678000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
74236000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10919000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-59823000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10380000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1583000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2266000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6451000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
59456000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-51678000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39871000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17594000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30528000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75621000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12372000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-64050000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10239000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1553000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
532000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6209000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51417000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-45302000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34663000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18246000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28286000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
73581000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7614000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-52916000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9534000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1551000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
293000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6028000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
51131000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-45781000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
33431000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14262000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28533000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
67991000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8235000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-54016000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19874000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19271000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7441000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17153000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
70230000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-40797000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95234000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
30975000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
95765000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
213155000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8819000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-49616000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24209000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
19419000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6720000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15172000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
76963000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-41787000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
108575000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
56024000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105102000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
252992000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16709000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-58496000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24076000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22354000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3885000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14435000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
90003000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-54123000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
105080000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75822000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
87728000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
233747000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34883000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-89006000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GE
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
43013000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
22515000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5109000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13680000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
172208000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-115251000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
144659000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
98268000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
84011000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
212175000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
114763000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-230014000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3698000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11220000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2567000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20426000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
115087000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-118028000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11833000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35932000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23222000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
141891000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-70904000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-47124000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10599000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11176000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3649000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23282000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
111404000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-109262000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13174000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
35578000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
25652000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
141695000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-67291000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-41971000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11102000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8898000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3145000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
21296000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
108742000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-106893000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13222000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
29170000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
25199000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
129490000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-61899000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-44994000
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
F
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11042000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8319000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2704000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
20272000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
101301000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-99508000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11060000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28642000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
24068000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
122338000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-58568000
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-40940000
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;According to &lt;a href=&#34;https://www.iese.edu/faculty-research/faculty/miguel-anton/&#34;&gt;Miguel Antón&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;*If NFO &amp;gt; WC - ask for credit&lt;/p&gt;
&lt;p&gt;*If NFO &amp;lt; WC - surplus cash&lt;/p&gt;
&lt;p&gt;Lets plot the results and analyse them further:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;########## Plot the NFO &amp;amp; WC #############

symbol &amp;lt;- NULL
symbols &amp;lt;- unique(NFO_WCAnalysis$Ticker)

# Create the plots for NFO and WC for all symbols
plotList &amp;lt;- list()
for(symbol in symbols){
  plotList[[symbol]] &amp;lt;- ggplot(subset(NFO_WCAnalysis, Ticker %in% symbol)) +
    geom_line(aes(Date, NFO, group = Ticker, colour = &amp;quot;Blue&amp;quot;)) +
    geom_line(aes(Date, WC, group = Ticker, colour = &amp;quot;Red&amp;quot;)) +
    labs(title=paste0(&amp;quot;NFO and WC plot &amp;quot;, symbol), x=&amp;quot;Year&amp;quot;, y=&amp;quot;NFO / WC&amp;quot;) +
    scale_color_manual(labels = c(&amp;quot;NFO&amp;quot;, &amp;quot;WC&amp;quot;), values = c(&amp;quot;Blue&amp;quot;, &amp;quot;Red&amp;quot;)) +
    guides(color=guide_legend(&amp;quot;Legend&amp;quot;)) +
    theme_tq() +
    theme(legend.position = &amp;quot;right&amp;quot;)
}


# Change the symbols to view the NFO WC plots
plotList[1]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $UN&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/nfo-wc-calculations/nfo-wc-calculations-plots_files/figure-html/unnamed-chunk-15-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plotList[2]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $IBM&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/nfo-wc-calculations/nfo-wc-calculations-plots_files/figure-html/unnamed-chunk-15-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plotList[3]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $GE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/nfo-wc-calculations/nfo-wc-calculations-plots_files/figure-html/unnamed-chunk-15-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plotList[4]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $F&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/nfo-wc-calculations/nfo-wc-calculations-plots_files/figure-html/unnamed-chunk-15-4.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Print the results to a PDF document
#pdf(&amp;quot;PlotsNFO_WC.pdf&amp;quot;, onefile = TRUE, paper = &amp;quot;USr&amp;quot;) #Uncomment this if you want to save to .pdf
#plotList
#dev.off()&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;plotting-the-collection-period-inventory-days-and-days-of-payabales&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Plotting the collection period, inventory days and days of payabales&lt;/h4&gt;
&lt;p&gt;We can also analyse the collection periods for each firm. &lt;code&gt;mm&lt;/code&gt; here simply means &lt;code&gt;melted&lt;/code&gt; data - which is a way of &lt;code&gt;reshaping&lt;/code&gt; a data frame in R, check out the &lt;code&gt;melt&lt;/code&gt; functon from the &lt;code&gt;reshape2&lt;/code&gt; package in R if interested.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;########## Collection Period, Days of Inventory and Days of Payable #############
# Create the plots for Collection Period, Days of Inventory and Days of Payable

mm &amp;lt;- melt(CashCycle, id = c(&amp;#39;Ticker&amp;#39;, &amp;#39;Date&amp;#39;))
mm &amp;lt;- mm[mm$variable == &amp;quot;CollectionPeriod&amp;quot; | mm$variable == &amp;quot;DaysofInventory&amp;quot; | mm$variable == &amp;quot;DaysofPayable&amp;quot;,]
mm$value &amp;lt;- with(mm, ifelse(variable == &amp;quot;DaysofPayable&amp;quot;, -value, value))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped table-hover table-condensed table-responsive&#34; style=&#34;font-size: 12px; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption style=&#34;font-size: initial !important;&#34;&gt;
&lt;span id=&#34;tab:unnamed-chunk-17&#34;&gt;Table 8: &lt;/span&gt;Collection Period - Days of Inventory - Days of Payable
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Ticker
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Date
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
variable
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
value
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CollectionPeriod
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
34.52258
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CollectionPeriod
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
28.56669
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2016
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CollectionPeriod
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
26.68621
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
UN
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2015
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CollectionPeriod
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
23.40517
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CollectionPeriod
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
39.42079
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
IBM
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2017
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CollectionPeriod
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
47.87399
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;plot-the-results&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Plot the results&lt;/h4&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;########## Plot the Collection Period, Days of Inventory and Days of Payable #############

symbol &amp;lt;- NULL
symbols &amp;lt;- unique(mm$Ticker)

plotListBar &amp;lt;- list()
for(symbol in symbols){
  plotListBar[[symbol]] &amp;lt;- ggplot(mm[mm$Ticker == symbol,], aes(Date, value,  fill = variable)) + facet_wrap(~ Ticker) +
    geom_bar(stat=&amp;quot;identity&amp;quot;, position = &amp;quot;dodge&amp;quot;) +
    theme_tq() +
    theme(legend.position = &amp;quot;right&amp;quot;)
}

plotListBar[1]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $UN&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/nfo-wc-calculations/nfo-wc-calculations-plots_files/figure-html/unnamed-chunk-18-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plotListBar[2]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $IBM&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/nfo-wc-calculations/nfo-wc-calculations-plots_files/figure-html/unnamed-chunk-18-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plotListBar[3]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $GE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/nfo-wc-calculations/nfo-wc-calculations-plots_files/figure-html/unnamed-chunk-18-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plotListBar[4]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $F&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/nfo-wc-calculations/nfo-wc-calculations-plots_files/figure-html/unnamed-chunk-18-4.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Print the results to a PDF document
#pdf(&amp;quot;Plots_OperationalRatios.pdf&amp;quot;, onefile = TRUE, paper = &amp;quot;USr&amp;quot;) #Uncomment if you want to save to .pdf
#plotListBar
#dev.off()&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;any-errors-are-my-own&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Any errors are my own!&lt;/h4&gt;
&lt;p&gt;You can save the results using:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# library(openxlsx)
# if(devtools::find_rtools()) Sys.setenv(R_ZIPCMD= file.path(devtools:::get_rtools_path(),&amp;quot;zip&amp;quot;))
# write.xlsx(CashCycle, &amp;#39;CashCycle.xlsx&amp;#39;)
# write.xlsx(DuPontAnalysis, &amp;#39;DuPontAnalysis.xlsx&amp;#39;)
# write.xlsx(NFO_WCAnalysis, &amp;#39;NFO_WCAnalysis.xlsx&amp;#39;)
# write.xlsx(df, &amp;#39;FinancialsAllCompanies.xlsx&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>