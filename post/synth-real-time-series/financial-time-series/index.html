<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Matthew Smith">

  
  
  
    
  
  <meta name="description" content="I analyse the difference between two time series and obtain a 67% accuracy (on anonymous data)">

  
  <link rel="alternate" hreflang="en-us" href="/post/synth-real-time-series/financial-time-series/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.5ff542731a650dc259fe0480984e3969.css">

  

  
  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/synth-real-time-series/financial-time-series/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Matthew Smith R Shenanigans">
  <meta property="og:url" content="/post/synth-real-time-series/financial-time-series/">
  <meta property="og:title" content="Time Series Classification Synthetic vs Real Financial Time Series | Matthew Smith R Shenanigans">
  <meta property="og:description" content="I analyse the difference between two time series and obtain a 67% accuracy (on anonymous data)"><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-11-03T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2019-11-03T00:00:00&#43;00:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/synth-real-time-series/financial-time-series/"
  },
  "headline": "Time Series Classification Synthetic vs Real Financial Time Series",
  
  "datePublished": "2019-11-03T00:00:00Z",
  "dateModified": "2019-11-03T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Matthew Smith"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Matthew Smith R Shenanigans",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "I analyse the difference between two time series and obtain a 67% accuracy (on anonymous data)"
}
</script>

  

  


  


  





  <title>Time Series Classification Synthetic vs Real Financial Time Series | Matthew Smith R Shenanigans</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Matthew Smith R Shenanigans</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Time Series Classification Synthetic vs Real Financial Time Series</h1>

  
  <p class="page-subtitle">Distinguishing between real financial time series and synthetic time series using XGBoost</p>
  

  
    



<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Nov 3, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    53 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/financial-time-series/">financial time series</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/synth-real-time-series/financial-time-series/&amp;text=Time%20Series%20Classification%20Synthetic%20vs%20Real%20Financial%20Time%20Series" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/synth-real-time-series/financial-time-series/&amp;t=Time%20Series%20Classification%20Synthetic%20vs%20Real%20Financial%20Time%20Series" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Time%20Series%20Classification%20Synthetic%20vs%20Real%20Financial%20Time%20Series&amp;body=/post/synth-real-time-series/financial-time-series/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/synth-real-time-series/financial-time-series/&amp;title=Time%20Series%20Classification%20Synthetic%20vs%20Real%20Financial%20Time%20Series" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Time%20Series%20Classification%20Synthetic%20vs%20Real%20Financial%20Time%20Series%20/post/synth-real-time-series/financial-time-series/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/synth-real-time-series/financial-time-series/&amp;title=Time%20Series%20Classification%20Synthetic%20vs%20Real%20Financial%20Time%20Series" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    













<div class="btn-links mb-3">
  
  








  









  
    
  











</div>


  
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>


<p><strong>::Note::</strong> This is a long post but I talk about the procedure I took when dealing with a specific time series classification task.</p>
<p>I was given a “Data Science” challenge as part of an interview in which I had to distinguish between real financial time series and synthetic time series. I document the results here, the data was anonymous and I have no idea which assets were which or from what time series the assets came from.</p>
<p>To conclude I obtained an <em>in-sample-test-accuracy</em> of 67% and an <em>out-of-sample-test-accuracy</em> of 65% (based on what the interviewers told me)</p>
<p>All I knew was that I had 12,000 real time series and 12,000 synthetically created time series. (apologies for no data but this was the companies data and not mine). In total there were 24,000 observations. I show the code here for methodological purposes and if you are interested in visualising time series in R and <code>ggplot2</code>. The time series features used here are taken from the following papers:</p>
<ul>
<li>Large Scale Unusual Time Series Detection by R.Hyndman, E.Wang and N.Laptop</li>
<li>Visualising forecasting algorithm performance using time series instance spaces by Y.Kang, Rob.Hyndman and Kate.Smith-Miles</li>
</ul>
<p>You can check out my Jupyter Notebook version <a href="https://nbviewer.jupyter.org/github/msmith01/time_series_detection/blob/master/Time_Series_Classification_Financial_Markets.ipynb">here</a>.</p>
<p>I added a lot of notes to the code throughout the document which might be of additional interest.</p>
<div id="a-brief-overview-of-the-notebook" class="section level3">
<h3>A brief overview of the notebook:</h3>
</div>
<div id="part-1-of-the-notebook" class="section level3">
<h3>Part 1 of the notebook:</h3>
<ul>
<li>Cleans the data and puts it into a better format for analysis. The data I recieved removed all dates, assest names etc. for anonymity.</li>
<li>Simple plot of some returns for the Synthetic and Real financial time series.</li>
<li>Box-plots of average returns and standard deviations.</li>
<li>Computes the Durbin-Watson test statistics for both Synthetic and Real time series and box-plots.</li>
<li>Plot the 10 day rolling mean and standard deviations for a random time series for Synthetic and real data.</li>
<li>Dickey Fuller test on both the Synthetic and real time series.</li>
<li>Jarque-Bera Test For Normality on the Synthetic and real time series.</li>
<li>ACF Plots for both the Synthetic and real time series.</li>
</ul>
</div>
<div id="part-2-of-the-notebook" class="section level3">
<h3>Part 2 of the notebook:</h3>
<ul>
<li>Creates the time series features.</li>
<li>Splits the train.csv into “train” and “validation” data sets.</li>
<li>Puts the data into the correct format for XGBoost.</li>
<li>Sets up and searches over a parameter space to find the most optimal parameters for this data set (on the train data).</li>
<li>Outputs these parameters into a data frame.</li>
<li>Train the model using the optimal parameters found from the grid-search.</li>
<li>Plot the feature importance scores - i.e. the most “important” variables that the model found when making its predictions.</li>
<li>Assign a cut-off on the probability scores (&gt; 0.5 then assign a 1 - real time series, &lt;= 0.5 then assign a 0 for Synthetic).</li>
<li>Compute the Confusion Matrix and analyse the ‘in-sample’ validation results.</li>
</ul>
</div>
<div id="part-3-of-the-notebook" class="section level3">
<h3>Part 3 of the notebook:</h3>
<ul>
<li>Create the “test.csv” features just as before and save as “TSfeatures_test.csv”.</li>
<li>Load in the “TSfeatures_train_val.csv” and “TSfeatures_test.csv” which were created from “train.csv” and “test.csv”.</li>
<li>Set up and run the XGBoost model using the optimal parameters found from the cross-validation grid search in “Part 2”.</li>
<li>Plot the predicted probability density plot as before in “Part 2”.</li>
<li>Set the cut-off threshold as the mean prediction score (0.465) which is close to the (0.500) score from “Part 2”.</li>
<li>Save the results as “submission.csv”.</li>
</ul>
<p>Lets get started…</p>
<p>I often remove all other data in my environment before hand and turn scientific notation off which is what the first 2 lines does. The <code>shhh</code> command is useful for Jupyter Notebooks which outputs all the warning messages, adding <code>shhh</code> suppresses these warning messaged when loading in the packages. (In R markdown I can set <code>warning = FALSE</code> but there is no option on Notebooks.)</p>
<pre class="r"><code>rm(list = ls())
options(scipen=999)
setwd(&#39;C:/Users/Matt/Desktop/Data Science Challenge&#39;)
shhh &lt;- suppressPackageStartupMessages

shhh(library(dplyr))
library(readr)
library(TSrepr)
library(ggplot2)
library(data.table)
library(cluster)
library(clusterCrit)
library(fractalrock)
library(cowplot)
library(tidyr)
library(tidyquant)
library(lmtest)
library(aTSA)
library(tsoutliers)
library(tsfeatures)
library(xgboost)
library(caret)
library(purrr)

train_val &lt;- read_csv(&quot;train.csv&quot;)
test &lt;- read_csv(&quot;test.csv&quot;)</code></pre>
</div>
<div id="note" class="section level3">
<h3>NOTE:</h3>
<p>I have 2 data sets, the <code>train_Val.csv</code> for training and validation data set and the <code>test.csv</code> data set. I do not touch the <code>test.csv</code> data set until the very end in <em>part 3</em>. All the analysis and optimisation is performed only on the <code>train_val.csv</code> data set. The <code>train_val.csv</code> contains 12,000 observations and the <code>test.csv</code> contains 12,000 observations.</p>
</div>
<div id="part-1" class="section level3">
<h3>Part 1</h3>
<p>The data was given to me in this format:</p>
<pre class="r"><code>head(train_val[, 1:5], 1)</code></pre>
<pre><code>## # A tibble: 1 x 5
##   feature1 feature2 feature3 feature4 feature5
##      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1  0.00629  0.00441  -0.0381   0.0253 -0.00658</code></pre>
<p>The names of the columns are as follows:</p>
<pre class="r"><code>colnames(train_val) %&gt;%
  data.frame() %&gt;%
  setNames(c(&quot;features&quot;)) %&gt;%
  split(as.integer(gl(nrow(.), 20, nrow(.)))) %&gt;%
  kable(caption = &quot;Time series variables&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), font_size = 12)</code></pre>
<table class="kable_wrapper table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-3">Table 1: </span>Time series variables
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
feature1
</td>
</tr>
<tr>
<td style="text-align:left;">
feature2
</td>
</tr>
<tr>
<td style="text-align:left;">
feature3
</td>
</tr>
<tr>
<td style="text-align:left;">
feature4
</td>
</tr>
<tr>
<td style="text-align:left;">
feature5
</td>
</tr>
<tr>
<td style="text-align:left;">
feature6
</td>
</tr>
<tr>
<td style="text-align:left;">
feature7
</td>
</tr>
<tr>
<td style="text-align:left;">
feature8
</td>
</tr>
<tr>
<td style="text-align:left;">
feature9
</td>
</tr>
<tr>
<td style="text-align:left;">
feature10
</td>
</tr>
<tr>
<td style="text-align:left;">
feature11
</td>
</tr>
<tr>
<td style="text-align:left;">
feature12
</td>
</tr>
<tr>
<td style="text-align:left;">
feature13
</td>
</tr>
<tr>
<td style="text-align:left;">
feature14
</td>
</tr>
<tr>
<td style="text-align:left;">
feature15
</td>
</tr>
<tr>
<td style="text-align:left;">
feature16
</td>
</tr>
<tr>
<td style="text-align:left;">
feature17
</td>
</tr>
<tr>
<td style="text-align:left;">
feature18
</td>
</tr>
<tr>
<td style="text-align:left;">
feature19
</td>
</tr>
<tr>
<td style="text-align:left;">
feature20
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
feature21
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
feature22
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
feature23
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
feature24
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
feature25
</td>
</tr>
<tr>
<td style="text-align:left;">
26
</td>
<td style="text-align:left;">
feature26
</td>
</tr>
<tr>
<td style="text-align:left;">
27
</td>
<td style="text-align:left;">
feature27
</td>
</tr>
<tr>
<td style="text-align:left;">
28
</td>
<td style="text-align:left;">
feature28
</td>
</tr>
<tr>
<td style="text-align:left;">
29
</td>
<td style="text-align:left;">
feature29
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
feature30
</td>
</tr>
<tr>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
feature31
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
feature32
</td>
</tr>
<tr>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
feature33
</td>
</tr>
<tr>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
feature34
</td>
</tr>
<tr>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
feature35
</td>
</tr>
<tr>
<td style="text-align:left;">
36
</td>
<td style="text-align:left;">
feature36
</td>
</tr>
<tr>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
feature37
</td>
</tr>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
feature38
</td>
</tr>
<tr>
<td style="text-align:left;">
39
</td>
<td style="text-align:left;">
feature39
</td>
</tr>
<tr>
<td style="text-align:left;">
40
</td>
<td style="text-align:left;">
feature40
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
feature41
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
feature42
</td>
</tr>
<tr>
<td style="text-align:left;">
43
</td>
<td style="text-align:left;">
feature43
</td>
</tr>
<tr>
<td style="text-align:left;">
44
</td>
<td style="text-align:left;">
feature44
</td>
</tr>
<tr>
<td style="text-align:left;">
45
</td>
<td style="text-align:left;">
feature45
</td>
</tr>
<tr>
<td style="text-align:left;">
46
</td>
<td style="text-align:left;">
feature46
</td>
</tr>
<tr>
<td style="text-align:left;">
47
</td>
<td style="text-align:left;">
feature47
</td>
</tr>
<tr>
<td style="text-align:left;">
48
</td>
<td style="text-align:left;">
feature48
</td>
</tr>
<tr>
<td style="text-align:left;">
49
</td>
<td style="text-align:left;">
feature49
</td>
</tr>
<tr>
<td style="text-align:left;">
50
</td>
<td style="text-align:left;">
feature50
</td>
</tr>
<tr>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
feature51
</td>
</tr>
<tr>
<td style="text-align:left;">
52
</td>
<td style="text-align:left;">
feature52
</td>
</tr>
<tr>
<td style="text-align:left;">
53
</td>
<td style="text-align:left;">
feature53
</td>
</tr>
<tr>
<td style="text-align:left;">
54
</td>
<td style="text-align:left;">
feature54
</td>
</tr>
<tr>
<td style="text-align:left;">
55
</td>
<td style="text-align:left;">
feature55
</td>
</tr>
<tr>
<td style="text-align:left;">
56
</td>
<td style="text-align:left;">
feature56
</td>
</tr>
<tr>
<td style="text-align:left;">
57
</td>
<td style="text-align:left;">
feature57
</td>
</tr>
<tr>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
feature58
</td>
</tr>
<tr>
<td style="text-align:left;">
59
</td>
<td style="text-align:left;">
feature59
</td>
</tr>
<tr>
<td style="text-align:left;">
60
</td>
<td style="text-align:left;">
feature60
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
61
</td>
<td style="text-align:left;">
feature61
</td>
</tr>
<tr>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
feature62
</td>
</tr>
<tr>
<td style="text-align:left;">
63
</td>
<td style="text-align:left;">
feature63
</td>
</tr>
<tr>
<td style="text-align:left;">
64
</td>
<td style="text-align:left;">
feature64
</td>
</tr>
<tr>
<td style="text-align:left;">
65
</td>
<td style="text-align:left;">
feature65
</td>
</tr>
<tr>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
feature66
</td>
</tr>
<tr>
<td style="text-align:left;">
67
</td>
<td style="text-align:left;">
feature67
</td>
</tr>
<tr>
<td style="text-align:left;">
68
</td>
<td style="text-align:left;">
feature68
</td>
</tr>
<tr>
<td style="text-align:left;">
69
</td>
<td style="text-align:left;">
feature69
</td>
</tr>
<tr>
<td style="text-align:left;">
70
</td>
<td style="text-align:left;">
feature70
</td>
</tr>
<tr>
<td style="text-align:left;">
71
</td>
<td style="text-align:left;">
feature71
</td>
</tr>
<tr>
<td style="text-align:left;">
72
</td>
<td style="text-align:left;">
feature72
</td>
</tr>
<tr>
<td style="text-align:left;">
73
</td>
<td style="text-align:left;">
feature73
</td>
</tr>
<tr>
<td style="text-align:left;">
74
</td>
<td style="text-align:left;">
feature74
</td>
</tr>
<tr>
<td style="text-align:left;">
75
</td>
<td style="text-align:left;">
feature75
</td>
</tr>
<tr>
<td style="text-align:left;">
76
</td>
<td style="text-align:left;">
feature76
</td>
</tr>
<tr>
<td style="text-align:left;">
77
</td>
<td style="text-align:left;">
feature77
</td>
</tr>
<tr>
<td style="text-align:left;">
78
</td>
<td style="text-align:left;">
feature78
</td>
</tr>
<tr>
<td style="text-align:left;">
79
</td>
<td style="text-align:left;">
feature79
</td>
</tr>
<tr>
<td style="text-align:left;">
80
</td>
<td style="text-align:left;">
feature80
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
81
</td>
<td style="text-align:left;">
feature81
</td>
</tr>
<tr>
<td style="text-align:left;">
82
</td>
<td style="text-align:left;">
feature82
</td>
</tr>
<tr>
<td style="text-align:left;">
83
</td>
<td style="text-align:left;">
feature83
</td>
</tr>
<tr>
<td style="text-align:left;">
84
</td>
<td style="text-align:left;">
feature84
</td>
</tr>
<tr>
<td style="text-align:left;">
85
</td>
<td style="text-align:left;">
feature85
</td>
</tr>
<tr>
<td style="text-align:left;">
86
</td>
<td style="text-align:left;">
feature86
</td>
</tr>
<tr>
<td style="text-align:left;">
87
</td>
<td style="text-align:left;">
feature87
</td>
</tr>
<tr>
<td style="text-align:left;">
88
</td>
<td style="text-align:left;">
feature88
</td>
</tr>
<tr>
<td style="text-align:left;">
89
</td>
<td style="text-align:left;">
feature89
</td>
</tr>
<tr>
<td style="text-align:left;">
90
</td>
<td style="text-align:left;">
feature90
</td>
</tr>
<tr>
<td style="text-align:left;">
91
</td>
<td style="text-align:left;">
feature91
</td>
</tr>
<tr>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;">
feature92
</td>
</tr>
<tr>
<td style="text-align:left;">
93
</td>
<td style="text-align:left;">
feature93
</td>
</tr>
<tr>
<td style="text-align:left;">
94
</td>
<td style="text-align:left;">
feature94
</td>
</tr>
<tr>
<td style="text-align:left;">
95
</td>
<td style="text-align:left;">
feature95
</td>
</tr>
<tr>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
feature96
</td>
</tr>
<tr>
<td style="text-align:left;">
97
</td>
<td style="text-align:left;">
feature97
</td>
</tr>
<tr>
<td style="text-align:left;">
98
</td>
<td style="text-align:left;">
feature98
</td>
</tr>
<tr>
<td style="text-align:left;">
99
</td>
<td style="text-align:left;">
feature99
</td>
</tr>
<tr>
<td style="text-align:left;">
100
</td>
<td style="text-align:left;">
feature100
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
101
</td>
<td style="text-align:left;">
feature101
</td>
</tr>
<tr>
<td style="text-align:left;">
102
</td>
<td style="text-align:left;">
feature102
</td>
</tr>
<tr>
<td style="text-align:left;">
103
</td>
<td style="text-align:left;">
feature103
</td>
</tr>
<tr>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;">
feature104
</td>
</tr>
<tr>
<td style="text-align:left;">
105
</td>
<td style="text-align:left;">
feature105
</td>
</tr>
<tr>
<td style="text-align:left;">
106
</td>
<td style="text-align:left;">
feature106
</td>
</tr>
<tr>
<td style="text-align:left;">
107
</td>
<td style="text-align:left;">
feature107
</td>
</tr>
<tr>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
feature108
</td>
</tr>
<tr>
<td style="text-align:left;">
109
</td>
<td style="text-align:left;">
feature109
</td>
</tr>
<tr>
<td style="text-align:left;">
110
</td>
<td style="text-align:left;">
feature110
</td>
</tr>
<tr>
<td style="text-align:left;">
111
</td>
<td style="text-align:left;">
feature111
</td>
</tr>
<tr>
<td style="text-align:left;">
112
</td>
<td style="text-align:left;">
feature112
</td>
</tr>
<tr>
<td style="text-align:left;">
113
</td>
<td style="text-align:left;">
feature113
</td>
</tr>
<tr>
<td style="text-align:left;">
114
</td>
<td style="text-align:left;">
feature114
</td>
</tr>
<tr>
<td style="text-align:left;">
115
</td>
<td style="text-align:left;">
feature115
</td>
</tr>
<tr>
<td style="text-align:left;">
116
</td>
<td style="text-align:left;">
feature116
</td>
</tr>
<tr>
<td style="text-align:left;">
117
</td>
<td style="text-align:left;">
feature117
</td>
</tr>
<tr>
<td style="text-align:left;">
118
</td>
<td style="text-align:left;">
feature118
</td>
</tr>
<tr>
<td style="text-align:left;">
119
</td>
<td style="text-align:left;">
feature119
</td>
</tr>
<tr>
<td style="text-align:left;">
120
</td>
<td style="text-align:left;">
feature120
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
121
</td>
<td style="text-align:left;">
feature121
</td>
</tr>
<tr>
<td style="text-align:left;">
122
</td>
<td style="text-align:left;">
feature122
</td>
</tr>
<tr>
<td style="text-align:left;">
123
</td>
<td style="text-align:left;">
feature123
</td>
</tr>
<tr>
<td style="text-align:left;">
124
</td>
<td style="text-align:left;">
feature124
</td>
</tr>
<tr>
<td style="text-align:left;">
125
</td>
<td style="text-align:left;">
feature125
</td>
</tr>
<tr>
<td style="text-align:left;">
126
</td>
<td style="text-align:left;">
feature126
</td>
</tr>
<tr>
<td style="text-align:left;">
127
</td>
<td style="text-align:left;">
feature127
</td>
</tr>
<tr>
<td style="text-align:left;">
128
</td>
<td style="text-align:left;">
feature128
</td>
</tr>
<tr>
<td style="text-align:left;">
129
</td>
<td style="text-align:left;">
feature129
</td>
</tr>
<tr>
<td style="text-align:left;">
130
</td>
<td style="text-align:left;">
feature130
</td>
</tr>
<tr>
<td style="text-align:left;">
131
</td>
<td style="text-align:left;">
feature131
</td>
</tr>
<tr>
<td style="text-align:left;">
132
</td>
<td style="text-align:left;">
feature132
</td>
</tr>
<tr>
<td style="text-align:left;">
133
</td>
<td style="text-align:left;">
feature133
</td>
</tr>
<tr>
<td style="text-align:left;">
134
</td>
<td style="text-align:left;">
feature134
</td>
</tr>
<tr>
<td style="text-align:left;">
135
</td>
<td style="text-align:left;">
feature135
</td>
</tr>
<tr>
<td style="text-align:left;">
136
</td>
<td style="text-align:left;">
feature136
</td>
</tr>
<tr>
<td style="text-align:left;">
137
</td>
<td style="text-align:left;">
feature137
</td>
</tr>
<tr>
<td style="text-align:left;">
138
</td>
<td style="text-align:left;">
feature138
</td>
</tr>
<tr>
<td style="text-align:left;">
139
</td>
<td style="text-align:left;">
feature139
</td>
</tr>
<tr>
<td style="text-align:left;">
140
</td>
<td style="text-align:left;">
feature140
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
141
</td>
<td style="text-align:left;">
feature141
</td>
</tr>
<tr>
<td style="text-align:left;">
142
</td>
<td style="text-align:left;">
feature142
</td>
</tr>
<tr>
<td style="text-align:left;">
143
</td>
<td style="text-align:left;">
feature143
</td>
</tr>
<tr>
<td style="text-align:left;">
144
</td>
<td style="text-align:left;">
feature144
</td>
</tr>
<tr>
<td style="text-align:left;">
145
</td>
<td style="text-align:left;">
feature145
</td>
</tr>
<tr>
<td style="text-align:left;">
146
</td>
<td style="text-align:left;">
feature146
</td>
</tr>
<tr>
<td style="text-align:left;">
147
</td>
<td style="text-align:left;">
feature147
</td>
</tr>
<tr>
<td style="text-align:left;">
148
</td>
<td style="text-align:left;">
feature148
</td>
</tr>
<tr>
<td style="text-align:left;">
149
</td>
<td style="text-align:left;">
feature149
</td>
</tr>
<tr>
<td style="text-align:left;">
150
</td>
<td style="text-align:left;">
feature150
</td>
</tr>
<tr>
<td style="text-align:left;">
151
</td>
<td style="text-align:left;">
feature151
</td>
</tr>
<tr>
<td style="text-align:left;">
152
</td>
<td style="text-align:left;">
feature152
</td>
</tr>
<tr>
<td style="text-align:left;">
153
</td>
<td style="text-align:left;">
feature153
</td>
</tr>
<tr>
<td style="text-align:left;">
154
</td>
<td style="text-align:left;">
feature154
</td>
</tr>
<tr>
<td style="text-align:left;">
155
</td>
<td style="text-align:left;">
feature155
</td>
</tr>
<tr>
<td style="text-align:left;">
156
</td>
<td style="text-align:left;">
feature156
</td>
</tr>
<tr>
<td style="text-align:left;">
157
</td>
<td style="text-align:left;">
feature157
</td>
</tr>
<tr>
<td style="text-align:left;">
158
</td>
<td style="text-align:left;">
feature158
</td>
</tr>
<tr>
<td style="text-align:left;">
159
</td>
<td style="text-align:left;">
feature159
</td>
</tr>
<tr>
<td style="text-align:left;">
160
</td>
<td style="text-align:left;">
feature160
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
161
</td>
<td style="text-align:left;">
feature161
</td>
</tr>
<tr>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
feature162
</td>
</tr>
<tr>
<td style="text-align:left;">
163
</td>
<td style="text-align:left;">
feature163
</td>
</tr>
<tr>
<td style="text-align:left;">
164
</td>
<td style="text-align:left;">
feature164
</td>
</tr>
<tr>
<td style="text-align:left;">
165
</td>
<td style="text-align:left;">
feature165
</td>
</tr>
<tr>
<td style="text-align:left;">
166
</td>
<td style="text-align:left;">
feature166
</td>
</tr>
<tr>
<td style="text-align:left;">
167
</td>
<td style="text-align:left;">
feature167
</td>
</tr>
<tr>
<td style="text-align:left;">
168
</td>
<td style="text-align:left;">
feature168
</td>
</tr>
<tr>
<td style="text-align:left;">
169
</td>
<td style="text-align:left;">
feature169
</td>
</tr>
<tr>
<td style="text-align:left;">
170
</td>
<td style="text-align:left;">
feature170
</td>
</tr>
<tr>
<td style="text-align:left;">
171
</td>
<td style="text-align:left;">
feature171
</td>
</tr>
<tr>
<td style="text-align:left;">
172
</td>
<td style="text-align:left;">
feature172
</td>
</tr>
<tr>
<td style="text-align:left;">
173
</td>
<td style="text-align:left;">
feature173
</td>
</tr>
<tr>
<td style="text-align:left;">
174
</td>
<td style="text-align:left;">
feature174
</td>
</tr>
<tr>
<td style="text-align:left;">
175
</td>
<td style="text-align:left;">
feature175
</td>
</tr>
<tr>
<td style="text-align:left;">
176
</td>
<td style="text-align:left;">
feature176
</td>
</tr>
<tr>
<td style="text-align:left;">
177
</td>
<td style="text-align:left;">
feature177
</td>
</tr>
<tr>
<td style="text-align:left;">
178
</td>
<td style="text-align:left;">
feature178
</td>
</tr>
<tr>
<td style="text-align:left;">
179
</td>
<td style="text-align:left;">
feature179
</td>
</tr>
<tr>
<td style="text-align:left;">
180
</td>
<td style="text-align:left;">
feature180
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
181
</td>
<td style="text-align:left;">
feature181
</td>
</tr>
<tr>
<td style="text-align:left;">
182
</td>
<td style="text-align:left;">
feature182
</td>
</tr>
<tr>
<td style="text-align:left;">
183
</td>
<td style="text-align:left;">
feature183
</td>
</tr>
<tr>
<td style="text-align:left;">
184
</td>
<td style="text-align:left;">
feature184
</td>
</tr>
<tr>
<td style="text-align:left;">
185
</td>
<td style="text-align:left;">
feature185
</td>
</tr>
<tr>
<td style="text-align:left;">
186
</td>
<td style="text-align:left;">
feature186
</td>
</tr>
<tr>
<td style="text-align:left;">
187
</td>
<td style="text-align:left;">
feature187
</td>
</tr>
<tr>
<td style="text-align:left;">
188
</td>
<td style="text-align:left;">
feature188
</td>
</tr>
<tr>
<td style="text-align:left;">
189
</td>
<td style="text-align:left;">
feature189
</td>
</tr>
<tr>
<td style="text-align:left;">
190
</td>
<td style="text-align:left;">
feature190
</td>
</tr>
<tr>
<td style="text-align:left;">
191
</td>
<td style="text-align:left;">
feature191
</td>
</tr>
<tr>
<td style="text-align:left;">
192
</td>
<td style="text-align:left;">
feature192
</td>
</tr>
<tr>
<td style="text-align:left;">
193
</td>
<td style="text-align:left;">
feature193
</td>
</tr>
<tr>
<td style="text-align:left;">
194
</td>
<td style="text-align:left;">
feature194
</td>
</tr>
<tr>
<td style="text-align:left;">
195
</td>
<td style="text-align:left;">
feature195
</td>
</tr>
<tr>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
feature196
</td>
</tr>
<tr>
<td style="text-align:left;">
197
</td>
<td style="text-align:left;">
feature197
</td>
</tr>
<tr>
<td style="text-align:left;">
198
</td>
<td style="text-align:left;">
feature198
</td>
</tr>
<tr>
<td style="text-align:left;">
199
</td>
<td style="text-align:left;">
feature199
</td>
</tr>
<tr>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
feature200
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
201
</td>
<td style="text-align:left;">
feature201
</td>
</tr>
<tr>
<td style="text-align:left;">
202
</td>
<td style="text-align:left;">
feature202
</td>
</tr>
<tr>
<td style="text-align:left;">
203
</td>
<td style="text-align:left;">
feature203
</td>
</tr>
<tr>
<td style="text-align:left;">
204
</td>
<td style="text-align:left;">
feature204
</td>
</tr>
<tr>
<td style="text-align:left;">
205
</td>
<td style="text-align:left;">
feature205
</td>
</tr>
<tr>
<td style="text-align:left;">
206
</td>
<td style="text-align:left;">
feature206
</td>
</tr>
<tr>
<td style="text-align:left;">
207
</td>
<td style="text-align:left;">
feature207
</td>
</tr>
<tr>
<td style="text-align:left;">
208
</td>
<td style="text-align:left;">
feature208
</td>
</tr>
<tr>
<td style="text-align:left;">
209
</td>
<td style="text-align:left;">
feature209
</td>
</tr>
<tr>
<td style="text-align:left;">
210
</td>
<td style="text-align:left;">
feature210
</td>
</tr>
<tr>
<td style="text-align:left;">
211
</td>
<td style="text-align:left;">
feature211
</td>
</tr>
<tr>
<td style="text-align:left;">
212
</td>
<td style="text-align:left;">
feature212
</td>
</tr>
<tr>
<td style="text-align:left;">
213
</td>
<td style="text-align:left;">
feature213
</td>
</tr>
<tr>
<td style="text-align:left;">
214
</td>
<td style="text-align:left;">
feature214
</td>
</tr>
<tr>
<td style="text-align:left;">
215
</td>
<td style="text-align:left;">
feature215
</td>
</tr>
<tr>
<td style="text-align:left;">
216
</td>
<td style="text-align:left;">
feature216
</td>
</tr>
<tr>
<td style="text-align:left;">
217
</td>
<td style="text-align:left;">
feature217
</td>
</tr>
<tr>
<td style="text-align:left;">
218
</td>
<td style="text-align:left;">
feature218
</td>
</tr>
<tr>
<td style="text-align:left;">
219
</td>
<td style="text-align:left;">
feature219
</td>
</tr>
<tr>
<td style="text-align:left;">
220
</td>
<td style="text-align:left;">
feature220
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
221
</td>
<td style="text-align:left;">
feature221
</td>
</tr>
<tr>
<td style="text-align:left;">
222
</td>
<td style="text-align:left;">
feature222
</td>
</tr>
<tr>
<td style="text-align:left;">
223
</td>
<td style="text-align:left;">
feature223
</td>
</tr>
<tr>
<td style="text-align:left;">
224
</td>
<td style="text-align:left;">
feature224
</td>
</tr>
<tr>
<td style="text-align:left;">
225
</td>
<td style="text-align:left;">
feature225
</td>
</tr>
<tr>
<td style="text-align:left;">
226
</td>
<td style="text-align:left;">
feature226
</td>
</tr>
<tr>
<td style="text-align:left;">
227
</td>
<td style="text-align:left;">
feature227
</td>
</tr>
<tr>
<td style="text-align:left;">
228
</td>
<td style="text-align:left;">
feature228
</td>
</tr>
<tr>
<td style="text-align:left;">
229
</td>
<td style="text-align:left;">
feature229
</td>
</tr>
<tr>
<td style="text-align:left;">
230
</td>
<td style="text-align:left;">
feature230
</td>
</tr>
<tr>
<td style="text-align:left;">
231
</td>
<td style="text-align:left;">
feature231
</td>
</tr>
<tr>
<td style="text-align:left;">
232
</td>
<td style="text-align:left;">
feature232
</td>
</tr>
<tr>
<td style="text-align:left;">
233
</td>
<td style="text-align:left;">
feature233
</td>
</tr>
<tr>
<td style="text-align:left;">
234
</td>
<td style="text-align:left;">
feature234
</td>
</tr>
<tr>
<td style="text-align:left;">
235
</td>
<td style="text-align:left;">
feature235
</td>
</tr>
<tr>
<td style="text-align:left;">
236
</td>
<td style="text-align:left;">
feature236
</td>
</tr>
<tr>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
feature237
</td>
</tr>
<tr>
<td style="text-align:left;">
238
</td>
<td style="text-align:left;">
feature238
</td>
</tr>
<tr>
<td style="text-align:left;">
239
</td>
<td style="text-align:left;">
feature239
</td>
</tr>
<tr>
<td style="text-align:left;">
240
</td>
<td style="text-align:left;">
feature240
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
241
</td>
<td style="text-align:left;">
feature241
</td>
</tr>
<tr>
<td style="text-align:left;">
242
</td>
<td style="text-align:left;">
feature242
</td>
</tr>
<tr>
<td style="text-align:left;">
243
</td>
<td style="text-align:left;">
feature243
</td>
</tr>
<tr>
<td style="text-align:left;">
244
</td>
<td style="text-align:left;">
feature244
</td>
</tr>
<tr>
<td style="text-align:left;">
245
</td>
<td style="text-align:left;">
feature245
</td>
</tr>
<tr>
<td style="text-align:left;">
246
</td>
<td style="text-align:left;">
feature246
</td>
</tr>
<tr>
<td style="text-align:left;">
247
</td>
<td style="text-align:left;">
feature247
</td>
</tr>
<tr>
<td style="text-align:left;">
248
</td>
<td style="text-align:left;">
feature248
</td>
</tr>
<tr>
<td style="text-align:left;">
249
</td>
<td style="text-align:left;">
feature249
</td>
</tr>
<tr>
<td style="text-align:left;">
250
</td>
<td style="text-align:left;">
feature250
</td>
</tr>
<tr>
<td style="text-align:left;">
251
</td>
<td style="text-align:left;">
feature251
</td>
</tr>
<tr>
<td style="text-align:left;">
252
</td>
<td style="text-align:left;">
feature252
</td>
</tr>
<tr>
<td style="text-align:left;">
253
</td>
<td style="text-align:left;">
feature253
</td>
</tr>
<tr>
<td style="text-align:left;">
254
</td>
<td style="text-align:left;">
feature254
</td>
</tr>
<tr>
<td style="text-align:left;">
255
</td>
<td style="text-align:left;">
feature255
</td>
</tr>
<tr>
<td style="text-align:left;">
256
</td>
<td style="text-align:left;">
feature256
</td>
</tr>
<tr>
<td style="text-align:left;">
257
</td>
<td style="text-align:left;">
feature257
</td>
</tr>
<tr>
<td style="text-align:left;">
258
</td>
<td style="text-align:left;">
feature258
</td>
</tr>
<tr>
<td style="text-align:left;">
259
</td>
<td style="text-align:left;">
feature259
</td>
</tr>
<tr>
<td style="text-align:left;">
260
</td>
<td style="text-align:left;">
feature260
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
features
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
261
</td>
<td style="text-align:left;">
class
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>There are 260 “<strong><em>features</em></strong>” in the train data along with a <strong>class</strong> variable which is excluded from the testing data. With ~253 trading days in a year the <strong>feature1</strong>, <strong>feature2</strong>, … <strong>featureN</strong> were daily time series. From my initial observation (and plots) I believed this data to be “<strong>returns</strong>” data. I firstly clean a little the data since time series does not do so well with <strong>feature1</strong>, <strong>feature2</strong>, … <strong>featureN</strong> as its input. I chose a year at random and renamed the columns with the function <code>getTradingDates</code> (there is always an R package for everything…).</p>
<pre class="r"><code>######################################################################
################# Clean the data #####################################

# Since the &quot;features&quot; are daily time series, I just choose a random year and rename the feautres into more meaningful names
# Such as &quot;2010-01-01&quot;, &quot;2010-01-02&quot;, &quot;2010-01-03&quot; instead of &quot;feature1&quot;, &quot;feature2&quot;, &quot;feature3&quot; etc.
# Theres a &quot;trading dates&quot; package in R to get only the dates which are trading dates.
colnames(train_val) &lt;- getTradingDates(&#39;2010-01-01&#39;, obs = 260)
colnames(train_val)[ncol(train_val)] &lt;- &quot;class&quot;
colnames(test) &lt;- getTradingDates(&#39;2010-01-01&#39;, obs = 260)
test$dataset &lt;- &quot;test&quot;
train_val$dataset &lt;- &quot;train&quot;</code></pre>
<p>Here (if I were to do things differently) I would keep to <code>tidy</code> data principles and use <code>test %&gt;% add_column(dataset = "test)</code> and <code>train %&gt;% add_colum(dataset = "train")</code> instead of <code>test$dataset &lt;- "test</code> and <code>train_val$dataset &lt;- "train"</code>. But that doesn’t matter much.</p>
</div>
<div id="how-the-training-data-looks" class="section level3">
<h3>How the training data looks:</h3>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-5">Table 2: </span>How the training set looks now (cleaned)
</caption>
<thead>
<tr>
<th style="text-align:right;">
2009-01-05
</th>
<th style="text-align:right;">
2009-01-06
</th>
<th style="text-align:right;">
2009-01-07
</th>
<th style="text-align:right;">
2009-01-08
</th>
<th style="text-align:right;">
2009-01-09
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0062865
</td>
<td style="text-align:right;">
0.0044074
</td>
<td style="text-align:right;">
-0.0380887
</td>
<td style="text-align:right;">
0.0252850
</td>
<td style="text-align:right;">
-0.0065788
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0008491
</td>
<td style="text-align:right;">
0.0025729
</td>
<td style="text-align:right;">
0.0013584
</td>
<td style="text-align:right;">
-0.0054742
</td>
<td style="text-align:right;">
-0.0098234
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0142292
</td>
<td style="text-align:right;">
-0.0252533
</td>
<td style="text-align:right;">
-0.0100752
</td>
<td style="text-align:right;">
-0.0319871
</td>
<td style="text-align:right;">
-0.0065087
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0215930
</td>
<td style="text-align:right;">
-0.0102866
</td>
<td style="text-align:right;">
-0.0210674
</td>
<td style="text-align:right;">
-0.0086876
</td>
<td style="text-align:right;">
0.0371876
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0092523
</td>
<td style="text-align:right;">
-0.0235778
</td>
<td style="text-align:right;">
0.0170582
</td>
<td style="text-align:right;">
0.0037303
</td>
<td style="text-align:right;">
0.0171185
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0143528
</td>
<td style="text-align:right;">
0.0094828
</td>
<td style="text-align:right;">
0.0042109
</td>
<td style="text-align:right;">
-0.0038064
</td>
<td style="text-align:right;">
0.0084914
</td>
</tr>
</tbody>
</table>
</div>
<div id="how-the-testing-data-looks" class="section level3">
<h3>How the testing data looks:</h3>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-6">Table 3: </span>How the testing data looks (cleaned)
</caption>
<thead>
<tr>
<th style="text-align:right;">
2009-01-05
</th>
<th style="text-align:right;">
2009-01-06
</th>
<th style="text-align:right;">
2009-01-07
</th>
<th style="text-align:right;">
2009-01-08
</th>
<th style="text-align:right;">
2009-01-09
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0331039
</td>
<td style="text-align:right;">
0.0086225
</td>
<td style="text-align:right;">
0.0040622
</td>
<td style="text-align:right;">
0.0082554
</td>
<td style="text-align:right;">
0.0558741
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0020681
</td>
<td style="text-align:right;">
-0.0034293
</td>
<td style="text-align:right;">
0.0134305
</td>
<td style="text-align:right;">
-0.0109182
</td>
<td style="text-align:right;">
-0.0184851
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0147834
</td>
<td style="text-align:right;">
-0.0113800
</td>
<td style="text-align:right;">
-0.0046055
</td>
<td style="text-align:right;">
-0.0008757
</td>
<td style="text-align:right;">
-0.0011536
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0094855
</td>
<td style="text-align:right;">
0.0113410
</td>
<td style="text-align:right;">
-0.0213286
</td>
<td style="text-align:right;">
0.0033220
</td>
<td style="text-align:right;">
-0.0111519
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0381690
</td>
<td style="text-align:right;">
-0.0037092
</td>
<td style="text-align:right;">
-0.0010865
</td>
<td style="text-align:right;">
-0.0062307
</td>
<td style="text-align:right;">
0.0232117
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0004257
</td>
<td style="text-align:right;">
-0.0042553
</td>
<td style="text-align:right;">
0.0029915
</td>
<td style="text-align:right;">
0.0017043
</td>
<td style="text-align:right;">
0.0012760
</td>
</tr>
</tbody>
</table>
<p><strong>The goal</strong>: Was to classify which financial time series was <em>real</em> vs which was <em>synthetically created</em> (by some algorithm I have no knowledge of how it generated the synthetic time series)</p>
<p>I re-arranged the data using the <code>melt</code> function in R, however I suggest anybody reading this to use the <code>pivol_longer</code> function from the <code>tidyverse</code> packages. The <code>pivot_longer</code> package was released a few weeks after writing the code for this problem.</p>
<pre class="r"><code>######################################################################
################# Rearrange the data #################################

# I melt the data for easier analysis, now the data is in a long format.

# &quot;Class&quot; corresponds to whether the asset is Synthetic or Real
# &quot;Dataset&quot; tells me where the data came from
# &quot;row_id&quot; - corresponds to a unique ID assigned to each asset both &quot;(Synthetic &amp; Real)&quot;
# &quot;Variable&quot; is the column names of the original dataset (feature1, feature2, ... , featureN) converted to some date
# &quot;Value&quot; is the daily returns

df &lt;- train_val %&gt;%
  mutate(row_id = row_number()) %&gt;%
  melt(., measure.vars = 1:260) %&gt;%
  arrange(row_id)

head(df)</code></pre>
<pre><code>##   class dataset row_id   variable        value
## 1     0   train      1 2009-01-05  0.006286455
## 2     0   train      1 2009-01-06  0.004407363
## 3     0   train      1 2009-01-07 -0.038088652
## 4     0   train      1 2009-01-08  0.025285012
## 5     0   train      1 2009-01-09 -0.006578773
## 6     0   train      1 2009-01-12  0.005713677</code></pre>
<pre class="r"><code>dim(df)</code></pre>
<pre><code>## [1] 3120000       5</code></pre>
<p><strong>Note:</strong> I call the training data <code>df</code> which in hindsight is probably bad practice and it should be called something related to the <code>train_Val</code> named data set. Just keep in mind that <code>df</code> refers to the <code>train_Val</code> data set. (and does not include the <code>test.csv</code> data set data)</p>
<p>As we can see the data has 3,120,000 rows which is 12,000 assets * 260 trading days. Next I plot the returns series using <code>ggplot</code>.</p>
<pre class="r"><code># Plot some returns - I only plot a random sample of 20 assets for each Synthetic vs Real.

ret_plot0 &lt;- df %&gt;%
  filter(class == 0) %&gt;%
  group_by(row_id) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;% 
  sample_n(20) %&gt;%
  unnest() %&gt;% 
  ggplot(aes(x = variable, y = value)) +
  geom_line(aes(group = factor(row_id), color = factor(row_id))) +
  ggtitle(&quot;Synthetic Financial Time Series&quot;) +
  theme_classic() +
  theme(axis.text.x = element_blank(), legend.position = &quot;bottom&quot;, legend.title = element_blank())


ret_plot1 &lt;- df %&gt;%
  filter(class == 1) %&gt;%
  group_by(row_id) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;%
  sample_n(20) %&gt;%
  unnest() %&gt;%
  ggplot(aes(x = variable, y = value)) +
  geom_line(aes(group = factor(row_id), color = factor(row_id))) +
  ggtitle(&quot;Real Financial Time Series&quot;) +
  theme_classic() +
  theme(axis.text.x = element_blank(), legend.position = &quot;bottom&quot;, legend.title = element_blank())

plot_grid(ret_plot0, ret_plot1)</code></pre>
<p><img src="/post/synth-real-time-series/synth_real_time_series_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Next I plot boxplots for the Average returns and secondly the standard deviations.</p>
<pre class="r"><code>ave_box &lt;- df %&gt;%
  group_by(class, row_id) %&gt;%
  summarise(mean = mean(value)) %&gt;%
  ggplot(aes(x = factor(class), y = mean, color = factor(class))) +
  geom_boxplot(show.legend = FALSE) +
  ggtitle(&quot;Syn vs Real Average Returns&quot;) +
  xlab(&quot;Class&quot;) +
  ylab(&quot;Average Returns&quot;) +
  theme_tq()

sd_box &lt;- df %&gt;%
  group_by(class, row_id) %&gt;%
  summarise(sd = sd(value)) %&gt;%
  ggplot(aes(x = factor(class), y = sd, color = factor(class))) +
  geom_boxplot(show.legend = FALSE) +
  ggtitle(&quot;Syn vs Real Standard Deviations&quot;) +
  xlab(&quot;Class&quot;) +
  ylab(&quot;Standard Deviation&quot;) +
  theme_tq()

plot_grid(ave_box, sd_box)</code></pre>
<p><img src="/post/synth-real-time-series/synth_real_time_series_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>I next calculate the Durbin-Watson statistic. I mostly code using R’s <em>tidy</em> data principles and therefore use the <code>tidy</code> function from the <code>broom</code> package to tidy the output of the DW statistic up a little. I do this for both the synthetic time series and real time series.</p>
<pre class="r"><code># I calculate the Durbin-Watson statistic and use the &quot;tidy()&quot; function to summarise the key information from the calculation.

dw_test_class_zero &lt;- df %&gt;%
  dplyr::filter(class == 0) %&gt;%
  nest(-row_id) %&gt;%
  mutate(dw_res = map(data, ~ broom::tidy(lmtest::dwtest(value ~ 1, data = .x)))) %&gt;%
  unnest(dw_res) %&gt;%
  mutate(class = &quot;0&quot;)



dw_test_class_zero %&gt;% 
  head()</code></pre>
<pre><code>## # A tibble: 6 x 7
##   row_id         data statistic p.value method      alternative            class
##    &lt;int&gt; &lt;list&lt;df[,4&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;                  &lt;chr&gt;
## 1      1    [260 x 4]      1.98   0.426 Durbin-Wat~ true autocorrelation ~ 0    
## 2      2    [260 x 4]      2.01   0.521 Durbin-Wat~ true autocorrelation ~ 0    
## 3      4    [260 x 4]      2.08   0.747 Durbin-Wat~ true autocorrelation ~ 0    
## 4      5    [260 x 4]      2.49   1.000 Durbin-Wat~ true autocorrelation ~ 0    
## 5      6    [260 x 4]      1.90   0.214 Durbin-Wat~ true autocorrelation ~ 0    
## 6      9    [260 x 4]      1.87   0.138 Durbin-Wat~ true autocorrelation ~ 0</code></pre>
<pre class="r"><code># Here I do the exact same thing as above but this time for the class == 1 data.

dw_test_class_one &lt;- df %&gt;%
  filter(class == 1) %&gt;%
  nest(-row_id) %&gt;%
  mutate(dw_res = map(data, ~ broom::tidy(lmtest::dwtest(value ~ 1, data = .x)))) %&gt;%
  unnest(dw_res) %&gt;%
  mutate(class = &quot;1&quot;)

dw_test_class_one %&gt;%
  head()</code></pre>
<pre><code>## # A tibble: 6 x 7
##   row_id         data statistic p.value method      alternative            class
##    &lt;int&gt; &lt;list&lt;df[,4&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;                  &lt;chr&gt;
## 1      3    [260 x 4]      2.08  0.728  Durbin-Wat~ true autocorrelation ~ 1    
## 2      7    [260 x 4]      1.81  0.0654 Durbin-Wat~ true autocorrelation ~ 1    
## 3      8    [260 x 4]      1.93  0.296  Durbin-Wat~ true autocorrelation ~ 1    
## 4     13    [260 x 4]      2.05  0.644  Durbin-Wat~ true autocorrelation ~ 1    
## 5     15    [260 x 4]      2.07  0.715  Durbin-Wat~ true autocorrelation ~ 1    
## 6     16    [260 x 4]      2.07  0.709  Durbin-Wat~ true autocorrelation ~ 1</code></pre>
<p>Next I plot the boxplot statistics for each of the Durbin Watson tests.</p>
<pre class="r"><code># I bind the rows together and plot a box-plot.

bind_rows(dw_test_class_zero, dw_test_class_one) %&gt;%
  group_by(class) %&gt;%
  ggplot(aes(x = factor(class), y = statistic, color = factor(class))) +
  geom_boxplot(show.legend = FALSE) +
  ggtitle(&quot;Durbin Watson Box Plot Statistics&quot;) +
  xlab(&quot;Class&quot;) +
  ylab(&quot;Durbin Watson&quot;) +
  theme_tq()</code></pre>
<p><img src="/post/synth-real-time-series/synth_real_time_series_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>I compute the 10 day rolling mean and standard deviation using the <code>tq_mutate</code> function from the <code>tidyquant</code> package. <code>value</code> corresponds to the returns of the financial time series and is plotted in blue with the 10 day rolling average and standard deviation plotted over the returns. (I use <code>melt</code> again here but look into the <code>pivot_longer</code> function for a more intuitive application)</p>
<pre class="r"><code># Rolling mean and standard deviations
# I only use a random sample of 1 of each class of the grouped observations to save on memory and to make the plot more readable.
# The rollowing window is 10 days
# I use the tq_mutate functionality from the &quot;tidyquant&quot; package to keep things in a &quot;tidy&quot; format as per the &quot;tidyverse&quot; &#39;rules&#39;.
# In the plot &quot;value&quot; is the returns, &quot;mean_10&quot; is the 10 day rolling mean and &quot;sd_10&quot; is the 10 day rolling standard deviation.

plot0 &lt;- df %&gt;%
  filter(class == 0) %&gt;%
  as_tibble() %&gt;%
  group_by(row_id) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;% 
  sample_n(1) %&gt;%
  unnest() %&gt;%
  mutate(variable = as.Date(variable)) %&gt;%
  tq_mutate(
    select     = value,
    mutate_fun = rollapply,
    width      = 10,
    align      = &quot;right&quot;,
    FUN        = mean,
    na.rm      = TRUE,
    col_rename = &quot;mean_10&quot;
    ) %&gt;%
  tq_mutate(
    select     = value,
    mutate_fun = rollapply,
    width      = 10,
    align      = &quot;right&quot;,
    FUN        = sd,
    na.rm      = TRUE,
    col_rename = &quot;sd_10&quot;
    ) %&gt;%
  melt(measure.vars = 5:7) %&gt;%
  setNames(c(&quot;row_id&quot;, &quot;class&quot;, &quot;data set&quot;, &quot;date&quot;, &quot;variable&quot;, &quot;value&quot;)) %&gt;%
  ggplot(aes(x = date)) +
  geom_line(aes(y = value, colour = variable)) +
  ggtitle(&quot;Synthetic Financial Time Series Rolling Mean and Standard Deviation&quot;) +
  theme_classic() +
  scale_colour_manual(values = c(&quot;#1f77b4&quot;, &quot;red&quot;, &quot;black&quot;)) +
  theme(axis.text.x = element_blank(), legend.position = &quot;bottom&quot;, legend.title = element_blank())

plot1 &lt;- df %&gt;%
  filter(class == 1) %&gt;%
  as_tibble() %&gt;%
  group_by(row_id) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;% 
  sample_n(1) %&gt;%
  unnest() %&gt;%
  mutate(variable = as.Date(variable)) %&gt;%
  tq_mutate(
    select     = value,
    mutate_fun = rollapply,
    width      = 10,
    align      = &quot;right&quot;,
    FUN        = mean,
    na.rm      = TRUE,
    col_rename = &quot;mean_10&quot;
  ) %&gt;%
  tq_mutate(
    select     = value,
    mutate_fun = rollapply,
    width      = 10,
    align      = &quot;right&quot;,
    FUN        = sd,
    na.rm      = TRUE,
    col_rename = &quot;sd_10&quot;
  ) %&gt;%
  melt(measure.vars = 5:7) %&gt;%
  setNames(c(&quot;row_id&quot;, &quot;class&quot;, &quot;data set&quot;, &quot;date&quot;, &quot;variable&quot;, &quot;value&quot;)) %&gt;%
  ggplot(aes(x = date)) +
  geom_line(aes(y = value, colour = variable)) +
  ggtitle(&quot;Real Financial Time Series Rolling Mean and Standard Deviation&quot;) +
  theme_classic() +
  scale_colour_manual(values = c(&quot;#1f77b4&quot;, &quot;red&quot;, &quot;black&quot;)) +
  theme(axis.text.x = element_blank(), legend.position = &quot;bottom&quot;, legend.title = element_blank())  

plot_grid(plot0, plot1)</code></pre>
<p><img src="/post/synth-real-time-series/synth_real_time_series_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>An important note in the code here is that I randomly sample by <em>group</em>, that is, I do not take a random sample from all observations across all groups. Instead I <code>group_by</code> each time series (each of the 6,000 observations after I filtered by the <code>class == 0</code>, likewise when I filter by the <code>class == 1</code>), I then <code>nest()</code> the data to collapse the daily time series for each asset into a <code>list</code>. From here I will have 6,000 observations, each of which has their time series nested inside a list. Thus, I can sample 1 of the 6,000 observations and then <code>unnest()</code> and obtain a full time series set of one of the random assets selected, - instead of sampling randomly over all assets time series data (which would be completely wrong).</p>
<p>For example the following commented out code <code>group_by()</code> the ID variable and <code>nest()</code> the data, takes a random <code>sample_n()</code> of the grouped data and then <code>unnest()</code> the data to its original form, this time with a sample of the IDs.</p>
<pre class="r"><code>#  group_by(row_id) %&gt;%
#  nest() %&gt;%
#  ungroup() %&gt;% 
#  sample_n(1) %&gt;%
#  unnest() %&gt;%</code></pre>
<p>Next I compute the Dickey Fuller test on both series for a single random observation (it’s too computationally expensive to compute it on all 12,000 observations).</p>
<p>For the synthetically created series.</p>
<pre class="r"><code># Dickey Fuller test on the 0 class
# I only randomly sample 1 of the assets for the 0 class to save on output space

df %&gt;%
  filter(class == 0) %&gt;%
  group_by(row_id) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;% 
  sample_n(1) %&gt;%
  unnest() %&gt;%
  nest(-row_id) %&gt;%
  mutate(adf_res = map(data, ~ adf.test(.x$value))) %&gt;%
  unnest(adf_res)</code></pre>
<pre><code>## Augmented Dickey-Fuller Test 
## alternative: stationary 
##  
## Type 1: no drift no trend 
##      lag    ADF p.value
## [1,]   0 -14.49    0.01
## [2,]   1 -10.43    0.01
## [3,]   2  -8.98    0.01
## [4,]   3  -8.38    0.01
## [5,]   4  -7.96    0.01
## Type 2: with drift no trend 
##      lag    ADF p.value
## [1,]   0 -14.48    0.01
## [2,]   1 -10.42    0.01
## [3,]   2  -8.98    0.01
## [4,]   3  -8.37    0.01
## [5,]   4  -7.95    0.01
## Type 3: with drift and trend 
##      lag    ADF p.value
## [1,]   0 -14.49    0.01
## [2,]   1 -10.44    0.01
## [3,]   2  -9.00    0.01
## [4,]   3  -8.39    0.01
## [5,]   4  -7.95    0.01
## ---- 
## Note: in fact, p.value = 0.01 means p.value &lt;= 0.01</code></pre>
<pre><code>## # A tibble: 3 x 3
##   row_id           data adf_res          
##    &lt;int&gt; &lt;list&lt;df[,4]&gt;&gt; &lt;named list&gt;     
## 1   2351      [260 x 4] &lt;dbl[,3] [5 x 3]&gt;
## 2   2351      [260 x 4] &lt;dbl[,3] [5 x 3]&gt;
## 3   2351      [260 x 4] &lt;dbl[,3] [5 x 3]&gt;</code></pre>
<p>The same but on the real financial series.</p>
<pre class="r"><code># Dickey Fuller test on the 1 class
# I only randomly sample 1 of the assets for the 1 class to save on output space

df %&gt;%
  filter(class == 1) %&gt;%
  group_by(row_id) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;% 
  sample_n(1) %&gt;%
  unnest() %&gt;%
  nest(-row_id) %&gt;%
  mutate(adf_res = map(data, ~ adf.test(.x$value))) %&gt;%
  unnest(adf_res)</code></pre>
<pre><code>## Augmented Dickey-Fuller Test 
## alternative: stationary 
##  
## Type 1: no drift no trend 
##      lag    ADF p.value
## [1,]   0 -17.30    0.01
## [2,]   1 -13.89    0.01
## [3,]   2  -9.82    0.01
## [4,]   3  -7.71    0.01
## [5,]   4  -6.99    0.01
## Type 2: with drift no trend 
##      lag    ADF p.value
## [1,]   0 -17.27    0.01
## [2,]   1 -13.87    0.01
## [3,]   2  -9.80    0.01
## [4,]   3  -7.69    0.01
## [5,]   4  -6.98    0.01
## Type 3: with drift and trend 
##      lag    ADF p.value
## [1,]   0 -17.25    0.01
## [2,]   1 -13.85    0.01
## [3,]   2  -9.79    0.01
## [4,]   3  -7.69    0.01
## [5,]   4  -6.97    0.01
## ---- 
## Note: in fact, p.value = 0.01 means p.value &lt;= 0.01</code></pre>
<pre><code>## # A tibble: 3 x 3
##   row_id           data adf_res          
##    &lt;int&gt; &lt;list&lt;df[,4]&gt;&gt; &lt;named list&gt;     
## 1   4622      [260 x 4] &lt;dbl[,3] [5 x 3]&gt;
## 2   4622      [260 x 4] &lt;dbl[,3] [5 x 3]&gt;
## 3   4622      [260 x 4] &lt;dbl[,3] [5 x 3]&gt;</code></pre>
<p>Next the Jarque-Bera tests for normality. Firstly on the synthetically created series.</p>
<pre class="r"><code># For both classes I take a random sample of 1 observation from each class (Synthetic and Real financial series)

jb_zero &lt;- df %&gt;%
  filter(class == 0) %&gt;%
  group_by(row_id) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;% 
  sample_n(1) %&gt;%
  unnest() %&gt;%
  nest(-row_id) %&gt;%
  mutate(JarqueBeraTest = map(data, ~ JarqueBera.test(.x$value)))

print(&quot;Jarque-Bera Test on the 0 - Synthetic class&quot;)</code></pre>
<pre><code>## [1] &quot;Jarque-Bera Test on the 0 - Synthetic class&quot;</code></pre>
<pre class="r"><code>jb_zero$JarqueBeraTest</code></pre>
<pre><code>## [[1]]
## 
##  Jarque Bera Test
## 
## data:  .x$value
## X-squared = 31.099, df = 2, p-value = 0.0000001766
## 
## 
##  Skewness
## 
## data:  .x$value
## statistic = 0.4279, p-value = 0.004851
## 
## 
##  Kurtosis
## 
## data:  .x$value
## statistic = 4.4623, p-value = 0.000001487</code></pre>
<p>Also on the real financial series.</p>
<pre class="r"><code>jb_one &lt;- df %&gt;%
  filter(class == 0) %&gt;%
  group_by(row_id) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;% 
  sample_n(1) %&gt;%
  unnest() %&gt;%
  nest(-row_id) %&gt;%
  mutate(JarqueBeraTest = map(data, ~ JarqueBera.test(.x$value)))

print(&quot;Jarque-Bera Test on the 1 - Real class&quot;)</code></pre>
<pre><code>## [1] &quot;Jarque-Bera Test on the 1 - Real class&quot;</code></pre>
<pre class="r"><code>jb_one$JarqueBeraTest</code></pre>
<pre><code>## [[1]]
## 
##  Jarque Bera Test
## 
## data:  .x$value
## X-squared = 34.104, df = 2, p-value = 0.00000003931
## 
## 
##  Skewness
## 
## data:  .x$value
## statistic = 0.009521, p-value = 0.95
## 
## 
##  Kurtosis
## 
## data:  .x$value
## statistic = 4.7742, p-value = 0.000000005236</code></pre>
</div>
<div id="autocorrelation-plots" class="section level3">
<h3>Autocorrelation plots:</h3>
<p>I plot the Autocorrelation Function for a “random” sample of observations time series. I selected 4 observations and filtered the data by them.</p>
<pre class="r"><code>######################################################################
################# ACF plots ##########################################

# I only use 4 observations for these plots, 2 from the &quot;synthetic&quot; class and 2 from the &quot;real&quot; class.

df %&gt;%
  filter(row_id == 6422 | row_id == 8967 | row_id == 6080 | row_id ==   5734) %&gt;%
  mutate(date = as.Date(variable)) %&gt;%
  ggplot(aes(x = date)) +
  geom_line(aes(y = value), color = &quot;red&quot;, alpha = 0.4) +
  geom_hline(yintercept = 0) +
  facet_wrap(~ row_id + class) +
  theme_tq()</code></pre>
<p><img src="/post/synth-real-time-series/synth_real_time_series_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code>acf_data &lt;- df %&gt;%
  dplyr::filter(row_id == 6422 | row_id == 8967 | row_id == 6080 | row_id ==    5734) %&gt;%
  mutate(date = as.Date(variable))

df_acf &lt;- acf_data %&gt;%
  group_by(row_id) %&gt;% 
  summarise(list_acf = list(acf(value, plot=FALSE))) %&gt;%
  mutate(acf_vals = purrr::map(list_acf, ~as.numeric(.x$acf))) %&gt;% 
  select(-list_acf) %&gt;% 
  unnest() %&gt;% 
  group_by(row_id) %&gt;% 
  mutate(lag = row_number() - 1)

df_ci &lt;- acf_data %&gt;% 
  group_by(row_id) %&gt;% 
  summarise(ci = qnorm((1 + 0.95)/2)/sqrt(n()))

ggplot(df_acf, aes(x = lag, y = acf_vals)) +
  geom_bar(stat=&quot;identity&quot;, width=.05) +
  geom_hline(yintercept = 0) +
  geom_hline(data = df_ci, aes(yintercept = -ci), color=&quot;blue&quot;, linetype=&quot;dotted&quot;) +
  geom_hline(data = df_ci, aes(yintercept = ci), color=&quot;blue&quot;, linetype=&quot;dotted&quot;) +
  labs(x=&quot;Lag&quot;, y=&quot;ACF&quot;) +
  facet_wrap(~ row_id) +
  theme_tq()</code></pre>
<p><img src="/post/synth-real-time-series/synth_real_time_series_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<p>Thats enough data analysis I could probably fit the PACF plots also along with a few more exploratory data analysis but I move on to generating the financial time series features using the <code>tsfeatures</code> package.</p>
<p>What I do in the below code is to take a random sample of 5 groups (Using the whole data set takes too long to calculate the time series features) and then apply all the functions in the <code>tsfeatures</code> package to each of the time series assets data which is does by mapping over each assets data and computing the time series features.</p>
<p>This section takes some time to process and compute (especially on the whole sample) and I already saved the results as a csv which I will just work from and load in the pre-computed time series features.</p>
<pre class="r"><code>################# Generate Time Series Features ######################

# I create some time series features from the package &quot;tsfeatures&quot;. There are 40+ functions in the &quot;tsfeatures&quot; package
# which can generate approximately 106 time series features.
# Due to memory issues I am only able to create a few of the features, therefore I randomly sample 10 features from the
# &quot;tsfeatures&quot; package. We could also add in technical indicators from the &quot;PerformanceAnalytics&quot; or &quot;TTR&quot; packages (I omit these
# here, however creating &#39;functions2 &lt;- ls(&quot;package:TTR&quot;)&#39; and adding it to the &#39;summarise&#39; command will work.)

functions &lt;- ls(&quot;package:tsfeatures&quot;)[1:42]
# functions &lt;- sample(functions, 20)

Stats &lt;- df %&gt;%
  group_by(row_id, class) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;%
  sample_n(5) %&gt;%
  unnest() %&gt;%
  nest(-row_id, -class) %&gt;%
  group_by(row_id, class) %T&gt;%
  {options(warn = -1)} %&gt;%
  summarise(Statistics = map(data, ~ data.frame(
    bind_cols(
      tsfeatures(.x$value, functions))))) %&gt;%
  unnest(Statistics)</code></pre>
<pre class="r"><code># I saved to whole dataset as &quot;Stats&quot; next I split it between training and test.
Stats &lt;- read.csv(&quot;C:/Users/Matt/Desktop/Data Science Challenge/TSfeatures_train_val.csv&quot;)</code></pre>
<p><strong>Note:</strong> Again, bad practice by me. I just called the <code>df</code> data <code>Stats</code> which consists of only the time series features. This still only refers to the <code>train_val.csv</code> data and <em>not</em> the <code>test.csv</code> data.</p>
<p>The training data looks like: (after computing the time series features). Now each asset has been collapsed from ~260 days down to 1 signal observation.</p>
<p>Recall the goal here was to classify synthetic time series vs real time series and not what the next days price is going to be. For each asset I have a signal observation and based on this I can train a classifying algorithm to distinguish between real vs synthetic time series.</p>
</div>
<div id="how-the-training-data-looks-1" class="section level3">
<h3>How the training data looks:</h3>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-21">Table 4: </span>tsfeatures package features
</caption>
<thead>
<tr>
<th style="text-align:right;">
X
</th>
<th style="text-align:right;">
row_id
</th>
<th style="text-align:right;">
class
</th>
<th style="text-align:right;">
ac_9_ac_9
</th>
<th style="text-align:right;">
acf_features_x_acf1
</th>
<th style="text-align:right;">
acf_features_x_acf10
</th>
<th style="text-align:right;">
acf_features_diff1_acf1
</th>
<th style="text-align:right;">
acf_features_diff1_acf10
</th>
<th style="text-align:right;">
acf_features_diff2_acf1
</th>
<th style="text-align:right;">
acf_features_diff2_acf10
</th>
<th style="text-align:right;">
ARCH.LM
</th>
<th style="text-align:right;">
autocorr_features_embed2_incircle_1
</th>
<th style="text-align:right;">
autocorr_features_embed2_incircle_2
</th>
<th style="text-align:right;">
autocorr_features_ac_9
</th>
<th style="text-align:right;">
autocorr_features_firstmin_ac
</th>
<th style="text-align:right;">
autocorr_features_trev_num
</th>
<th style="text-align:right;">
autocorr_features_motiftwo_entro3
</th>
<th style="text-align:right;">
autocorr_features_walker_propcross
</th>
<th style="text-align:right;">
binarize_mean_binarize_mean
</th>
<th style="text-align:right;">
binarize_mean_NA
</th>
<th style="text-align:right;">
compengine_embed2_incircle_1
</th>
<th style="text-align:right;">
compengine_embed2_incircle_2
</th>
<th style="text-align:right;">
compengine_ac_9
</th>
<th style="text-align:right;">
compengine_firstmin_ac
</th>
<th style="text-align:right;">
compengine_trev_num
</th>
<th style="text-align:right;">
compengine_motiftwo_entro3
</th>
<th style="text-align:right;">
compengine_walker_propcross
</th>
<th style="text-align:right;">
compengine_localsimple_mean1
</th>
<th style="text-align:right;">
compengine_localsimple_lfitac
</th>
<th style="text-align:right;">
compengine_sampen_first
</th>
<th style="text-align:right;">
compengine_std1st_der
</th>
<th style="text-align:right;">
compengine_spreadrandomlocal_meantaul_50
</th>
<th style="text-align:right;">
compengine_spreadrandomlocal_meantaul_ac2
</th>
<th style="text-align:right;">
compengine_histogram_mode_10
</th>
<th style="text-align:right;">
compengine_outlierinclude_mdrmd
</th>
<th style="text-align:right;">
compengine_fluctanal_prop_r1
</th>
<th style="text-align:right;">
crossing_points
</th>
<th style="text-align:right;">
dist_features_histogram_mode_10
</th>
<th style="text-align:right;">
dist_features_outlierinclude_mdrmd
</th>
<th style="text-align:right;">
embed2_incircle
</th>
<th style="text-align:right;">
entropy
</th>
<th style="text-align:right;">
firstmin_ac
</th>
<th style="text-align:right;">
firstzero_ac
</th>
<th style="text-align:right;">
flat_spots
</th>
<th style="text-align:right;">
fluctanal_prop_r1_fluctanal_prop_r1
</th>
<th style="text-align:right;">
arch_acf
</th>
<th style="text-align:right;">
garch_acf
</th>
<th style="text-align:right;">
arch_r2
</th>
<th style="text-align:right;">
garch_r2
</th>
<th style="text-align:right;">
histogram_mode
</th>
<th style="text-align:right;">
alpha
</th>
<th style="text-align:right;">
beta
</th>
<th style="text-align:right;">
hurst
</th>
<th style="text-align:left;">
hw_parameters_hw_parameters
</th>
<th style="text-align:left;">
hw_parameters_NA
</th>
<th style="text-align:right;">
localsimple_taures
</th>
<th style="text-align:right;">
lumpiness
</th>
<th style="text-align:right;">
max_kl_shift
</th>
<th style="text-align:right;">
time_kl_shift
</th>
<th style="text-align:right;">
max_level_shift
</th>
<th style="text-align:right;">
time_level_shift
</th>
<th style="text-align:right;">
max_var_shift
</th>
<th style="text-align:right;">
time_var_shift
</th>
<th style="text-align:right;">
motiftwo_entro3
</th>
<th style="text-align:right;">
nonlinearity
</th>
<th style="text-align:right;">
outlierinclude_mdrmd
</th>
<th style="text-align:right;">
x_pacf5
</th>
<th style="text-align:right;">
diff1x_pacf5
</th>
<th style="text-align:right;">
diff2x_pacf5
</th>
<th style="text-align:right;">
pred_features_localsimple_mean1
</th>
<th style="text-align:right;">
pred_features_localsimple_lfitac
</th>
<th style="text-align:right;">
pred_features_sampen_first
</th>
<th style="text-align:right;">
sampen_first_sampen_first
</th>
<th style="text-align:right;">
sampenc
</th>
<th style="text-align:right;">
scal_features_fluctanal_prop_r1
</th>
<th style="text-align:right;">
spreadrandomlocal_meantaul
</th>
<th style="text-align:right;">
stability
</th>
<th style="text-align:right;">
station_features_std1st_der
</th>
<th style="text-align:right;">
station_features_spreadrandomlocal_meantaul_50
</th>
<th style="text-align:right;">
station_features_spreadrandomlocal_meantaul_ac2
</th>
<th style="text-align:right;">
std1st_der_std1st_der
</th>
<th style="text-align:right;">
nperiods
</th>
<th style="text-align:right;">
seasonal_period
</th>
<th style="text-align:right;">
trend
</th>
<th style="text-align:right;">
spike
</th>
<th style="text-align:right;">
linearity
</th>
<th style="text-align:right;">
curvature
</th>
<th style="text-align:right;">
e_acf1
</th>
<th style="text-align:right;">
e_acf10
</th>
<th style="text-align:right;">
trev_num
</th>
<th style="text-align:right;">
tsfeatures_frequency
</th>
<th style="text-align:right;">
tsfeatures_nperiods
</th>
<th style="text-align:right;">
tsfeatures_seasonal_period
</th>
<th style="text-align:right;">
tsfeatures_trend
</th>
<th style="text-align:right;">
tsfeatures_spike
</th>
<th style="text-align:right;">
tsfeatures_linearity
</th>
<th style="text-align:right;">
tsfeatures_curvature
</th>
<th style="text-align:right;">
tsfeatures_e_acf1
</th>
<th style="text-align:right;">
tsfeatures_e_acf10
</th>
<th style="text-align:right;">
tsfeatures_entropy
</th>
<th style="text-align:right;">
tsfeatures_x_acf1
</th>
<th style="text-align:right;">
tsfeatures_x_acf10
</th>
<th style="text-align:right;">
tsfeatures_diff1_acf1
</th>
<th style="text-align:right;">
tsfeatures_diff1_acf10
</th>
<th style="text-align:right;">
tsfeatures_diff2_acf1
</th>
<th style="text-align:right;">
tsfeatures_diff2_acf10
</th>
<th style="text-align:right;">
unitroot_kpss
</th>
<th style="text-align:right;">
unitroot_pp
</th>
<th style="text-align:right;">
walker_propcross
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.0675275
</td>
<td style="text-align:right;">
0.0097094
</td>
<td style="text-align:right;">
0.0526897
</td>
<td style="text-align:right;">
-0.5005299
</td>
<td style="text-align:right;">
0.3297018
</td>
<td style="text-align:right;">
-0.6772403
</td>
<td style="text-align:right;">
0.6124739
</td>
<td style="text-align:right;">
0.0627825
</td>
<td style="text-align:right;">
0.3929961
</td>
<td style="text-align:right;">
0.6147860
</td>
<td style="text-align:right;">
-0.0675275
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.1208750
</td>
<td style="text-align:right;">
2.071663
</td>
<td style="text-align:right;">
0.5405405
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3929961
</td>
<td style="text-align:right;">
0.6147860
</td>
<td style="text-align:right;">
-0.0675275
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.1208750
</td>
<td style="text-align:right;">
2.071663
</td>
<td style="text-align:right;">
0.5405405
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.788841
</td>
<td style="text-align:right;">
1.408737
</td>
<td style="text-align:right;">
1.68
</td>
<td style="text-align:right;">
1.43
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.2865385
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.2865385
</td>
<td style="text-align:right;">
0.3929961
</td>
<td style="text-align:right;">
0.9840151
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.0652585
</td>
<td style="text-align:right;">
0.0154406
</td>
<td style="text-align:right;">
0.0627825
</td>
<td style="text-align:right;">
0.0253367
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0013330
</td>
<td style="text-align:right;">
0.0013330
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3556536
</td>
<td style="text-align:right;">
1.783636
</td>
<td style="text-align:right;">
103
</td>
<td style="text-align:right;">
1.297736
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
2.819828
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
2.071663
</td>
<td style="text-align:right;">
0.0752319
</td>
<td style="text-align:right;">
-0.2865385
</td>
<td style="text-align:right;">
0.0108653
</td>
<td style="text-align:right;">
0.4457792
</td>
<td style="text-align:right;">
1.0525222
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.788841
</td>
<td style="text-align:right;">
1.788841
</td>
<td style="text-align:right;">
1.788841
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
1.76
</td>
<td style="text-align:right;">
0.0562693
</td>
<td style="text-align:right;">
1.408737
</td>
<td style="text-align:right;">
1.74
</td>
<td style="text-align:right;">
1.36
</td>
<td style="text-align:right;">
1.408737
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0043052
</td>
<td style="text-align:right;">
0.0000261
</td>
<td style="text-align:right;">
0.8421403
</td>
<td style="text-align:right;">
-0.7069160
</td>
<td style="text-align:right;">
0.0052389
</td>
<td style="text-align:right;">
0.0588324
</td>
<td style="text-align:right;">
0.1208750
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0043052
</td>
<td style="text-align:right;">
0.0000261
</td>
<td style="text-align:right;">
0.8421403
</td>
<td style="text-align:right;">
-0.7069160
</td>
<td style="text-align:right;">
0.0052389
</td>
<td style="text-align:right;">
0.0588324
</td>
<td style="text-align:right;">
0.9840151
</td>
<td style="text-align:right;">
0.0097094
</td>
<td style="text-align:right;">
0.0526897
</td>
<td style="text-align:right;">
-0.5005299
</td>
<td style="text-align:right;">
0.3297018
</td>
<td style="text-align:right;">
-0.6772403
</td>
<td style="text-align:right;">
0.6124739
</td>
<td style="text-align:right;">
0.0993829
</td>
<td style="text-align:right;">
-249.7732
</td>
<td style="text-align:right;">
0.5405405
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.0421577
</td>
<td style="text-align:right;">
-0.0075902
</td>
<td style="text-align:right;">
0.0387481
</td>
<td style="text-align:right;">
-0.5171529
</td>
<td style="text-align:right;">
0.3129147
</td>
<td style="text-align:right;">
-0.6727897
</td>
<td style="text-align:right;">
0.5379301
</td>
<td style="text-align:right;">
0.0558032
</td>
<td style="text-align:right;">
0.4285714
</td>
<td style="text-align:right;">
0.6563707
</td>
<td style="text-align:right;">
-0.0421577
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.4765229
</td>
<td style="text-align:right;">
2.077581
</td>
<td style="text-align:right;">
0.5019305
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.4285714
</td>
<td style="text-align:right;">
0.6563707
</td>
<td style="text-align:right;">
-0.0421577
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.4765229
</td>
<td style="text-align:right;">
2.077581
</td>
<td style="text-align:right;">
0.5019305
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.780390
</td>
<td style="text-align:right;">
1.419266
</td>
<td style="text-align:right;">
1.95
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.2615385
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.2615385
</td>
<td style="text-align:right;">
0.4285714
</td>
<td style="text-align:right;">
0.9864332
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.0664358
</td>
<td style="text-align:right;">
0.0657859
</td>
<td style="text-align:right;">
0.0558032
</td>
<td style="text-align:right;">
0.0554355
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.4636768
</td>
<td style="text-align:right;">
1.733008
</td>
<td style="text-align:right;">
247
</td>
<td style="text-align:right;">
1.311861
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
2.625772
</td>
<td style="text-align:right;">
221
</td>
<td style="text-align:right;">
2.077581
</td>
<td style="text-align:right;">
0.0273335
</td>
<td style="text-align:right;">
0.2615385
</td>
<td style="text-align:right;">
0.0256032
</td>
<td style="text-align:right;">
0.4606850
</td>
<td style="text-align:right;">
1.0171377
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.780390
</td>
<td style="text-align:right;">
1.780390
</td>
<td style="text-align:right;">
1.780390
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
0.0892206
</td>
<td style="text-align:right;">
1.419266
</td>
<td style="text-align:right;">
2.12
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.419266
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0177460
</td>
<td style="text-align:right;">
0.0000399
</td>
<td style="text-align:right;">
0.9249561
</td>
<td style="text-align:right;">
0.7665407
</td>
<td style="text-align:right;">
-0.0218053
</td>
<td style="text-align:right;">
0.0411861
</td>
<td style="text-align:right;">
-0.4765229
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0177460
</td>
<td style="text-align:right;">
0.0000399
</td>
<td style="text-align:right;">
0.9249561
</td>
<td style="text-align:right;">
0.7665407
</td>
<td style="text-align:right;">
-0.0218053
</td>
<td style="text-align:right;">
0.0411861
</td>
<td style="text-align:right;">
0.9864332
</td>
<td style="text-align:right;">
-0.0075902
</td>
<td style="text-align:right;">
0.0387481
</td>
<td style="text-align:right;">
-0.5171529
</td>
<td style="text-align:right;">
0.3129147
</td>
<td style="text-align:right;">
-0.6727897
</td>
<td style="text-align:right;">
0.5379301
</td>
<td style="text-align:right;">
0.0414599
</td>
<td style="text-align:right;">
-256.0485
</td>
<td style="text-align:right;">
0.5019305
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0099598
</td>
<td style="text-align:right;">
-0.0405929
</td>
<td style="text-align:right;">
0.0449036
</td>
<td style="text-align:right;">
-0.5026683
</td>
<td style="text-align:right;">
0.3471209
</td>
<td style="text-align:right;">
-0.6718885
</td>
<td style="text-align:right;">
0.6109006
</td>
<td style="text-align:right;">
0.0325470
</td>
<td style="text-align:right;">
0.4671815
</td>
<td style="text-align:right;">
0.7065637
</td>
<td style="text-align:right;">
0.0099598
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.8755173
</td>
<td style="text-align:right;">
2.069233
</td>
<td style="text-align:right;">
0.5328185
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4671815
</td>
<td style="text-align:right;">
0.7065637
</td>
<td style="text-align:right;">
0.0099598
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.8755173
</td>
<td style="text-align:right;">
2.069233
</td>
<td style="text-align:right;">
0.5328185
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.706841
</td>
<td style="text-align:right;">
1.443315
</td>
<td style="text-align:right;">
1.38
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
-0.2538462
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
-0.2538462
</td>
<td style="text-align:right;">
0.4671815
</td>
<td style="text-align:right;">
0.9868568
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
0.0388513
</td>
<td style="text-align:right;">
0.0039162
</td>
<td style="text-align:right;">
0.0325470
</td>
<td style="text-align:right;">
0.0041902
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
0.0014557
</td>
<td style="text-align:right;">
0.0014557
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.2670493
</td>
<td style="text-align:right;">
7.746711
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
1.403784
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
5.235499
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
2.069233
</td>
<td style="text-align:right;">
0.2436499
</td>
<td style="text-align:right;">
-0.2538462
</td>
<td style="text-align:right;">
0.0223069
</td>
<td style="text-align:right;">
0.5356408
</td>
<td style="text-align:right;">
0.9954919
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.706841
</td>
<td style="text-align:right;">
1.706841
</td>
<td style="text-align:right;">
1.706841
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
1.42
</td>
<td style="text-align:right;">
0.0716499
</td>
<td style="text-align:right;">
1.443315
</td>
<td style="text-align:right;">
1.42
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.443315
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0141368
</td>
<td style="text-align:right;">
0.0000929
</td>
<td style="text-align:right;">
0.8414359
</td>
<td style="text-align:right;">
-0.0259311
</td>
<td style="text-align:right;">
-0.0547484
</td>
<td style="text-align:right;">
0.0492987
</td>
<td style="text-align:right;">
-0.8755173
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0141368
</td>
<td style="text-align:right;">
0.0000929
</td>
<td style="text-align:right;">
0.8414359
</td>
<td style="text-align:right;">
-0.0259311
</td>
<td style="text-align:right;">
-0.0547484
</td>
<td style="text-align:right;">
0.0492987
</td>
<td style="text-align:right;">
0.9868568
</td>
<td style="text-align:right;">
-0.0405929
</td>
<td style="text-align:right;">
0.0449036
</td>
<td style="text-align:right;">
-0.5026683
</td>
<td style="text-align:right;">
0.3471209
</td>
<td style="text-align:right;">
-0.6718885
</td>
<td style="text-align:right;">
0.6109006
</td>
<td style="text-align:right;">
0.0775698
</td>
<td style="text-align:right;">
-258.1295
</td>
<td style="text-align:right;">
0.5328185
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.0428748
</td>
<td style="text-align:right;">
-0.0443619
</td>
<td style="text-align:right;">
0.0615867
</td>
<td style="text-align:right;">
-0.4571442
</td>
<td style="text-align:right;">
0.3184053
</td>
<td style="text-align:right;">
-0.5906478
</td>
<td style="text-align:right;">
0.4361178
</td>
<td style="text-align:right;">
0.1275576
</td>
<td style="text-align:right;">
0.4555985
</td>
<td style="text-align:right;">
0.7027027
</td>
<td style="text-align:right;">
-0.0428748
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.9943808
</td>
<td style="text-align:right;">
2.068744
</td>
<td style="text-align:right;">
0.4903475
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4555985
</td>
<td style="text-align:right;">
0.7027027
</td>
<td style="text-align:right;">
-0.0428748
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.9943808
</td>
<td style="text-align:right;">
2.068744
</td>
<td style="text-align:right;">
0.4903475
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.660825
</td>
<td style="text-align:right;">
1.445807
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0153846
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
127
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0153846
</td>
<td style="text-align:right;">
0.4555985
</td>
<td style="text-align:right;">
0.9790521
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
0.0694296
</td>
<td style="text-align:right;">
0.0112709
</td>
<td style="text-align:right;">
0.0579144
</td>
<td style="text-align:right;">
0.0123884
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0480021
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.0068624
</td>
<td style="text-align:right;">
4.994753
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
1.258758
</td>
<td style="text-align:right;">
173
</td>
<td style="text-align:right;">
5.886911
</td>
<td style="text-align:right;">
156
</td>
<td style="text-align:right;">
2.068744
</td>
<td style="text-align:right;">
0.3840091
</td>
<td style="text-align:right;">
0.0153846
</td>
<td style="text-align:right;">
0.0503205
</td>
<td style="text-align:right;">
0.5402603
</td>
<td style="text-align:right;">
1.1070217
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.660825
</td>
<td style="text-align:right;">
1.660825
</td>
<td style="text-align:right;">
1.660825
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:right;">
0.1065111
</td>
<td style="text-align:right;">
1.445807
</td>
<td style="text-align:right;">
1.14
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.445807
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0283540
</td>
<td style="text-align:right;">
0.0000482
</td>
<td style="text-align:right;">
-1.2297854
</td>
<td style="text-align:right;">
0.2921899
</td>
<td style="text-align:right;">
-0.0728152
</td>
<td style="text-align:right;">
0.0752389
</td>
<td style="text-align:right;">
-0.9943808
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0283540
</td>
<td style="text-align:right;">
0.0000482
</td>
<td style="text-align:right;">
-1.2297854
</td>
<td style="text-align:right;">
0.2921899
</td>
<td style="text-align:right;">
-0.0728152
</td>
<td style="text-align:right;">
0.0752389
</td>
<td style="text-align:right;">
0.9790521
</td>
<td style="text-align:right;">
-0.0443619
</td>
<td style="text-align:right;">
0.0615867
</td>
<td style="text-align:right;">
-0.4571442
</td>
<td style="text-align:right;">
0.3184053
</td>
<td style="text-align:right;">
-0.5906478
</td>
<td style="text-align:right;">
0.4361178
</td>
<td style="text-align:right;">
0.2129633
</td>
<td style="text-align:right;">
-262.0781
</td>
<td style="text-align:right;">
0.4903475
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0259312
</td>
<td style="text-align:right;">
-0.2447835
</td>
<td style="text-align:right;">
0.1469130
</td>
<td style="text-align:right;">
-0.5810073
</td>
<td style="text-align:right;">
0.4796508
</td>
<td style="text-align:right;">
-0.6799229
</td>
<td style="text-align:right;">
0.6232529
</td>
<td style="text-align:right;">
0.2014861
</td>
<td style="text-align:right;">
0.6563707
</td>
<td style="text-align:right;">
0.7992278
</td>
<td style="text-align:right;">
0.0259312
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.7167079
</td>
<td style="text-align:right;">
2.059764
</td>
<td style="text-align:right;">
0.5289575
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.6563707
</td>
<td style="text-align:right;">
0.7992278
</td>
<td style="text-align:right;">
0.0259312
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.7167079
</td>
<td style="text-align:right;">
2.059764
</td>
<td style="text-align:right;">
0.5289575
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.347789
</td>
<td style="text-align:right;">
1.580825
</td>
<td style="text-align:right;">
1.08
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
0.7961538
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
133
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
0.7961538
</td>
<td style="text-align:right;">
0.6563707
</td>
<td style="text-align:right;">
0.9723766
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.2718058
</td>
<td style="text-align:right;">
0.2229375
</td>
<td style="text-align:right;">
0.1765130
</td>
<td style="text-align:right;">
0.1330761
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.8846415
</td>
<td style="text-align:right;">
11.474426
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
1.772392
</td>
<td style="text-align:right;">
229
</td>
<td style="text-align:right;">
8.468236
</td>
<td style="text-align:right;">
236
</td>
<td style="text-align:right;">
2.059764
</td>
<td style="text-align:right;">
0.2143595
</td>
<td style="text-align:right;">
0.7961538
</td>
<td style="text-align:right;">
0.1008392
</td>
<td style="text-align:right;">
0.7538746
</td>
<td style="text-align:right;">
1.2926800
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.347789
</td>
<td style="text-align:right;">
1.347789
</td>
<td style="text-align:right;">
1.347789
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
1.08
</td>
<td style="text-align:right;">
0.0797924
</td>
<td style="text-align:right;">
1.580825
</td>
<td style="text-align:right;">
1.06
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.580825
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0121072
</td>
<td style="text-align:right;">
0.0001568
</td>
<td style="text-align:right;">
-0.5488436
</td>
<td style="text-align:right;">
0.2255538
</td>
<td style="text-align:right;">
-0.2599764
</td>
<td style="text-align:right;">
0.1558209
</td>
<td style="text-align:right;">
-0.7167079
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0121072
</td>
<td style="text-align:right;">
0.0001568
</td>
<td style="text-align:right;">
-0.5488436
</td>
<td style="text-align:right;">
0.2255538
</td>
<td style="text-align:right;">
-0.2599764
</td>
<td style="text-align:right;">
0.1558209
</td>
<td style="text-align:right;">
0.9723766
</td>
<td style="text-align:right;">
-0.2447835
</td>
<td style="text-align:right;">
0.1469130
</td>
<td style="text-align:right;">
-0.5810073
</td>
<td style="text-align:right;">
0.4796508
</td>
<td style="text-align:right;">
-0.6799229
</td>
<td style="text-align:right;">
0.6232529
</td>
<td style="text-align:right;">
0.1506344
</td>
<td style="text-align:right;">
-323.5672
</td>
<td style="text-align:right;">
0.5289575
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.0761166
</td>
<td style="text-align:right;">
0.0468556
</td>
<td style="text-align:right;">
0.0858348
</td>
<td style="text-align:right;">
-0.5253131
</td>
<td style="text-align:right;">
0.3438031
</td>
<td style="text-align:right;">
-0.6901570
</td>
<td style="text-align:right;">
0.6130725
</td>
<td style="text-align:right;">
0.0432628
</td>
<td style="text-align:right;">
0.4352941
</td>
<td style="text-align:right;">
0.6627451
</td>
<td style="text-align:right;">
-0.0761166
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0898648
</td>
<td style="text-align:right;">
2.068914
</td>
<td style="text-align:right;">
0.5250965
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.4352941
</td>
<td style="text-align:right;">
0.6627451
</td>
<td style="text-align:right;">
-0.0761166
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0898648
</td>
<td style="text-align:right;">
2.068914
</td>
<td style="text-align:right;">
0.5250965
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.751575
</td>
<td style="text-align:right;">
1.381854
</td>
<td style="text-align:right;">
2.69
</td>
<td style="text-align:right;">
1.71
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.0846154
</td>
<td style="text-align:right;">
0.3488372
</td>
<td style="text-align:right;">
134
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.0846154
</td>
<td style="text-align:right;">
0.4352941
</td>
<td style="text-align:right;">
0.9806218
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.3488372
</td>
<td style="text-align:right;">
0.0500806
</td>
<td style="text-align:right;">
0.0502154
</td>
<td style="text-align:right;">
0.0627968
</td>
<td style="text-align:right;">
0.0620877
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0286244
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5188805
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.2189481
</td>
<td style="text-align:right;">
3.145763
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
1.447883
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
2.077936
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
2.068914
</td>
<td style="text-align:right;">
0.0137733
</td>
<td style="text-align:right;">
-0.0846154
</td>
<td style="text-align:right;">
0.0172321
</td>
<td style="text-align:right;">
0.4345976
</td>
<td style="text-align:right;">
1.0881798
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.751575
</td>
<td style="text-align:right;">
1.751575
</td>
<td style="text-align:right;">
1.751575
</td>
<td style="text-align:right;">
0.3488372
</td>
<td style="text-align:right;">
2.61
</td>
<td style="text-align:right;">
0.1479673
</td>
<td style="text-align:right;">
1.381854
</td>
<td style="text-align:right;">
2.63
</td>
<td style="text-align:right;">
1.81
</td>
<td style="text-align:right;">
1.381854
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0077481
</td>
<td style="text-align:right;">
0.0000329
</td>
<td style="text-align:right;">
-0.5473782
</td>
<td style="text-align:right;">
0.4505809
</td>
<td style="text-align:right;">
0.0410068
</td>
<td style="text-align:right;">
0.0873468
</td>
<td style="text-align:right;">
0.0898648
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0077481
</td>
<td style="text-align:right;">
0.0000329
</td>
<td style="text-align:right;">
-0.5473782
</td>
<td style="text-align:right;">
0.4505809
</td>
<td style="text-align:right;">
0.0410068
</td>
<td style="text-align:right;">
0.0873468
</td>
<td style="text-align:right;">
0.9806218
</td>
<td style="text-align:right;">
0.0468556
</td>
<td style="text-align:right;">
0.0858348
</td>
<td style="text-align:right;">
-0.5253131
</td>
<td style="text-align:right;">
0.3438031
</td>
<td style="text-align:right;">
-0.6901570
</td>
<td style="text-align:right;">
0.6130725
</td>
<td style="text-align:right;">
0.0259414
</td>
<td style="text-align:right;">
-262.3484
</td>
<td style="text-align:right;">
0.5250965
</td>
</tr>
</tbody>
</table>
<pre><code>## [1] 12000   109</code></pre>
<p>The dimensions of the data as still 12,000 with 109 features (created from the tsfeatures package). That is we have 6,000 synthetic and 6,000 real financial time series (12,000 * ~260 = 3,120,000 but we applied tsfeatures to collapse the ~260 down to 1 single observation)</p>
<p>I collapsed this problem down from a time series prediction problem to a pure classification problem. I split the data between training and validation set next… I also split the data into <code>X_train</code>, <code>Y_train</code>… etc.</p>
<p>I split the <code>df/Stats</code> data set into a train set of 75% of the observations and an <em>in-sample</em> test data set of 25% of the observations.</p>
<pre class="r"><code>######################################################################
################# Train and XGBoost model on the TS Features #########

#Stats &lt;- Stats %&gt;%
#  select_if(~sum(!is.na(.)) &gt; 0)

# Split the training set up between train and a small validation set
smp_size &lt;- floor(0.75 * nrow(Stats))
#set.seed(123)
train_ind &lt;- sample(seq_len(nrow(Stats)), size = smp_size)

train &lt;- Stats[train_ind, ]
val &lt;- Stats[-train_ind, ]

# We have 106 time series features for the model to learn from.

x_train &lt;- train %&gt;%
  ungroup() %&gt;%
  select(-class, -row_id, -X) %&gt;%
  as.matrix()

x_val &lt;- val %&gt;%
  ungroup() %&gt;%
  select(-class, -row_id, -X) %&gt;%
  as.matrix()

y_train &lt;- train %&gt;%
  ungroup() %&gt;%
  pull(class)

y_val &lt;- val %&gt;%
  ungroup() %&gt;%
  pull(class)</code></pre>
</div>
<div id="how-the-training-x-input-variables-data-looks" class="section level3">
<h3>How the training X (input variables) data looks:</h3>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-23">Table 5: </span>How the X_train data look
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
ac_9_ac_9
</th>
<th style="text-align:right;">
acf_features_x_acf1
</th>
<th style="text-align:right;">
acf_features_x_acf10
</th>
<th style="text-align:right;">
acf_features_diff1_acf1
</th>
<th style="text-align:right;">
acf_features_diff1_acf10
</th>
<th style="text-align:right;">
acf_features_diff2_acf1
</th>
<th style="text-align:right;">
acf_features_diff2_acf10
</th>
<th style="text-align:right;">
ARCH.LM
</th>
<th style="text-align:right;">
autocorr_features_embed2_incircle_1
</th>
<th style="text-align:right;">
autocorr_features_embed2_incircle_2
</th>
<th style="text-align:right;">
autocorr_features_ac_9
</th>
<th style="text-align:right;">
autocorr_features_firstmin_ac
</th>
<th style="text-align:right;">
autocorr_features_trev_num
</th>
<th style="text-align:right;">
autocorr_features_motiftwo_entro3
</th>
<th style="text-align:right;">
autocorr_features_walker_propcross
</th>
<th style="text-align:right;">
binarize_mean_binarize_mean
</th>
<th style="text-align:right;">
binarize_mean_NA
</th>
<th style="text-align:right;">
compengine_embed2_incircle_1
</th>
<th style="text-align:right;">
compengine_embed2_incircle_2
</th>
<th style="text-align:right;">
compengine_ac_9
</th>
<th style="text-align:right;">
compengine_firstmin_ac
</th>
<th style="text-align:right;">
compengine_trev_num
</th>
<th style="text-align:right;">
compengine_motiftwo_entro3
</th>
<th style="text-align:right;">
compengine_walker_propcross
</th>
<th style="text-align:right;">
compengine_localsimple_mean1
</th>
<th style="text-align:right;">
compengine_localsimple_lfitac
</th>
<th style="text-align:right;">
compengine_sampen_first
</th>
<th style="text-align:right;">
compengine_std1st_der
</th>
<th style="text-align:right;">
compengine_spreadrandomlocal_meantaul_50
</th>
<th style="text-align:right;">
compengine_spreadrandomlocal_meantaul_ac2
</th>
<th style="text-align:right;">
compengine_histogram_mode_10
</th>
<th style="text-align:right;">
compengine_outlierinclude_mdrmd
</th>
<th style="text-align:right;">
compengine_fluctanal_prop_r1
</th>
<th style="text-align:right;">
crossing_points
</th>
<th style="text-align:right;">
dist_features_histogram_mode_10
</th>
<th style="text-align:right;">
dist_features_outlierinclude_mdrmd
</th>
<th style="text-align:right;">
embed2_incircle
</th>
<th style="text-align:right;">
entropy
</th>
<th style="text-align:right;">
firstmin_ac
</th>
<th style="text-align:right;">
firstzero_ac
</th>
<th style="text-align:right;">
flat_spots
</th>
<th style="text-align:right;">
fluctanal_prop_r1_fluctanal_prop_r1
</th>
<th style="text-align:right;">
arch_acf
</th>
<th style="text-align:right;">
garch_acf
</th>
<th style="text-align:right;">
arch_r2
</th>
<th style="text-align:right;">
garch_r2
</th>
<th style="text-align:right;">
histogram_mode
</th>
<th style="text-align:right;">
alpha
</th>
<th style="text-align:right;">
beta
</th>
<th style="text-align:right;">
hurst
</th>
<th style="text-align:right;">
hw_parameters_hw_parameters
</th>
<th style="text-align:right;">
hw_parameters_NA
</th>
<th style="text-align:right;">
localsimple_taures
</th>
<th style="text-align:right;">
lumpiness
</th>
<th style="text-align:right;">
max_kl_shift
</th>
<th style="text-align:right;">
time_kl_shift
</th>
<th style="text-align:right;">
max_level_shift
</th>
<th style="text-align:right;">
time_level_shift
</th>
<th style="text-align:right;">
max_var_shift
</th>
<th style="text-align:right;">
time_var_shift
</th>
<th style="text-align:right;">
motiftwo_entro3
</th>
<th style="text-align:right;">
nonlinearity
</th>
<th style="text-align:right;">
outlierinclude_mdrmd
</th>
<th style="text-align:right;">
x_pacf5
</th>
<th style="text-align:right;">
diff1x_pacf5
</th>
<th style="text-align:right;">
diff2x_pacf5
</th>
<th style="text-align:right;">
pred_features_localsimple_mean1
</th>
<th style="text-align:right;">
pred_features_localsimple_lfitac
</th>
<th style="text-align:right;">
pred_features_sampen_first
</th>
<th style="text-align:right;">
sampen_first_sampen_first
</th>
<th style="text-align:right;">
sampenc
</th>
<th style="text-align:right;">
scal_features_fluctanal_prop_r1
</th>
<th style="text-align:right;">
spreadrandomlocal_meantaul
</th>
<th style="text-align:right;">
stability
</th>
<th style="text-align:right;">
station_features_std1st_der
</th>
<th style="text-align:right;">
station_features_spreadrandomlocal_meantaul_50
</th>
<th style="text-align:right;">
station_features_spreadrandomlocal_meantaul_ac2
</th>
<th style="text-align:right;">
std1st_der_std1st_der
</th>
<th style="text-align:right;">
nperiods
</th>
<th style="text-align:right;">
seasonal_period
</th>
<th style="text-align:right;">
trend
</th>
<th style="text-align:right;">
spike
</th>
<th style="text-align:right;">
linearity
</th>
<th style="text-align:right;">
curvature
</th>
<th style="text-align:right;">
e_acf1
</th>
<th style="text-align:right;">
e_acf10
</th>
<th style="text-align:right;">
trev_num
</th>
<th style="text-align:right;">
tsfeatures_frequency
</th>
<th style="text-align:right;">
tsfeatures_nperiods
</th>
<th style="text-align:right;">
tsfeatures_seasonal_period
</th>
<th style="text-align:right;">
tsfeatures_trend
</th>
<th style="text-align:right;">
tsfeatures_spike
</th>
<th style="text-align:right;">
tsfeatures_linearity
</th>
<th style="text-align:right;">
tsfeatures_curvature
</th>
<th style="text-align:right;">
tsfeatures_e_acf1
</th>
<th style="text-align:right;">
tsfeatures_e_acf10
</th>
<th style="text-align:right;">
tsfeatures_entropy
</th>
<th style="text-align:right;">
tsfeatures_x_acf1
</th>
<th style="text-align:right;">
tsfeatures_x_acf10
</th>
<th style="text-align:right;">
tsfeatures_diff1_acf1
</th>
<th style="text-align:right;">
tsfeatures_diff1_acf10
</th>
<th style="text-align:right;">
tsfeatures_diff2_acf1
</th>
<th style="text-align:right;">
tsfeatures_diff2_acf10
</th>
<th style="text-align:right;">
unitroot_kpss
</th>
<th style="text-align:right;">
unitroot_pp
</th>
<th style="text-align:right;">
walker_propcross
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
6871
</td>
<td style="text-align:right;">
0.0261213
</td>
<td style="text-align:right;">
-0.0312543
</td>
<td style="text-align:right;">
0.0396675
</td>
<td style="text-align:right;">
-0.5387087
</td>
<td style="text-align:right;">
0.3618037
</td>
<td style="text-align:right;">
-0.7127104
</td>
<td style="text-align:right;">
0.6506867
</td>
<td style="text-align:right;">
0.1712203
</td>
<td style="text-align:right;">
0.4671815
</td>
<td style="text-align:right;">
0.6602317
</td>
<td style="text-align:right;">
0.0261213
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.2094960
</td>
<td style="text-align:right;">
2.077291
</td>
<td style="text-align:right;">
0.5135135
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4671815
</td>
<td style="text-align:right;">
0.6602317
</td>
<td style="text-align:right;">
0.0261213
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.2094960
</td>
<td style="text-align:right;">
2.077291
</td>
<td style="text-align:right;">
0.5135135
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.653587
</td>
<td style="text-align:right;">
1.437026
</td>
<td style="text-align:right;">
1.51
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0134615
</td>
<td style="text-align:right;">
0.8604651
</td>
<td style="text-align:right;">
129
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0134615
</td>
<td style="text-align:right;">
0.4671815
</td>
<td style="text-align:right;">
0.9819775
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.8604651
</td>
<td style="text-align:right;">
0.1384425
</td>
<td style="text-align:right;">
0.0368007
</td>
<td style="text-align:right;">
0.1264413
</td>
<td style="text-align:right;">
0.0490622
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0473199
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.4456548
</td>
<td style="text-align:right;">
2.158220
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
1.206163
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:right;">
3.318012
</td>
<td style="text-align:right;">
239
</td>
<td style="text-align:right;">
2.077291
</td>
<td style="text-align:right;">
0.0343410
</td>
<td style="text-align:right;">
0.0134615
</td>
<td style="text-align:right;">
0.0400750
</td>
<td style="text-align:right;">
0.5343498
</td>
<td style="text-align:right;">
1.0455465
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.653587
</td>
<td style="text-align:right;">
1.653587
</td>
<td style="text-align:right;">
1.653587
</td>
<td style="text-align:right;">
0.8604651
</td>
<td style="text-align:right;">
1.54
</td>
<td style="text-align:right;">
0.0934525
</td>
<td style="text-align:right;">
1.437026
</td>
<td style="text-align:right;">
1.42
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.437026
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0163279
</td>
<td style="text-align:right;">
0.0000320
</td>
<td style="text-align:right;">
-0.9382053
</td>
<td style="text-align:right;">
0.2710799
</td>
<td style="text-align:right;">
-0.0483332
</td>
<td style="text-align:right;">
0.0457256
</td>
<td style="text-align:right;">
1.2094960
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0163279
</td>
<td style="text-align:right;">
0.0000320
</td>
<td style="text-align:right;">
-0.9382053
</td>
<td style="text-align:right;">
0.2710799
</td>
<td style="text-align:right;">
-0.0483332
</td>
<td style="text-align:right;">
0.0457256
</td>
<td style="text-align:right;">
0.9819775
</td>
<td style="text-align:right;">
-0.0312543
</td>
<td style="text-align:right;">
0.0396675
</td>
<td style="text-align:right;">
-0.5387087
</td>
<td style="text-align:right;">
0.3618037
</td>
<td style="text-align:right;">
-0.7127104
</td>
<td style="text-align:right;">
0.6506867
</td>
<td style="text-align:right;">
0.1799848
</td>
<td style="text-align:right;">
-257.7815
</td>
<td style="text-align:right;">
0.5135135
</td>
</tr>
<tr>
<td style="text-align:left;">
461
</td>
<td style="text-align:right;">
-0.1007662
</td>
<td style="text-align:right;">
-0.0046000
</td>
<td style="text-align:right;">
0.0251457
</td>
<td style="text-align:right;">
-0.4496709
</td>
<td style="text-align:right;">
0.2316894
</td>
<td style="text-align:right;">
-0.6268291
</td>
<td style="text-align:right;">
0.4251541
</td>
<td style="text-align:right;">
0.0338985
</td>
<td style="text-align:right;">
0.4440154
</td>
<td style="text-align:right;">
0.6988417
</td>
<td style="text-align:right;">
-0.1007662
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1611769
</td>
<td style="text-align:right;">
2.073478
</td>
<td style="text-align:right;">
0.5135135
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4440154
</td>
<td style="text-align:right;">
0.6988417
</td>
<td style="text-align:right;">
-0.1007662
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1611769
</td>
<td style="text-align:right;">
2.073478
</td>
<td style="text-align:right;">
0.5135135
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.710756
</td>
<td style="text-align:right;">
1.419605
</td>
<td style="text-align:right;">
1.37
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
-0.1692308
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
127
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
-0.1692308
</td>
<td style="text-align:right;">
0.4440154
</td>
<td style="text-align:right;">
0.9838851
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.0319993
</td>
<td style="text-align:right;">
0.0300665
</td>
<td style="text-align:right;">
0.0338985
</td>
<td style="text-align:right;">
0.0320637
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.0001235
</td>
<td style="text-align:right;">
0.0001235
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3887220
</td>
<td style="text-align:right;">
2.439031
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
1.051879
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2.475601
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
2.073478
</td>
<td style="text-align:right;">
0.1052842
</td>
<td style="text-align:right;">
-0.1692308
</td>
<td style="text-align:right;">
0.0142721
</td>
<td style="text-align:right;">
0.4992312
</td>
<td style="text-align:right;">
1.0093949
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.710756
</td>
<td style="text-align:right;">
1.710756
</td>
<td style="text-align:right;">
1.710756
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
1.45
</td>
<td style="text-align:right;">
0.0489944
</td>
<td style="text-align:right;">
1.419605
</td>
<td style="text-align:right;">
1.37
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.419605
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0263685
</td>
<td style="text-align:right;">
0.0000446
</td>
<td style="text-align:right;">
-1.9935782
</td>
<td style="text-align:right;">
0.4730478
</td>
<td style="text-align:right;">
-0.0304319
</td>
<td style="text-align:right;">
0.0411679
</td>
<td style="text-align:right;">
0.1611769
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0263685
</td>
<td style="text-align:right;">
0.0000446
</td>
<td style="text-align:right;">
-1.9935782
</td>
<td style="text-align:right;">
0.4730478
</td>
<td style="text-align:right;">
-0.0304319
</td>
<td style="text-align:right;">
0.0411679
</td>
<td style="text-align:right;">
0.9838851
</td>
<td style="text-align:right;">
-0.0046000
</td>
<td style="text-align:right;">
0.0251457
</td>
<td style="text-align:right;">
-0.4496709
</td>
<td style="text-align:right;">
0.2316894
</td>
<td style="text-align:right;">
-0.6268291
</td>
<td style="text-align:right;">
0.4251541
</td>
<td style="text-align:right;">
0.5297938
</td>
<td style="text-align:right;">
-237.3565
</td>
<td style="text-align:right;">
0.5135135
</td>
</tr>
<tr>
<td style="text-align:left;">
8092
</td>
<td style="text-align:right;">
0.0492737
</td>
<td style="text-align:right;">
0.0597751
</td>
<td style="text-align:right;">
0.0342930
</td>
<td style="text-align:right;">
-0.3893976
</td>
<td style="text-align:right;">
0.2115787
</td>
<td style="text-align:right;">
-0.5704301
</td>
<td style="text-align:right;">
0.3632042
</td>
<td style="text-align:right;">
0.0364343
</td>
<td style="text-align:right;">
0.4302326
</td>
<td style="text-align:right;">
0.6666667
</td>
<td style="text-align:right;">
0.0492737
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.0518342
</td>
<td style="text-align:right;">
2.060077
</td>
<td style="text-align:right;">
0.4903475
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.4302326
</td>
<td style="text-align:right;">
0.6666667
</td>
<td style="text-align:right;">
0.0492737
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.0518342
</td>
<td style="text-align:right;">
2.060077
</td>
<td style="text-align:right;">
0.4903475
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.730452
</td>
<td style="text-align:right;">
1.372177
</td>
<td style="text-align:right;">
2.14
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.0038462
</td>
<td style="text-align:right;">
0.8604651
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.0038462
</td>
<td style="text-align:right;">
0.4302326
</td>
<td style="text-align:right;">
0.9898124
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.8604651
</td>
<td style="text-align:right;">
0.0341147
</td>
<td style="text-align:right;">
0.0341354
</td>
<td style="text-align:right;">
0.0365390
</td>
<td style="text-align:right;">
0.0372117
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0001881
</td>
<td style="text-align:right;">
0.0001881
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3185845
</td>
<td style="text-align:right;">
4.220036
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
1.518752
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
2.021841
</td>
<td style="text-align:right;">
83
</td>
<td style="text-align:right;">
2.060077
</td>
<td style="text-align:right;">
0.0832984
</td>
<td style="text-align:right;">
-0.0038462
</td>
<td style="text-align:right;">
0.0300268
</td>
<td style="text-align:right;">
0.4657903
</td>
<td style="text-align:right;">
0.9151588
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.730452
</td>
<td style="text-align:right;">
1.730452
</td>
<td style="text-align:right;">
1.730452
</td>
<td style="text-align:right;">
0.8604651
</td>
<td style="text-align:right;">
2.12
</td>
<td style="text-align:right;">
0.0585525
</td>
<td style="text-align:right;">
1.372177
</td>
<td style="text-align:right;">
2.19
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
1.372177
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0050092
</td>
<td style="text-align:right;">
0.0000396
</td>
<td style="text-align:right;">
-0.2684250
</td>
<td style="text-align:right;">
0.2925679
</td>
<td style="text-align:right;">
0.0553261
</td>
<td style="text-align:right;">
0.0348668
</td>
<td style="text-align:right;">
1.0518342
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0050092
</td>
<td style="text-align:right;">
0.0000396
</td>
<td style="text-align:right;">
-0.2684250
</td>
<td style="text-align:right;">
0.2925679
</td>
<td style="text-align:right;">
0.0553261
</td>
<td style="text-align:right;">
0.0348668
</td>
<td style="text-align:right;">
0.9898124
</td>
<td style="text-align:right;">
0.0597751
</td>
<td style="text-align:right;">
0.0342930
</td>
<td style="text-align:right;">
-0.3893976
</td>
<td style="text-align:right;">
0.2115787
</td>
<td style="text-align:right;">
-0.5704301
</td>
<td style="text-align:right;">
0.3632042
</td>
<td style="text-align:right;">
0.0612405
</td>
<td style="text-align:right;">
-221.3231
</td>
<td style="text-align:right;">
0.4903475
</td>
</tr>
<tr>
<td style="text-align:left;">
11608
</td>
<td style="text-align:right;">
0.0132114
</td>
<td style="text-align:right;">
0.0871615
</td>
<td style="text-align:right;">
0.0255899
</td>
<td style="text-align:right;">
-0.4106884
</td>
<td style="text-align:right;">
0.2075354
</td>
<td style="text-align:right;">
-0.5985913
</td>
<td style="text-align:right;">
0.3916844
</td>
<td style="text-align:right;">
0.0294703
</td>
<td style="text-align:right;">
0.4534884
</td>
<td style="text-align:right;">
0.6627907
</td>
<td style="text-align:right;">
0.0132114
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.2598454
</td>
<td style="text-align:right;">
2.068999
</td>
<td style="text-align:right;">
0.4555985
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4534884
</td>
<td style="text-align:right;">
0.6627907
</td>
<td style="text-align:right;">
0.0132114
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.2598454
</td>
<td style="text-align:right;">
2.068999
</td>
<td style="text-align:right;">
0.4555985
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.700044
</td>
<td style="text-align:right;">
1.349297
</td>
<td style="text-align:right;">
1.99
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
-0.0230769
</td>
<td style="text-align:right;">
0.8604651
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
-0.0230769
</td>
<td style="text-align:right;">
0.4534884
</td>
<td style="text-align:right;">
0.9883467
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.8604651
</td>
<td style="text-align:right;">
0.0296618
</td>
<td style="text-align:right;">
0.0234184
</td>
<td style="text-align:right;">
0.0294703
</td>
<td style="text-align:right;">
0.0225331
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0004471
</td>
<td style="text-align:right;">
0.0004471
</td>
<td style="text-align:right;">
0.5392591
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.2793480
</td>
<td style="text-align:right;">
4.939577
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
1.557270
</td>
<td style="text-align:right;">
129
</td>
<td style="text-align:right;">
2.896679
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
2.068999
</td>
<td style="text-align:right;">
0.1536187
</td>
<td style="text-align:right;">
-0.0230769
</td>
<td style="text-align:right;">
0.0169952
</td>
<td style="text-align:right;">
0.4226084
</td>
<td style="text-align:right;">
0.8772755
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.700044
</td>
<td style="text-align:right;">
1.700044
</td>
<td style="text-align:right;">
1.700044
</td>
<td style="text-align:right;">
0.8604651
</td>
<td style="text-align:right;">
1.89
</td>
<td style="text-align:right;">
0.0920472
</td>
<td style="text-align:right;">
1.349297
</td>
<td style="text-align:right;">
1.85
</td>
<td style="text-align:right;">
1.26
</td>
<td style="text-align:right;">
1.349297
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0328743
</td>
<td style="text-align:right;">
0.0000349
</td>
<td style="text-align:right;">
-0.6546339
</td>
<td style="text-align:right;">
1.9520871
</td>
<td style="text-align:right;">
0.0587741
</td>
<td style="text-align:right;">
0.0331659
</td>
<td style="text-align:right;">
0.2598454
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0328743
</td>
<td style="text-align:right;">
0.0000349
</td>
<td style="text-align:right;">
-0.6546339
</td>
<td style="text-align:right;">
1.9520871
</td>
<td style="text-align:right;">
0.0587741
</td>
<td style="text-align:right;">
0.0331659
</td>
<td style="text-align:right;">
0.9883467
</td>
<td style="text-align:right;">
0.0871615
</td>
<td style="text-align:right;">
0.0255899
</td>
<td style="text-align:right;">
-0.4106884
</td>
<td style="text-align:right;">
0.2075354
</td>
<td style="text-align:right;">
-0.5985913
</td>
<td style="text-align:right;">
0.3916844
</td>
<td style="text-align:right;">
0.2347272
</td>
<td style="text-align:right;">
-226.3638
</td>
<td style="text-align:right;">
0.4555985
</td>
</tr>
<tr>
<td style="text-align:left;">
510
</td>
<td style="text-align:right;">
-0.0003526
</td>
<td style="text-align:right;">
-0.0377842
</td>
<td style="text-align:right;">
0.0610169
</td>
<td style="text-align:right;">
-0.4503454
</td>
<td style="text-align:right;">
0.3209396
</td>
<td style="text-align:right;">
-0.6010193
</td>
<td style="text-align:right;">
0.5016447
</td>
<td style="text-align:right;">
0.1103354
</td>
<td style="text-align:right;">
0.5173745
</td>
<td style="text-align:right;">
0.6718147
</td>
<td style="text-align:right;">
-0.0003526
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.0632435
</td>
<td style="text-align:right;">
2.064176
</td>
<td style="text-align:right;">
0.5057915
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5173745
</td>
<td style="text-align:right;">
0.6718147
</td>
<td style="text-align:right;">
-0.0003526
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.0632435
</td>
<td style="text-align:right;">
2.064176
</td>
<td style="text-align:right;">
0.5057915
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.681537
</td>
<td style="text-align:right;">
1.443304
</td>
<td style="text-align:right;">
1.56
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0307692
</td>
<td style="text-align:right;">
0.1860465
</td>
<td style="text-align:right;">
129
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0307692
</td>
<td style="text-align:right;">
0.5173745
</td>
<td style="text-align:right;">
0.9818784
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.1860465
</td>
<td style="text-align:right;">
0.1470449
</td>
<td style="text-align:right;">
0.0463545
</td>
<td style="text-align:right;">
0.1067343
</td>
<td style="text-align:right;">
0.0460646
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0002208
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.8224410
</td>
<td style="text-align:right;">
5.448022
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
1.460865
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
4.190547
</td>
<td style="text-align:right;">
218
</td>
<td style="text-align:right;">
2.064176
</td>
<td style="text-align:right;">
0.0642516
</td>
<td style="text-align:right;">
0.0307692
</td>
<td style="text-align:right;">
0.0449687
</td>
<td style="text-align:right;">
0.5611985
</td>
<td style="text-align:right;">
1.0943716
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.681537
</td>
<td style="text-align:right;">
1.681537
</td>
<td style="text-align:right;">
1.681537
</td>
<td style="text-align:right;">
0.1860465
</td>
<td style="text-align:right;">
1.59
</td>
<td style="text-align:right;">
0.1165652
</td>
<td style="text-align:right;">
1.443304
</td>
<td style="text-align:right;">
1.44
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.443304
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0140109
</td>
<td style="text-align:right;">
0.0000469
</td>
<td style="text-align:right;">
0.9051600
</td>
<td style="text-align:right;">
1.1716687
</td>
<td style="text-align:right;">
-0.0525826
</td>
<td style="text-align:right;">
0.0687406
</td>
<td style="text-align:right;">
1.0632435
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0140109
</td>
<td style="text-align:right;">
0.0000469
</td>
<td style="text-align:right;">
0.9051600
</td>
<td style="text-align:right;">
1.1716687
</td>
<td style="text-align:right;">
-0.0525826
</td>
<td style="text-align:right;">
0.0687406
</td>
<td style="text-align:right;">
0.9818784
</td>
<td style="text-align:right;">
-0.0377842
</td>
<td style="text-align:right;">
0.0610169
</td>
<td style="text-align:right;">
-0.4503454
</td>
<td style="text-align:right;">
0.3209396
</td>
<td style="text-align:right;">
-0.6010193
</td>
<td style="text-align:right;">
0.5016447
</td>
<td style="text-align:right;">
0.1743573
</td>
<td style="text-align:right;">
-254.8196
</td>
<td style="text-align:right;">
0.5057915
</td>
</tr>
<tr>
<td style="text-align:left;">
6691
</td>
<td style="text-align:right;">
0.0381705
</td>
<td style="text-align:right;">
-0.1159988
</td>
<td style="text-align:right;">
0.0461471
</td>
<td style="text-align:right;">
-0.5098657
</td>
<td style="text-align:right;">
0.3030327
</td>
<td style="text-align:right;">
-0.6710932
</td>
<td style="text-align:right;">
0.5566086
</td>
<td style="text-align:right;">
0.1285934
</td>
<td style="text-align:right;">
0.5212355
</td>
<td style="text-align:right;">
0.7335907
</td>
<td style="text-align:right;">
0.0381705
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.7906201
</td>
<td style="text-align:right;">
2.067114
</td>
<td style="text-align:right;">
0.4903475
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5212355
</td>
<td style="text-align:right;">
0.7335907
</td>
<td style="text-align:right;">
0.0381705
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.7906201
</td>
<td style="text-align:right;">
2.067114
</td>
<td style="text-align:right;">
0.4903475
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.537979
</td>
<td style="text-align:right;">
1.486248
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
-0.3923077
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
-0.3923077
</td>
<td style="text-align:right;">
0.5212355
</td>
<td style="text-align:right;">
0.9853498
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.0787333
</td>
<td style="text-align:right;">
0.0628511
</td>
<td style="text-align:right;">
0.0832518
</td>
<td style="text-align:right;">
0.0642555
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.0003256
</td>
<td style="text-align:right;">
0.0003256
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.8821239
</td>
<td style="text-align:right;">
9.186446
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
1.051163
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
4.316605
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
2.067114
</td>
<td style="text-align:right;">
0.0745460
</td>
<td style="text-align:right;">
-0.3923077
</td>
<td style="text-align:right;">
0.0319358
</td>
<td style="text-align:right;">
0.5197226
</td>
<td style="text-align:right;">
1.0310709
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.537979
</td>
<td style="text-align:right;">
1.537979
</td>
<td style="text-align:right;">
1.537979
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
1.26
</td>
<td style="text-align:right;">
0.0364267
</td>
<td style="text-align:right;">
1.486248
</td>
<td style="text-align:right;">
1.26
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.486248
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0003187
</td>
<td style="text-align:right;">
0.0000630
</td>
<td style="text-align:right;">
0.1736309
</td>
<td style="text-align:right;">
-0.1242825
</td>
<td style="text-align:right;">
-0.1159053
</td>
<td style="text-align:right;">
0.0459614
</td>
<td style="text-align:right;">
-0.7906201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0003187
</td>
<td style="text-align:right;">
0.0000630
</td>
<td style="text-align:right;">
0.1736309
</td>
<td style="text-align:right;">
-0.1242825
</td>
<td style="text-align:right;">
-0.1159053
</td>
<td style="text-align:right;">
0.0459614
</td>
<td style="text-align:right;">
0.9853498
</td>
<td style="text-align:right;">
-0.1159988
</td>
<td style="text-align:right;">
0.0461471
</td>
<td style="text-align:right;">
-0.5098657
</td>
<td style="text-align:right;">
0.3030327
</td>
<td style="text-align:right;">
-0.6710932
</td>
<td style="text-align:right;">
0.5566086
</td>
<td style="text-align:right;">
0.0217238
</td>
<td style="text-align:right;">
-257.2330
</td>
<td style="text-align:right;">
0.4903475
</td>
</tr>
</tbody>
</table>
</div>
<div id="how-the-training-y-predictor-variable-data-looks" class="section level3">
<h3>How the training Y (predictor variable) data looks:</h3>
<table class="table table-hover table-condensed table-responsive" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-24">Table 6: </span>Y_train
</caption>
<thead>
<tr>
<th style="text-align:right;">
.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>I set the data up for an XGBoost model:</p>
<p>I create a grid search in order search over a parameter space to locate the optimal parameters for the data set. It needs a little more work but it’s a pretty good starting point. I can just add code to the <code>expand.grid</code> function. That is, say I want to increase the depth of the tree I can add to <code>max_depth = c(5, 8, 14)</code> more parameters such as <code>max_depth = c(5, 8, 14, 1, 2, 3, 4, 6, 7)</code>. <strong>Note</strong> Adding parameters to the grid search increases computational time exponentially. Every parameter you add a value to, the model has to search all possible combinations associated with that parameter. That is, adding an <code>eta = c(0.1)</code> and <code>max_depth = c(5)</code> would give me the optimal parameter for one iteration/loop through the training model, i.e. an <code>eta = c(0.1)</code> mapped onto a <code>max_depth = c(5)</code>. Adding an additional value to the <code>eta = c(0.1, 0.3)</code> and <code>max_depth = c(5)</code> would map <code>eta = 0.1</code> onto <code>max_depth = 5</code> and <code>eta = 0.3</code> on to <code>max_depth = 5</code>. If I add another value such that <code>eta = c(0.1, 0.3, 0.4)</code> then all 3 of these values will be mapped to <code>max_depth = c(5)</code>. Adding values t the <code>max_depth = c(5)</code> parameter would add an extra layer of complexity to the grid search. This added into the fact that there are many parameters to optimize in an XGBoost model can drastically increase computational complexity. Thus, understanding the statistics behind the models in Machine Learning is important when trying to avoid getting stuck in a local minimum (which any greedy algorithm using gradient descent optimisation can do <a href="https://en.wikipedia.org/wiki/Greedy_algorithm">greedy algorithm</a>).</p>
<pre class="r"><code>######################################################################
################# XGBoost Grid Search to locate Optimal Parameters ###

##############################################################################################################################
# NOTE: This section was taken from the first chapter of my PhD where I needed to search over a parameter space to locate the
# most optimal parameters - I have just adapted it for this problem of Time Series Classification.
# Its simple enough to add parameters and different values - I just optimise a few important parameters from domain knowledge
# of the XGBoost model for this task, i.e depth and eta are quite important in gradient boosting.

# 1) I create a &quot;grid&quot; with different parameter values or combinations of parameter values
# 2) I apply cross validation over the parameter space to fine the most optimal values for the XGBoost model.
# 3) I print the model parameters which give the best train / (in-sample test) results in a data table.
##############################################################################################################################

# Grid Search Parameters:
# 1)
searchGridSubCol &lt;- expand.grid(subsample = c(1), #Range (0,1], default = 1, set to 0.5 will prevent overfitting
                                colsample_bytree = c(1), #Range (0,1], default = 1
                                max_depth = c(5, 8, 14), #Range (0, inf], default = 6
                                min_child = c(1), #Range (0, inf], default = 1
                                eta = c(0.1, 0.05, 0.3), #Range (0,1], default = 0.3
                                gamma = c(0), #Range (0, inf], default = 0
                                lambda = c(1), #Default = 1, L2 regularisation on weights, higher the more conservative the model
                                alpha = c(0), #Default = 0, L1 regularisation on weights, higher the more conservative the model
                                max_delta_step = c(0), #Range (0, inf], default = 0 (Helpful for logisitc regression when class is extremely imbalanced, set to value 1-10 may help control the update)
                                colsample_bylevel = c(1) #Range (0,1], default = 1
                                )

ntrees = 200
nfold &lt;- 10                             # I use nfold = 10 which is probably too many folds, 5 should be sufficient.
watchlist &lt;- list(train = dtrain, test = dval)

# 2)
system.time(
  AUCHyperparameters &lt;- apply(searchGridSubCol, 1, function(parameterList){
    #Extract Parameters to test
    currentSubsampleRate &lt;- parameterList[[&quot;sub_sample&quot;]]
    currentColsampleRate &lt;- parameterList[[&quot;colsample_bytree&quot;]]
    currentDepth &lt;- parameterList[[&quot;max_depth&quot;]]
    currentEta &lt;- parameterList[[&quot;eta&quot;]]
    currentMinChild &lt;- parameterList[[&quot;min_child&quot;]]
    gamma &lt;- parameterList[[&quot;gamma&quot;]]
    lambda &lt;- parameterList[[&quot;lambda&quot;]]
    alpha &lt;- parameterList[[&quot;alpha&quot;]]
    max_delta_step &lt;- parameterList[[&quot;max_delta_step&quot;]]
    colsample_bylevel &lt;- parameterList[[&quot;colsample_bylevel&quot;]]
    xgboostModelCV &lt;- xgb.cv(data =  dtrain,
                             nrounds = ntrees,
                             nfold = nfold,
                             showsd = TRUE,
                             metrics = c(&quot;auc&quot;, &quot;logloss&quot;, &quot;error&quot;),
                             verbose = TRUE,
                             &quot;eval_metric&quot; = c(&quot;auc&quot;, &quot;logloss&quot;, &quot;error&quot;),
                             &quot;objective&quot; = &quot;binary:logistic&quot;, #Outputs a probability &quot;binary:logitraw&quot; - outputs score before logistic transformation
                             &quot;max.depth&quot; = currentDepth,
                             &quot;eta&quot; = currentEta,
                             &quot;gamma&quot; = gamma,
                             &quot;lambda&quot; = lambda,
                             &quot;alpha&quot; = alpha,
                             &quot;subsample&quot; = currentSubsampleRate,
                             &quot;colsample_bytree&quot; = currentColsampleRate,
                             print_every_n = 50, # print ever 50 trees to reduce the outputs printed.
                             &quot;min_child_weight&quot; = currentMinChild,
                             booster = &quot;gbtree&quot;, #booster = &quot;dart&quot;  #using dart can help improve accuracy.
                             early_stopping_rounds = 10,
                             watchlist = watchlist,
                             seed = 1234)
    xvalidationScores &lt;&lt;- as.data.frame(xgboostModelCV$evaluation_log)
    train_auc_mean &lt;- tail(xvalidationScores$train_auc_mean, 1)
    test_auc_mean &lt;- tail(xvalidationScores$test_auc_mean, 1)
    train_logloss_mean &lt;- tail(xvalidationScores$train_logloss_mean, 1)
    test_logloss_mean &lt;- tail(xvalidationScores$test_logloss_mean, 1)
    train_error_mean &lt;- tail(xvalidationScores$train_error_mean, 1)
    test_error_mean &lt;- tail(xvalidationScores$test_error_mean, 1)
    output &lt;- return(c(train_auc_mean, test_auc_mean, train_logloss_mean, test_logloss_mean, train_error_mean, test_error_mean, xvalidationScores, currentSubsampleRate, currentColsampleRate, currentDepth, currentEta, gamma, lambda, alpha, max_delta_step, colsample_bylevel, currentMinChild))
    hypemeans &lt;- which.max(AUCHyperparameters[[1]]$test_auc_mean)
    output2 &lt;- return(hypemeans)
    }))</code></pre>
<p>The problem with the <code>AUCHyperparameters()</code> function is that I just take the <code>tail()</code> results when I should be extracting the optimal parameters better.</p>
<p>The output of the grid search can be set into a nice data frame using the following code. However I did not save this output to file and therefore cannot read it in. You can view the output on the original Jupyter Notebook <code>In [49]</code> <a href="https://nbviewer.jupyter.org/github/msmith01/time_series_detection/blob/master/Time_Series_Classification_Financial_Markets.ipynb">here</a></p>
<pre class="r"><code># 3)
output &lt;- as.data.frame(t(sapply(AUCHyperparameters, &#39;[&#39;, c(1:6, 20:29))))
varnames &lt;- c(&quot;TrainAUC&quot;, &quot;TestAUC&quot;, &quot;TrainLogloss&quot;, &quot;TestLogloss&quot;, &quot;TrainError&quot;, &quot;TestError&quot;, &quot;SubSampRate&quot;, &quot;ColSampRate&quot;, &quot;Depth&quot;, &quot;eta&quot;, &quot;gamma&quot;, &quot;lambda&quot;, &quot;alpha&quot;, &quot;max_delta_step&quot;, &quot;col_sample_bylevel&quot;, &quot;currentMinChild&quot;)
colnames(output) &lt;- varnames
data.table(output)</code></pre>
<p>According to the results at the time the optimal parameters were:</p>
<ul>
<li>ntrees = 95,</li>
<li>eta = 0.1,</li>
<li>max_depth = 5,</li>
</ul>
<p>With the other parameters left to default settings for simplicity.</p>
<p>Now that I have the optimal parameters from the grid search I can train an XGBoost model on the training data set and plug these optimal values into the <code>params</code> list:</p>
<pre class="r"><code>#################################################################################
################# XGBoost Optimal Parameters from Cross Validation ##############

# This is the final training model where I use the most optimal parameters found over the grid space and plug them in here.

watchlist &lt;- list(&quot;train&quot; = dtrain)

params &lt;- list(&quot;eta&quot; = 0.1, &quot;max_depth&quot; = 5, &quot;colsample_bytree&quot; = 1, &quot;min_child_weight&quot; = 1, &quot;subsample&quot;= 1,
               &quot;objective&quot;=&quot;binary:logistic&quot;, &quot;gamma&quot; = 1, &quot;lambda&quot; = 1, &quot;alpha&quot; = 0, &quot;max_delta_step&quot; = 0,
               &quot;colsample_bylevel&quot; = 1, &quot;eval_metric&quot;= &quot;auc&quot;,
               &quot;set.seed&quot; = 176)

nround &lt;- 95</code></pre>
<p>Now that I have the optimal parameters from the cross validation grid search I can train the final XGBoost model on the whole <code>train_val.csv</code> data set. (Whereas before the optimal parameters were obtained from different <em>folds</em> in the model. More info on k-fold cross validation <a href="https://machinelearningmastery.com/k-fold-cross-validation/">here</a>)</p>
<pre class="r"><code># Train the XGBoost model

xgb.model &lt;- xgb.train(params, dtrain, nround, watchlist)</code></pre>
<pre><code>## [1]  train-auc:0.714426 
## [2]  train-auc:0.729142 
## [3]  train-auc:0.736365 
## [4]  train-auc:0.736480 
## [5]  train-auc:0.740435 
## [6]  train-auc:0.747570 
## [7]  train-auc:0.750461 
## [8]  train-auc:0.751053 
## [9]  train-auc:0.753416 
## [10] train-auc:0.754922 
## [11] train-auc:0.758318 
## [12] train-auc:0.762715 
## [13] train-auc:0.768562 
## [14] train-auc:0.771517 
## [15] train-auc:0.777371 
## [16] train-auc:0.781109 
## [17] train-auc:0.786178 
## [18] train-auc:0.787234 
## [19] train-auc:0.789113 
## [20] train-auc:0.789895 
## [21] train-auc:0.793477 
## [22] train-auc:0.797145 
## [23] train-auc:0.801051 
## [24] train-auc:0.802369 
## [25] train-auc:0.804017 
## [26] train-auc:0.806691 
## [27] train-auc:0.809834 
## [28] train-auc:0.810924 
## [29] train-auc:0.813256 
## [30] train-auc:0.815922 
## [31] train-auc:0.818918 
## [32] train-auc:0.822677 
## [33] train-auc:0.823239 
## [34] train-auc:0.826781 
## [35] train-auc:0.828596 
## [36] train-auc:0.830481 
## [37] train-auc:0.832719 
## [38] train-auc:0.833975 
## [39] train-auc:0.835065 
## [40] train-auc:0.837999 
## [41] train-auc:0.838804 
## [42] train-auc:0.840867 
## [43] train-auc:0.842305 
## [44] train-auc:0.845838 
## [45] train-auc:0.846856 
## [46] train-auc:0.847804 
## [47] train-auc:0.848753 
## [48] train-auc:0.850509 
## [49] train-auc:0.852288 
## [50] train-auc:0.853215 
## [51] train-auc:0.855375 
## [52] train-auc:0.856389 
## [53] train-auc:0.857311 
## [54] train-auc:0.859108 
## [55] train-auc:0.860308 
## [56] train-auc:0.862775 
## [57] train-auc:0.863775 
## [58] train-auc:0.864729 
## [59] train-auc:0.866562 
## [60] train-auc:0.869064 
## [61] train-auc:0.869937 
## [62] train-auc:0.872062 
## [63] train-auc:0.874444 
## [64] train-auc:0.874764 
## [65] train-auc:0.875546 
## [66] train-auc:0.878003 
## [67] train-auc:0.878945 
## [68] train-auc:0.880739 
## [69] train-auc:0.881206 
## [70] train-auc:0.882062 
## [71] train-auc:0.884013 
## [72] train-auc:0.884744 
## [73] train-auc:0.885277 
## [74] train-auc:0.885732 
## [75] train-auc:0.886967 
## [76] train-auc:0.887653 
## [77] train-auc:0.889016 
## [78] train-auc:0.890733 
## [79] train-auc:0.892101 
## [80] train-auc:0.892657 
## [81] train-auc:0.894606 
## [82] train-auc:0.895111 
## [83] train-auc:0.895790 
## [84] train-auc:0.896699 
## [85] train-auc:0.897570 
## [86] train-auc:0.897915 
## [87] train-auc:0.898833 
## [88] train-auc:0.900800 
## [89] train-auc:0.901483 
## [90] train-auc:0.902972 
## [91] train-auc:0.903630 
## [92] train-auc:0.903967 
## [93] train-auc:0.905149 
## [94] train-auc:0.906120 
## [95] train-auc:0.907548</code></pre>
<pre class="r"><code># Note: Plot AUC on for the in-sample train / validation scores -  this was a note for me at the time of writing this R file - I never did get around to plotting the AUC for the in-sample train / validation scores...</code></pre>
<p>What is nice about tree based models is that we can obtain <em>importance</em> scores from the model and find which variables contributed most to the <em>gain</em> in the model. The original paper explains more about the <em>gain</em> in <em>Algorithm 1</em> and <em>Algorithm 3</em> <a href="https://arxiv.org/pdf/1603.02754.pdf">here</a>.</p>
<pre class="r"><code># We can obtain &quot;feature&quot; importance results from the model.
xgb.imp &lt;- xgb.importance(model = xgb.model)
xgb.plot.importance(xgb.imp, top_n = 10)</code></pre>
<p><img src="/post/synth-real-time-series/synth_real_time_series_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>That is, the XGBoost model found that the <code>spike</code> was the most important variable. The <code>spike</code> comes from the <code>stl_features</code> function of the <code>tsfeatures</code> package in <code>R</code>. It computes various measures of trend and seasonality based on Seasonal and Trend Decomposition (STL) decomposition and measures the <code>spikiness</code> of a time series based on the variance of the leave-one-out variances of component <code>e_t</code>.</p>
<p>The second variable is interesting also and comes from the <code>compengine feature set</code> from the <a href="https://www.comp-engine.org/">CompEngine</a> database. It groups variables as <em>autocorrelation</em>, <em>prediction</em>, <em>stationarity</em>, <em>distribution</em> and <em>scaling</em>.</p>
<p>The <code>ARCH.LM</code> comes from the <code>arch_stat</code> function of the <code>tsfeatures</code> package and is based on the Lagrange Multiplier for Autoregressive Conditional Heteroscedasticity (ARCH) <a href="https://www.jstor.org/stable/1912773?origin=crossref&amp;seq=1#page_scan_tab_contents">Engle 1982</a>.</p>
<p>These are just a few of the variables the XGBoost model found to be the most <em>important</em>. A full overview and more information of the variables used in the model can be found <a href="https://cran.r-project.org/web/packages/tsfeatures/vignettes/tsfeatures.html">here</a>.</p>
</div>
<div id="predictions-using-the-in-sample-test-set" class="section level3">
<h3>Predictions using the in-sample test set</h3>
<p>Now that I have trained the model using the optimal parameters I want to see if it scores the same or better based on the cross validation phase using the <em>validation</em> data. I use the <code>dval</code> which is the <em>validation</em> data set from the <em>training split</em> to test the model.</p>
<pre class="r"><code># I next make the predictions on the &#39;in-sample&#39; held out test set, that is, originally I took the 12,000 training samples
# and split them between 75% training and 25% &#39;in-sample&#39; testing (9000 training vs 3000 in-sample testing)

# I plot the probabilities from the model - the &quot;dashed&quot; line is the average predicted probability.
xgb.pred &lt;- predict(xgb.model, dval, type = &#39;prob&#39;)

results &lt;- cbind(y_val, xgb.pred)

results %&gt;%
 as.tibble() %&gt;%
 ggplot(aes(x = xgb.pred)) + 
 geom_density(color = &quot;darkblue&quot;, fill = &quot;lightblue&quot;) +
 geom_vline(aes(xintercept = mean(xgb.pred)),
            color = &quot;blue&quot;, linetype = &quot;dashed&quot;, size = 1) +
 geom_histogram(aes(y = ..density..), colour = &quot;black&quot;, fill = &quot;white&quot;, alpha = 0.1, position = &quot;identity&quot;) +
 ggtitle(&quot;Predicted probability density plot&quot;) +
 theme_tq()</code></pre>
<p><img src="/post/synth-real-time-series/synth_real_time_series_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<pre class="r"><code># The average predicted probability sits around 0.48 / 0.49, for simplicity I will just select 0.50 as the cut off threshold.
# That is, all observations &lt;= 0.50 are assigned a &quot;0&quot; class or &quot;synthetic&quot; data and all observations &gt;= are assigned a &quot;1&quot; or
# &quot;real&quot; data.
# Finally I output the confusion matrix on the &#39;in-sample&#39; testing data.

results &lt;- results %&gt;%
  as_tibble() %&gt;%
  mutate(pred = case_when(
    xgb.pred &gt; 0.5 ~ 1,
    xgb.pred &lt;= 0.5 ~ 0
  ))

confusionMatrix(factor(results$pred), factor(results$y_val))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    0    1
##          0 1087  564
##          1  394  955
##                                                
##                Accuracy : 0.6807               
##                  95% CI : (0.6636, 0.6973)     
##     No Information Rate : 0.5063               
##     P-Value [Acc &gt; NIR] : &lt; 0.00000000000000022
##                                                
##                   Kappa : 0.3621               
##                                                
##  Mcnemar&#39;s Test P-Value : 0.00000004758        
##                                                
##             Sensitivity : 0.7340               
##             Specificity : 0.6287               
##          Pos Pred Value : 0.6584               
##          Neg Pred Value : 0.7079               
##              Prevalence : 0.4937               
##          Detection Rate : 0.3623               
##    Detection Prevalence : 0.5503               
##       Balanced Accuracy : 0.6813               
##                                                
##        &#39;Positive&#39; Class : 0                    
## </code></pre>
<p>A balanced accuracy score of 67% isn’t so bad considering I threw the kitchen sink at the classification problem and that this is a time series (stock market) classification problem. By kitchen sink I refer to all the time series functions found in the <code>tsfeatures</code> package.</p>
<p>From here I end the training and validation model. I have obtained the optimal values based on the training and validation data sets and now I want to test it on the unknown data the <code>test.csv</code> data.</p>
<p>I read in the test data and compute the time series features from the <code>tsfeatures</code> package just as I did with the training data.</p>
<pre class="r"><code> test_final &lt;- read.csv(&quot;C:/Users/Matt/Desktop/Data Science Challenge/test.csv&quot;) %&gt;%
   mutate(row_id = row_number()) %&gt;%
   melt(., measure.vars = 1:260) %&gt;%
   arrange(row_id)</code></pre>
</div>
<div id="how-the-test-features-look---they-look-similar-to-the-train-data-set" class="section level3">
<h3>How the test features look - (they look similar to the train data set):</h3>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-34">Table 7: </span>Test feature data set
</caption>
<thead>
<tr>
<th style="text-align:right;">
row_id
</th>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
feature1
</td>
<td style="text-align:right;">
0.0331039
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
feature2
</td>
<td style="text-align:right;">
0.0086225
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
feature3
</td>
<td style="text-align:right;">
0.0040622
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
feature4
</td>
<td style="text-align:right;">
0.0082554
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
feature5
</td>
<td style="text-align:right;">
0.0558741
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
feature6
</td>
<td style="text-align:right;">
-0.0061266
</td>
</tr>
</tbody>
</table>
<p>I call this <code>test_final</code> and not <code>test</code> for no reason what so ever - its the same <code>test.csv</code> from the beginning.</p>
<p>Next I create the same time series features on the test data set as I do on the training data set. I save this as <code>TSfeatures_test.csv</code>.</p>
<pre class="r"><code>functions &lt;- sample(functions, 20)

test_final &lt;- test_final %&gt;%
  group_by(row_id) %&gt;%
#  nest() %&gt;%
#  sample_n(5) %&gt;%
#  ungroup() %&gt;%
#  unnest() %&gt;%
  nest(-row_id) %&gt;%
  group_by(row_id) %T&gt;%
  {options(warn = -1)} %&gt;%
  summarise(Statistics = map(data, ~ data.frame(
    bind_cols(
      tsfeatures(.x$value, functions))))) %&gt;%
  unnest(Statistics)

#print(&quot;Generated 106 Time Series features&quot;)
#write.csv(test_final, &quot;TSfeatures_test.csv&quot;)</code></pre>
<p>I have computed all the <code>tsfeatures</code> for the <code>train</code> data set and also for the <code>test</code> data set. I saved these two as <code>TSfeatures_train_val.csv</code> and <code>TSfeatures_test.csv</code>.</p>
<div id="load-in-the-train-and-test-features-data-sets" class="section level4">
<h4>Load in the train and test features data sets</h4>
<pre class="r"><code># I have already created the features for the training dataset so I can just load them right back in as 
train_final &lt;- read.csv(&quot;C:/Users/Matt/Desktop/Data Science Challenge/TSfeatures_train_val.csv&quot;)
test_final &lt;- read.csv(&quot;C:/Users/Matt/Desktop/Data Science Challenge/TSfeatures_test.csv&quot;)</code></pre>
<p>The final data for the training and test looks like:</p>
<pre class="r"><code>train_final %&gt;%
  head() %&gt;%
  kable(caption = &quot;Final training data set&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), font_size = 12)</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-37">Table 8: </span>Final training data set
</caption>
<thead>
<tr>
<th style="text-align:right;">
X
</th>
<th style="text-align:right;">
row_id
</th>
<th style="text-align:right;">
class
</th>
<th style="text-align:right;">
ac_9_ac_9
</th>
<th style="text-align:right;">
acf_features_x_acf1
</th>
<th style="text-align:right;">
acf_features_x_acf10
</th>
<th style="text-align:right;">
acf_features_diff1_acf1
</th>
<th style="text-align:right;">
acf_features_diff1_acf10
</th>
<th style="text-align:right;">
acf_features_diff2_acf1
</th>
<th style="text-align:right;">
acf_features_diff2_acf10
</th>
<th style="text-align:right;">
ARCH.LM
</th>
<th style="text-align:right;">
autocorr_features_embed2_incircle_1
</th>
<th style="text-align:right;">
autocorr_features_embed2_incircle_2
</th>
<th style="text-align:right;">
autocorr_features_ac_9
</th>
<th style="text-align:right;">
autocorr_features_firstmin_ac
</th>
<th style="text-align:right;">
autocorr_features_trev_num
</th>
<th style="text-align:right;">
autocorr_features_motiftwo_entro3
</th>
<th style="text-align:right;">
autocorr_features_walker_propcross
</th>
<th style="text-align:right;">
binarize_mean_binarize_mean
</th>
<th style="text-align:right;">
binarize_mean_NA
</th>
<th style="text-align:right;">
compengine_embed2_incircle_1
</th>
<th style="text-align:right;">
compengine_embed2_incircle_2
</th>
<th style="text-align:right;">
compengine_ac_9
</th>
<th style="text-align:right;">
compengine_firstmin_ac
</th>
<th style="text-align:right;">
compengine_trev_num
</th>
<th style="text-align:right;">
compengine_motiftwo_entro3
</th>
<th style="text-align:right;">
compengine_walker_propcross
</th>
<th style="text-align:right;">
compengine_localsimple_mean1
</th>
<th style="text-align:right;">
compengine_localsimple_lfitac
</th>
<th style="text-align:right;">
compengine_sampen_first
</th>
<th style="text-align:right;">
compengine_std1st_der
</th>
<th style="text-align:right;">
compengine_spreadrandomlocal_meantaul_50
</th>
<th style="text-align:right;">
compengine_spreadrandomlocal_meantaul_ac2
</th>
<th style="text-align:right;">
compengine_histogram_mode_10
</th>
<th style="text-align:right;">
compengine_outlierinclude_mdrmd
</th>
<th style="text-align:right;">
compengine_fluctanal_prop_r1
</th>
<th style="text-align:right;">
crossing_points
</th>
<th style="text-align:right;">
dist_features_histogram_mode_10
</th>
<th style="text-align:right;">
dist_features_outlierinclude_mdrmd
</th>
<th style="text-align:right;">
embed2_incircle
</th>
<th style="text-align:right;">
entropy
</th>
<th style="text-align:right;">
firstmin_ac
</th>
<th style="text-align:right;">
firstzero_ac
</th>
<th style="text-align:right;">
flat_spots
</th>
<th style="text-align:right;">
fluctanal_prop_r1_fluctanal_prop_r1
</th>
<th style="text-align:right;">
arch_acf
</th>
<th style="text-align:right;">
garch_acf
</th>
<th style="text-align:right;">
arch_r2
</th>
<th style="text-align:right;">
garch_r2
</th>
<th style="text-align:right;">
histogram_mode
</th>
<th style="text-align:right;">
alpha
</th>
<th style="text-align:right;">
beta
</th>
<th style="text-align:right;">
hurst
</th>
<th style="text-align:left;">
hw_parameters_hw_parameters
</th>
<th style="text-align:left;">
hw_parameters_NA
</th>
<th style="text-align:right;">
localsimple_taures
</th>
<th style="text-align:right;">
lumpiness
</th>
<th style="text-align:right;">
max_kl_shift
</th>
<th style="text-align:right;">
time_kl_shift
</th>
<th style="text-align:right;">
max_level_shift
</th>
<th style="text-align:right;">
time_level_shift
</th>
<th style="text-align:right;">
max_var_shift
</th>
<th style="text-align:right;">
time_var_shift
</th>
<th style="text-align:right;">
motiftwo_entro3
</th>
<th style="text-align:right;">
nonlinearity
</th>
<th style="text-align:right;">
outlierinclude_mdrmd
</th>
<th style="text-align:right;">
x_pacf5
</th>
<th style="text-align:right;">
diff1x_pacf5
</th>
<th style="text-align:right;">
diff2x_pacf5
</th>
<th style="text-align:right;">
pred_features_localsimple_mean1
</th>
<th style="text-align:right;">
pred_features_localsimple_lfitac
</th>
<th style="text-align:right;">
pred_features_sampen_first
</th>
<th style="text-align:right;">
sampen_first_sampen_first
</th>
<th style="text-align:right;">
sampenc
</th>
<th style="text-align:right;">
scal_features_fluctanal_prop_r1
</th>
<th style="text-align:right;">
spreadrandomlocal_meantaul
</th>
<th style="text-align:right;">
stability
</th>
<th style="text-align:right;">
station_features_std1st_der
</th>
<th style="text-align:right;">
station_features_spreadrandomlocal_meantaul_50
</th>
<th style="text-align:right;">
station_features_spreadrandomlocal_meantaul_ac2
</th>
<th style="text-align:right;">
std1st_der_std1st_der
</th>
<th style="text-align:right;">
nperiods
</th>
<th style="text-align:right;">
seasonal_period
</th>
<th style="text-align:right;">
trend
</th>
<th style="text-align:right;">
spike
</th>
<th style="text-align:right;">
linearity
</th>
<th style="text-align:right;">
curvature
</th>
<th style="text-align:right;">
e_acf1
</th>
<th style="text-align:right;">
e_acf10
</th>
<th style="text-align:right;">
trev_num
</th>
<th style="text-align:right;">
tsfeatures_frequency
</th>
<th style="text-align:right;">
tsfeatures_nperiods
</th>
<th style="text-align:right;">
tsfeatures_seasonal_period
</th>
<th style="text-align:right;">
tsfeatures_trend
</th>
<th style="text-align:right;">
tsfeatures_spike
</th>
<th style="text-align:right;">
tsfeatures_linearity
</th>
<th style="text-align:right;">
tsfeatures_curvature
</th>
<th style="text-align:right;">
tsfeatures_e_acf1
</th>
<th style="text-align:right;">
tsfeatures_e_acf10
</th>
<th style="text-align:right;">
tsfeatures_entropy
</th>
<th style="text-align:right;">
tsfeatures_x_acf1
</th>
<th style="text-align:right;">
tsfeatures_x_acf10
</th>
<th style="text-align:right;">
tsfeatures_diff1_acf1
</th>
<th style="text-align:right;">
tsfeatures_diff1_acf10
</th>
<th style="text-align:right;">
tsfeatures_diff2_acf1
</th>
<th style="text-align:right;">
tsfeatures_diff2_acf10
</th>
<th style="text-align:right;">
unitroot_kpss
</th>
<th style="text-align:right;">
unitroot_pp
</th>
<th style="text-align:right;">
walker_propcross
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.0675275
</td>
<td style="text-align:right;">
0.0097094
</td>
<td style="text-align:right;">
0.0526897
</td>
<td style="text-align:right;">
-0.5005299
</td>
<td style="text-align:right;">
0.3297018
</td>
<td style="text-align:right;">
-0.6772403
</td>
<td style="text-align:right;">
0.6124739
</td>
<td style="text-align:right;">
0.0627825
</td>
<td style="text-align:right;">
0.3929961
</td>
<td style="text-align:right;">
0.6147860
</td>
<td style="text-align:right;">
-0.0675275
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.1208750
</td>
<td style="text-align:right;">
2.071663
</td>
<td style="text-align:right;">
0.5405405
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3929961
</td>
<td style="text-align:right;">
0.6147860
</td>
<td style="text-align:right;">
-0.0675275
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.1208750
</td>
<td style="text-align:right;">
2.071663
</td>
<td style="text-align:right;">
0.5405405
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.788841
</td>
<td style="text-align:right;">
1.408737
</td>
<td style="text-align:right;">
1.68
</td>
<td style="text-align:right;">
1.43
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.2865385
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.2865385
</td>
<td style="text-align:right;">
0.3929961
</td>
<td style="text-align:right;">
0.9840151
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.0652585
</td>
<td style="text-align:right;">
0.0154406
</td>
<td style="text-align:right;">
0.0627825
</td>
<td style="text-align:right;">
0.0253367
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0013330
</td>
<td style="text-align:right;">
0.0013330
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3556536
</td>
<td style="text-align:right;">
1.783636
</td>
<td style="text-align:right;">
103
</td>
<td style="text-align:right;">
1.297736
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
2.819828
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
2.071663
</td>
<td style="text-align:right;">
0.0752319
</td>
<td style="text-align:right;">
-0.2865385
</td>
<td style="text-align:right;">
0.0108653
</td>
<td style="text-align:right;">
0.4457792
</td>
<td style="text-align:right;">
1.0525222
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.788841
</td>
<td style="text-align:right;">
1.788841
</td>
<td style="text-align:right;">
1.788841
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
1.76
</td>
<td style="text-align:right;">
0.0562693
</td>
<td style="text-align:right;">
1.408737
</td>
<td style="text-align:right;">
1.74
</td>
<td style="text-align:right;">
1.36
</td>
<td style="text-align:right;">
1.408737
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0043052
</td>
<td style="text-align:right;">
0.0000261
</td>
<td style="text-align:right;">
0.8421403
</td>
<td style="text-align:right;">
-0.7069160
</td>
<td style="text-align:right;">
0.0052389
</td>
<td style="text-align:right;">
0.0588324
</td>
<td style="text-align:right;">
0.1208750
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0043052
</td>
<td style="text-align:right;">
0.0000261
</td>
<td style="text-align:right;">
0.8421403
</td>
<td style="text-align:right;">
-0.7069160
</td>
<td style="text-align:right;">
0.0052389
</td>
<td style="text-align:right;">
0.0588324
</td>
<td style="text-align:right;">
0.9840151
</td>
<td style="text-align:right;">
0.0097094
</td>
<td style="text-align:right;">
0.0526897
</td>
<td style="text-align:right;">
-0.5005299
</td>
<td style="text-align:right;">
0.3297018
</td>
<td style="text-align:right;">
-0.6772403
</td>
<td style="text-align:right;">
0.6124739
</td>
<td style="text-align:right;">
0.0993829
</td>
<td style="text-align:right;">
-249.7732
</td>
<td style="text-align:right;">
0.5405405
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.0421577
</td>
<td style="text-align:right;">
-0.0075902
</td>
<td style="text-align:right;">
0.0387481
</td>
<td style="text-align:right;">
-0.5171529
</td>
<td style="text-align:right;">
0.3129147
</td>
<td style="text-align:right;">
-0.6727897
</td>
<td style="text-align:right;">
0.5379301
</td>
<td style="text-align:right;">
0.0558032
</td>
<td style="text-align:right;">
0.4285714
</td>
<td style="text-align:right;">
0.6563707
</td>
<td style="text-align:right;">
-0.0421577
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.4765229
</td>
<td style="text-align:right;">
2.077581
</td>
<td style="text-align:right;">
0.5019305
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.4285714
</td>
<td style="text-align:right;">
0.6563707
</td>
<td style="text-align:right;">
-0.0421577
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.4765229
</td>
<td style="text-align:right;">
2.077581
</td>
<td style="text-align:right;">
0.5019305
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.780390
</td>
<td style="text-align:right;">
1.419266
</td>
<td style="text-align:right;">
1.95
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.2615385
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.2615385
</td>
<td style="text-align:right;">
0.4285714
</td>
<td style="text-align:right;">
0.9864332
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.0664358
</td>
<td style="text-align:right;">
0.0657859
</td>
<td style="text-align:right;">
0.0558032
</td>
<td style="text-align:right;">
0.0554355
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.4636768
</td>
<td style="text-align:right;">
1.733008
</td>
<td style="text-align:right;">
247
</td>
<td style="text-align:right;">
1.311861
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
2.625772
</td>
<td style="text-align:right;">
221
</td>
<td style="text-align:right;">
2.077581
</td>
<td style="text-align:right;">
0.0273335
</td>
<td style="text-align:right;">
0.2615385
</td>
<td style="text-align:right;">
0.0256032
</td>
<td style="text-align:right;">
0.4606850
</td>
<td style="text-align:right;">
1.0171377
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.780390
</td>
<td style="text-align:right;">
1.780390
</td>
<td style="text-align:right;">
1.780390
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
0.0892206
</td>
<td style="text-align:right;">
1.419266
</td>
<td style="text-align:right;">
2.12
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.419266
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0177460
</td>
<td style="text-align:right;">
0.0000399
</td>
<td style="text-align:right;">
0.9249561
</td>
<td style="text-align:right;">
0.7665407
</td>
<td style="text-align:right;">
-0.0218053
</td>
<td style="text-align:right;">
0.0411861
</td>
<td style="text-align:right;">
-0.4765229
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0177460
</td>
<td style="text-align:right;">
0.0000399
</td>
<td style="text-align:right;">
0.9249561
</td>
<td style="text-align:right;">
0.7665407
</td>
<td style="text-align:right;">
-0.0218053
</td>
<td style="text-align:right;">
0.0411861
</td>
<td style="text-align:right;">
0.9864332
</td>
<td style="text-align:right;">
-0.0075902
</td>
<td style="text-align:right;">
0.0387481
</td>
<td style="text-align:right;">
-0.5171529
</td>
<td style="text-align:right;">
0.3129147
</td>
<td style="text-align:right;">
-0.6727897
</td>
<td style="text-align:right;">
0.5379301
</td>
<td style="text-align:right;">
0.0414599
</td>
<td style="text-align:right;">
-256.0485
</td>
<td style="text-align:right;">
0.5019305
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0099598
</td>
<td style="text-align:right;">
-0.0405929
</td>
<td style="text-align:right;">
0.0449036
</td>
<td style="text-align:right;">
-0.5026683
</td>
<td style="text-align:right;">
0.3471209
</td>
<td style="text-align:right;">
-0.6718885
</td>
<td style="text-align:right;">
0.6109006
</td>
<td style="text-align:right;">
0.0325470
</td>
<td style="text-align:right;">
0.4671815
</td>
<td style="text-align:right;">
0.7065637
</td>
<td style="text-align:right;">
0.0099598
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.8755173
</td>
<td style="text-align:right;">
2.069233
</td>
<td style="text-align:right;">
0.5328185
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4671815
</td>
<td style="text-align:right;">
0.7065637
</td>
<td style="text-align:right;">
0.0099598
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.8755173
</td>
<td style="text-align:right;">
2.069233
</td>
<td style="text-align:right;">
0.5328185
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.706841
</td>
<td style="text-align:right;">
1.443315
</td>
<td style="text-align:right;">
1.38
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
-0.2538462
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
-0.2538462
</td>
<td style="text-align:right;">
0.4671815
</td>
<td style="text-align:right;">
0.9868568
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
0.0388513
</td>
<td style="text-align:right;">
0.0039162
</td>
<td style="text-align:right;">
0.0325470
</td>
<td style="text-align:right;">
0.0041902
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
0.0014557
</td>
<td style="text-align:right;">
0.0014557
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.2670493
</td>
<td style="text-align:right;">
7.746711
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
1.403784
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
5.235499
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
2.069233
</td>
<td style="text-align:right;">
0.2436499
</td>
<td style="text-align:right;">
-0.2538462
</td>
<td style="text-align:right;">
0.0223069
</td>
<td style="text-align:right;">
0.5356408
</td>
<td style="text-align:right;">
0.9954919
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.706841
</td>
<td style="text-align:right;">
1.706841
</td>
<td style="text-align:right;">
1.706841
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
1.42
</td>
<td style="text-align:right;">
0.0716499
</td>
<td style="text-align:right;">
1.443315
</td>
<td style="text-align:right;">
1.42
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.443315
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0141368
</td>
<td style="text-align:right;">
0.0000929
</td>
<td style="text-align:right;">
0.8414359
</td>
<td style="text-align:right;">
-0.0259311
</td>
<td style="text-align:right;">
-0.0547484
</td>
<td style="text-align:right;">
0.0492987
</td>
<td style="text-align:right;">
-0.8755173
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0141368
</td>
<td style="text-align:right;">
0.0000929
</td>
<td style="text-align:right;">
0.8414359
</td>
<td style="text-align:right;">
-0.0259311
</td>
<td style="text-align:right;">
-0.0547484
</td>
<td style="text-align:right;">
0.0492987
</td>
<td style="text-align:right;">
0.9868568
</td>
<td style="text-align:right;">
-0.0405929
</td>
<td style="text-align:right;">
0.0449036
</td>
<td style="text-align:right;">
-0.5026683
</td>
<td style="text-align:right;">
0.3471209
</td>
<td style="text-align:right;">
-0.6718885
</td>
<td style="text-align:right;">
0.6109006
</td>
<td style="text-align:right;">
0.0775698
</td>
<td style="text-align:right;">
-258.1295
</td>
<td style="text-align:right;">
0.5328185
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.0428748
</td>
<td style="text-align:right;">
-0.0443619
</td>
<td style="text-align:right;">
0.0615867
</td>
<td style="text-align:right;">
-0.4571442
</td>
<td style="text-align:right;">
0.3184053
</td>
<td style="text-align:right;">
-0.5906478
</td>
<td style="text-align:right;">
0.4361178
</td>
<td style="text-align:right;">
0.1275576
</td>
<td style="text-align:right;">
0.4555985
</td>
<td style="text-align:right;">
0.7027027
</td>
<td style="text-align:right;">
-0.0428748
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.9943808
</td>
<td style="text-align:right;">
2.068744
</td>
<td style="text-align:right;">
0.4903475
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4555985
</td>
<td style="text-align:right;">
0.7027027
</td>
<td style="text-align:right;">
-0.0428748
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.9943808
</td>
<td style="text-align:right;">
2.068744
</td>
<td style="text-align:right;">
0.4903475
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.660825
</td>
<td style="text-align:right;">
1.445807
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0153846
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
127
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0153846
</td>
<td style="text-align:right;">
0.4555985
</td>
<td style="text-align:right;">
0.9790521
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
0.0694296
</td>
<td style="text-align:right;">
0.0112709
</td>
<td style="text-align:right;">
0.0579144
</td>
<td style="text-align:right;">
0.0123884
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0480021
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.0068624
</td>
<td style="text-align:right;">
4.994753
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
1.258758
</td>
<td style="text-align:right;">
173
</td>
<td style="text-align:right;">
5.886911
</td>
<td style="text-align:right;">
156
</td>
<td style="text-align:right;">
2.068744
</td>
<td style="text-align:right;">
0.3840091
</td>
<td style="text-align:right;">
0.0153846
</td>
<td style="text-align:right;">
0.0503205
</td>
<td style="text-align:right;">
0.5402603
</td>
<td style="text-align:right;">
1.1070217
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.660825
</td>
<td style="text-align:right;">
1.660825
</td>
<td style="text-align:right;">
1.660825
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:right;">
0.1065111
</td>
<td style="text-align:right;">
1.445807
</td>
<td style="text-align:right;">
1.14
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.445807
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0283540
</td>
<td style="text-align:right;">
0.0000482
</td>
<td style="text-align:right;">
-1.2297854
</td>
<td style="text-align:right;">
0.2921899
</td>
<td style="text-align:right;">
-0.0728152
</td>
<td style="text-align:right;">
0.0752389
</td>
<td style="text-align:right;">
-0.9943808
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0283540
</td>
<td style="text-align:right;">
0.0000482
</td>
<td style="text-align:right;">
-1.2297854
</td>
<td style="text-align:right;">
0.2921899
</td>
<td style="text-align:right;">
-0.0728152
</td>
<td style="text-align:right;">
0.0752389
</td>
<td style="text-align:right;">
0.9790521
</td>
<td style="text-align:right;">
-0.0443619
</td>
<td style="text-align:right;">
0.0615867
</td>
<td style="text-align:right;">
-0.4571442
</td>
<td style="text-align:right;">
0.3184053
</td>
<td style="text-align:right;">
-0.5906478
</td>
<td style="text-align:right;">
0.4361178
</td>
<td style="text-align:right;">
0.2129633
</td>
<td style="text-align:right;">
-262.0781
</td>
<td style="text-align:right;">
0.4903475
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0259312
</td>
<td style="text-align:right;">
-0.2447835
</td>
<td style="text-align:right;">
0.1469130
</td>
<td style="text-align:right;">
-0.5810073
</td>
<td style="text-align:right;">
0.4796508
</td>
<td style="text-align:right;">
-0.6799229
</td>
<td style="text-align:right;">
0.6232529
</td>
<td style="text-align:right;">
0.2014861
</td>
<td style="text-align:right;">
0.6563707
</td>
<td style="text-align:right;">
0.7992278
</td>
<td style="text-align:right;">
0.0259312
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.7167079
</td>
<td style="text-align:right;">
2.059764
</td>
<td style="text-align:right;">
0.5289575
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.6563707
</td>
<td style="text-align:right;">
0.7992278
</td>
<td style="text-align:right;">
0.0259312
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.7167079
</td>
<td style="text-align:right;">
2.059764
</td>
<td style="text-align:right;">
0.5289575
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.347789
</td>
<td style="text-align:right;">
1.580825
</td>
<td style="text-align:right;">
1.08
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
0.7961538
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
133
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
0.7961538
</td>
<td style="text-align:right;">
0.6563707
</td>
<td style="text-align:right;">
0.9723766
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.2718058
</td>
<td style="text-align:right;">
0.2229375
</td>
<td style="text-align:right;">
0.1765130
</td>
<td style="text-align:right;">
0.1330761
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.8846415
</td>
<td style="text-align:right;">
11.474426
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
1.772392
</td>
<td style="text-align:right;">
229
</td>
<td style="text-align:right;">
8.468236
</td>
<td style="text-align:right;">
236
</td>
<td style="text-align:right;">
2.059764
</td>
<td style="text-align:right;">
0.2143595
</td>
<td style="text-align:right;">
0.7961538
</td>
<td style="text-align:right;">
0.1008392
</td>
<td style="text-align:right;">
0.7538746
</td>
<td style="text-align:right;">
1.2926800
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.347789
</td>
<td style="text-align:right;">
1.347789
</td>
<td style="text-align:right;">
1.347789
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
1.08
</td>
<td style="text-align:right;">
0.0797924
</td>
<td style="text-align:right;">
1.580825
</td>
<td style="text-align:right;">
1.06
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.580825
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0121072
</td>
<td style="text-align:right;">
0.0001568
</td>
<td style="text-align:right;">
-0.5488436
</td>
<td style="text-align:right;">
0.2255538
</td>
<td style="text-align:right;">
-0.2599764
</td>
<td style="text-align:right;">
0.1558209
</td>
<td style="text-align:right;">
-0.7167079
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0121072
</td>
<td style="text-align:right;">
0.0001568
</td>
<td style="text-align:right;">
-0.5488436
</td>
<td style="text-align:right;">
0.2255538
</td>
<td style="text-align:right;">
-0.2599764
</td>
<td style="text-align:right;">
0.1558209
</td>
<td style="text-align:right;">
0.9723766
</td>
<td style="text-align:right;">
-0.2447835
</td>
<td style="text-align:right;">
0.1469130
</td>
<td style="text-align:right;">
-0.5810073
</td>
<td style="text-align:right;">
0.4796508
</td>
<td style="text-align:right;">
-0.6799229
</td>
<td style="text-align:right;">
0.6232529
</td>
<td style="text-align:right;">
0.1506344
</td>
<td style="text-align:right;">
-323.5672
</td>
<td style="text-align:right;">
0.5289575
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.0761166
</td>
<td style="text-align:right;">
0.0468556
</td>
<td style="text-align:right;">
0.0858348
</td>
<td style="text-align:right;">
-0.5253131
</td>
<td style="text-align:right;">
0.3438031
</td>
<td style="text-align:right;">
-0.6901570
</td>
<td style="text-align:right;">
0.6130725
</td>
<td style="text-align:right;">
0.0432628
</td>
<td style="text-align:right;">
0.4352941
</td>
<td style="text-align:right;">
0.6627451
</td>
<td style="text-align:right;">
-0.0761166
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0898648
</td>
<td style="text-align:right;">
2.068914
</td>
<td style="text-align:right;">
0.5250965
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.4352941
</td>
<td style="text-align:right;">
0.6627451
</td>
<td style="text-align:right;">
-0.0761166
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0898648
</td>
<td style="text-align:right;">
2.068914
</td>
<td style="text-align:right;">
0.5250965
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.751575
</td>
<td style="text-align:right;">
1.381854
</td>
<td style="text-align:right;">
2.69
</td>
<td style="text-align:right;">
1.71
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.0846154
</td>
<td style="text-align:right;">
0.3488372
</td>
<td style="text-align:right;">
134
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
-0.0846154
</td>
<td style="text-align:right;">
0.4352941
</td>
<td style="text-align:right;">
0.9806218
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.3488372
</td>
<td style="text-align:right;">
0.0500806
</td>
<td style="text-align:right;">
0.0502154
</td>
<td style="text-align:right;">
0.0627968
</td>
<td style="text-align:right;">
0.0620877
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0286244
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5188805
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.2189481
</td>
<td style="text-align:right;">
3.145763
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
1.447883
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
2.077936
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
2.068914
</td>
<td style="text-align:right;">
0.0137733
</td>
<td style="text-align:right;">
-0.0846154
</td>
<td style="text-align:right;">
0.0172321
</td>
<td style="text-align:right;">
0.4345976
</td>
<td style="text-align:right;">
1.0881798
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.751575
</td>
<td style="text-align:right;">
1.751575
</td>
<td style="text-align:right;">
1.751575
</td>
<td style="text-align:right;">
0.3488372
</td>
<td style="text-align:right;">
2.61
</td>
<td style="text-align:right;">
0.1479673
</td>
<td style="text-align:right;">
1.381854
</td>
<td style="text-align:right;">
2.63
</td>
<td style="text-align:right;">
1.81
</td>
<td style="text-align:right;">
1.381854
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0077481
</td>
<td style="text-align:right;">
0.0000329
</td>
<td style="text-align:right;">
-0.5473782
</td>
<td style="text-align:right;">
0.4505809
</td>
<td style="text-align:right;">
0.0410068
</td>
<td style="text-align:right;">
0.0873468
</td>
<td style="text-align:right;">
0.0898648
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0077481
</td>
<td style="text-align:right;">
0.0000329
</td>
<td style="text-align:right;">
-0.5473782
</td>
<td style="text-align:right;">
0.4505809
</td>
<td style="text-align:right;">
0.0410068
</td>
<td style="text-align:right;">
0.0873468
</td>
<td style="text-align:right;">
0.9806218
</td>
<td style="text-align:right;">
0.0468556
</td>
<td style="text-align:right;">
0.0858348
</td>
<td style="text-align:right;">
-0.5253131
</td>
<td style="text-align:right;">
0.3438031
</td>
<td style="text-align:right;">
-0.6901570
</td>
<td style="text-align:right;">
0.6130725
</td>
<td style="text-align:right;">
0.0259414
</td>
<td style="text-align:right;">
-262.3484
</td>
<td style="text-align:right;">
0.5250965
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>test_final %&gt;%
  head() %&gt;%
  kable(caption = &quot;Final testing data set&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), font_size = 12)</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-38">Table 9: </span>Final testing data set
</caption>
<thead>
<tr>
<th style="text-align:right;">
X
</th>
<th style="text-align:right;">
row_id
</th>
<th style="text-align:right;">
ac_9_ac_9
</th>
<th style="text-align:right;">
acf_features_x_acf1
</th>
<th style="text-align:right;">
acf_features_x_acf10
</th>
<th style="text-align:right;">
acf_features_diff1_acf1
</th>
<th style="text-align:right;">
acf_features_diff1_acf10
</th>
<th style="text-align:right;">
acf_features_diff2_acf1
</th>
<th style="text-align:right;">
acf_features_diff2_acf10
</th>
<th style="text-align:right;">
ARCH.LM
</th>
<th style="text-align:right;">
autocorr_features_embed2_incircle_1
</th>
<th style="text-align:right;">
autocorr_features_embed2_incircle_2
</th>
<th style="text-align:right;">
autocorr_features_ac_9
</th>
<th style="text-align:right;">
autocorr_features_firstmin_ac
</th>
<th style="text-align:right;">
autocorr_features_trev_num
</th>
<th style="text-align:right;">
autocorr_features_motiftwo_entro3
</th>
<th style="text-align:right;">
autocorr_features_walker_propcross
</th>
<th style="text-align:right;">
binarize_mean_binarize_mean
</th>
<th style="text-align:right;">
binarize_mean_NA
</th>
<th style="text-align:right;">
compengine_embed2_incircle_1
</th>
<th style="text-align:right;">
compengine_embed2_incircle_2
</th>
<th style="text-align:right;">
compengine_ac_9
</th>
<th style="text-align:right;">
compengine_firstmin_ac
</th>
<th style="text-align:right;">
compengine_trev_num
</th>
<th style="text-align:right;">
compengine_motiftwo_entro3
</th>
<th style="text-align:right;">
compengine_walker_propcross
</th>
<th style="text-align:right;">
compengine_localsimple_mean1
</th>
<th style="text-align:right;">
compengine_localsimple_lfitac
</th>
<th style="text-align:right;">
compengine_sampen_first
</th>
<th style="text-align:right;">
compengine_std1st_der
</th>
<th style="text-align:right;">
compengine_spreadrandomlocal_meantaul_50
</th>
<th style="text-align:right;">
compengine_spreadrandomlocal_meantaul_ac2
</th>
<th style="text-align:right;">
compengine_histogram_mode_10
</th>
<th style="text-align:right;">
compengine_outlierinclude_mdrmd
</th>
<th style="text-align:right;">
compengine_fluctanal_prop_r1
</th>
<th style="text-align:right;">
crossing_points
</th>
<th style="text-align:right;">
dist_features_histogram_mode_10
</th>
<th style="text-align:right;">
dist_features_outlierinclude_mdrmd
</th>
<th style="text-align:right;">
embed2_incircle
</th>
<th style="text-align:right;">
entropy
</th>
<th style="text-align:right;">
firstmin_ac
</th>
<th style="text-align:right;">
firstzero_ac
</th>
<th style="text-align:right;">
flat_spots
</th>
<th style="text-align:right;">
fluctanal_prop_r1_fluctanal_prop_r1
</th>
<th style="text-align:right;">
arch_acf
</th>
<th style="text-align:right;">
garch_acf
</th>
<th style="text-align:right;">
arch_r2
</th>
<th style="text-align:right;">
garch_r2
</th>
<th style="text-align:right;">
histogram_mode
</th>
<th style="text-align:right;">
alpha
</th>
<th style="text-align:right;">
beta
</th>
<th style="text-align:right;">
hurst
</th>
<th style="text-align:left;">
hw_parameters_hw_parameters
</th>
<th style="text-align:left;">
hw_parameters_NA
</th>
<th style="text-align:right;">
localsimple_taures
</th>
<th style="text-align:right;">
lumpiness
</th>
<th style="text-align:right;">
max_kl_shift
</th>
<th style="text-align:right;">
time_kl_shift
</th>
<th style="text-align:right;">
max_level_shift
</th>
<th style="text-align:right;">
time_level_shift
</th>
<th style="text-align:right;">
max_var_shift
</th>
<th style="text-align:right;">
time_var_shift
</th>
<th style="text-align:right;">
motiftwo_entro3
</th>
<th style="text-align:right;">
nonlinearity
</th>
<th style="text-align:right;">
outlierinclude_mdrmd
</th>
<th style="text-align:right;">
x_pacf5
</th>
<th style="text-align:right;">
diff1x_pacf5
</th>
<th style="text-align:right;">
diff2x_pacf5
</th>
<th style="text-align:right;">
pred_features_localsimple_mean1
</th>
<th style="text-align:right;">
pred_features_localsimple_lfitac
</th>
<th style="text-align:right;">
pred_features_sampen_first
</th>
<th style="text-align:right;">
sampen_first_sampen_first
</th>
<th style="text-align:right;">
sampenc
</th>
<th style="text-align:right;">
scal_features_fluctanal_prop_r1
</th>
<th style="text-align:right;">
spreadrandomlocal_meantaul
</th>
<th style="text-align:right;">
stability
</th>
<th style="text-align:right;">
station_features_std1st_der
</th>
<th style="text-align:right;">
station_features_spreadrandomlocal_meantaul_50
</th>
<th style="text-align:right;">
station_features_spreadrandomlocal_meantaul_ac2
</th>
<th style="text-align:right;">
std1st_der_std1st_der
</th>
<th style="text-align:right;">
nperiods
</th>
<th style="text-align:right;">
seasonal_period
</th>
<th style="text-align:right;">
trend
</th>
<th style="text-align:right;">
spike
</th>
<th style="text-align:right;">
linearity
</th>
<th style="text-align:right;">
curvature
</th>
<th style="text-align:right;">
e_acf1
</th>
<th style="text-align:right;">
e_acf10
</th>
<th style="text-align:right;">
trev_num
</th>
<th style="text-align:right;">
tsfeatures_frequency
</th>
<th style="text-align:right;">
tsfeatures_nperiods
</th>
<th style="text-align:right;">
tsfeatures_seasonal_period
</th>
<th style="text-align:right;">
tsfeatures_trend
</th>
<th style="text-align:right;">
tsfeatures_spike
</th>
<th style="text-align:right;">
tsfeatures_linearity
</th>
<th style="text-align:right;">
tsfeatures_curvature
</th>
<th style="text-align:right;">
tsfeatures_e_acf1
</th>
<th style="text-align:right;">
tsfeatures_e_acf10
</th>
<th style="text-align:right;">
tsfeatures_entropy
</th>
<th style="text-align:right;">
tsfeatures_x_acf1
</th>
<th style="text-align:right;">
tsfeatures_x_acf10
</th>
<th style="text-align:right;">
tsfeatures_diff1_acf1
</th>
<th style="text-align:right;">
tsfeatures_diff1_acf10
</th>
<th style="text-align:right;">
tsfeatures_diff2_acf1
</th>
<th style="text-align:right;">
tsfeatures_diff2_acf10
</th>
<th style="text-align:right;">
unitroot_kpss
</th>
<th style="text-align:right;">
unitroot_pp
</th>
<th style="text-align:right;">
walker_propcross
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0262073
</td>
<td style="text-align:right;">
-0.0396281
</td>
<td style="text-align:right;">
0.0429784
</td>
<td style="text-align:right;">
-0.4964245
</td>
<td style="text-align:right;">
0.3379915
</td>
<td style="text-align:right;">
-0.6704837
</td>
<td style="text-align:right;">
0.6178088
</td>
<td style="text-align:right;">
0.1425744
</td>
<td style="text-align:right;">
0.5482625
</td>
<td style="text-align:right;">
0.7528958
</td>
<td style="text-align:right;">
-0.0262073
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.5824739
</td>
<td style="text-align:right;">
2.063564
</td>
<td style="text-align:right;">
0.4826255
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5482625
</td>
<td style="text-align:right;">
0.7528958
</td>
<td style="text-align:right;">
-0.0262073
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.5824739
</td>
<td style="text-align:right;">
2.063564
</td>
<td style="text-align:right;">
0.4826255
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.383933
</td>
<td style="text-align:right;">
1.437946
</td>
<td style="text-align:right;">
1.91
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.4307692
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.4307692
</td>
<td style="text-align:right;">
0.5482625
</td>
<td style="text-align:right;">
0.9817288
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
0.1906443
</td>
<td style="text-align:right;">
0.0422059
</td>
<td style="text-align:right;">
0.1425744
</td>
<td style="text-align:right;">
0.0417531
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.0440489
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.1617874
</td>
<td style="text-align:right;">
4.857530
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
1.031623
</td>
<td style="text-align:right;">
230
</td>
<td style="text-align:right;">
3.967385
</td>
<td style="text-align:right;">
214
</td>
<td style="text-align:right;">
2.063564
</td>
<td style="text-align:right;">
0.0716802
</td>
<td style="text-align:right;">
0.4307692
</td>
<td style="text-align:right;">
0.0271516
</td>
<td style="text-align:right;">
0.5270423
</td>
<td style="text-align:right;">
0.9564642
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.383933
</td>
<td style="text-align:right;">
1.383933
</td>
<td style="text-align:right;">
1.383933
</td>
<td style="text-align:right;">
0.1395349
</td>
<td style="text-align:right;">
1.80
</td>
<td style="text-align:right;">
0.0804590
</td>
<td style="text-align:right;">
1.437946
</td>
<td style="text-align:right;">
1.89
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.437946
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0355541
</td>
<td style="text-align:right;">
0.0000573
</td>
<td style="text-align:right;">
-2.6210355
</td>
<td style="text-align:right;">
-0.0981868
</td>
<td style="text-align:right;">
-0.0740868
</td>
<td style="text-align:right;">
0.0651438
</td>
<td style="text-align:right;">
-0.5824739
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0355541
</td>
<td style="text-align:right;">
0.0000573
</td>
<td style="text-align:right;">
-2.6210355
</td>
<td style="text-align:right;">
-0.0981868
</td>
<td style="text-align:right;">
-0.0740868
</td>
<td style="text-align:right;">
0.0651438
</td>
<td style="text-align:right;">
0.9817288
</td>
<td style="text-align:right;">
-0.0396281
</td>
<td style="text-align:right;">
0.0429784
</td>
<td style="text-align:right;">
-0.4964245
</td>
<td style="text-align:right;">
0.3379915
</td>
<td style="text-align:right;">
-0.6704837
</td>
<td style="text-align:right;">
0.6178088
</td>
<td style="text-align:right;">
0.8820380
</td>
<td style="text-align:right;">
-252.2509
</td>
<td style="text-align:right;">
0.4826255
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.0047799
</td>
<td style="text-align:right;">
0.0544155
</td>
<td style="text-align:right;">
0.0423445
</td>
<td style="text-align:right;">
-0.4931653
</td>
<td style="text-align:right;">
0.3114689
</td>
<td style="text-align:right;">
-0.6980787
</td>
<td style="text-align:right;">
0.6597427
</td>
<td style="text-align:right;">
0.1111625
</td>
<td style="text-align:right;">
0.4513619
</td>
<td style="text-align:right;">
0.6964981
</td>
<td style="text-align:right;">
-0.0047799
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2147570
</td>
<td style="text-align:right;">
2.068849
</td>
<td style="text-align:right;">
0.5250965
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4513619
</td>
<td style="text-align:right;">
0.6964981
</td>
<td style="text-align:right;">
-0.0047799
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2147570
</td>
<td style="text-align:right;">
2.068849
</td>
<td style="text-align:right;">
0.5250965
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.611106
</td>
<td style="text-align:right;">
1.375120
</td>
<td style="text-align:right;">
2.15
</td>
<td style="text-align:right;">
1.40
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.1211538
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
142
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.1211538
</td>
<td style="text-align:right;">
0.4513619
</td>
<td style="text-align:right;">
0.9856808
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.1313081
</td>
<td style="text-align:right;">
0.0468159
</td>
<td style="text-align:right;">
0.0939769
</td>
<td style="text-align:right;">
0.0402163
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0063703
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5012778
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5347516
</td>
<td style="text-align:right;">
6.848494
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
1.360520
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
3.586240
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
2.068849
</td>
<td style="text-align:right;">
0.0618461
</td>
<td style="text-align:right;">
0.1211538
</td>
<td style="text-align:right;">
0.0344415
</td>
<td style="text-align:right;">
0.4336405
</td>
<td style="text-align:right;">
0.9510320
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.611106
</td>
<td style="text-align:right;">
1.611106
</td>
<td style="text-align:right;">
1.611106
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
2.14
</td>
<td style="text-align:right;">
0.0796936
</td>
<td style="text-align:right;">
1.375120
</td>
<td style="text-align:right;">
1.82
</td>
<td style="text-align:right;">
1.34
</td>
<td style="text-align:right;">
1.375120
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0216068
</td>
<td style="text-align:right;">
0.0000391
</td>
<td style="text-align:right;">
0.1351482
</td>
<td style="text-align:right;">
-0.3430376
</td>
<td style="text-align:right;">
0.0339344
</td>
<td style="text-align:right;">
0.0578569
</td>
<td style="text-align:right;">
0.2147570
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0216068
</td>
<td style="text-align:right;">
0.0000391
</td>
<td style="text-align:right;">
0.1351482
</td>
<td style="text-align:right;">
-0.3430376
</td>
<td style="text-align:right;">
0.0339344
</td>
<td style="text-align:right;">
0.0578569
</td>
<td style="text-align:right;">
0.9856808
</td>
<td style="text-align:right;">
0.0544155
</td>
<td style="text-align:right;">
0.0423445
</td>
<td style="text-align:right;">
-0.4931653
</td>
<td style="text-align:right;">
0.3114689
</td>
<td style="text-align:right;">
-0.6980787
</td>
<td style="text-align:right;">
0.6597427
</td>
<td style="text-align:right;">
0.0722224
</td>
<td style="text-align:right;">
-226.9463
</td>
<td style="text-align:right;">
0.5250965
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.0370364
</td>
<td style="text-align:right;">
-0.0041963
</td>
<td style="text-align:right;">
0.1781209
</td>
<td style="text-align:right;">
-0.3838557
</td>
<td style="text-align:right;">
0.3158431
</td>
<td style="text-align:right;">
-0.5535087
</td>
<td style="text-align:right;">
0.3948373
</td>
<td style="text-align:right;">
0.3450202
</td>
<td style="text-align:right;">
0.6138996
</td>
<td style="text-align:right;">
0.7915058
</td>
<td style="text-align:right;">
0.0370364
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2.9002534
</td>
<td style="text-align:right;">
2.067845
</td>
<td style="text-align:right;">
0.5598456
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.6138996
</td>
<td style="text-align:right;">
0.7915058
</td>
<td style="text-align:right;">
0.0370364
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2.9002534
</td>
<td style="text-align:right;">
2.067845
</td>
<td style="text-align:right;">
0.5598456
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.436472
</td>
<td style="text-align:right;">
1.414575
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.7230769
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.7230769
</td>
<td style="text-align:right;">
0.6138996
</td>
<td style="text-align:right;">
0.9627133
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.4731295
</td>
<td style="text-align:right;">
0.0342727
</td>
<td style="text-align:right;">
0.2247245
</td>
<td style="text-align:right;">
0.0323111
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.9022555
</td>
<td style="text-align:right;">
33.656077
</td>
<td style="text-align:right;">
240
</td>
<td style="text-align:right;">
1.695947
</td>
<td style="text-align:right;">
222
</td>
<td style="text-align:right;">
9.122984
</td>
<td style="text-align:right;">
232
</td>
<td style="text-align:right;">
2.067845
</td>
<td style="text-align:right;">
0.7040489
</td>
<td style="text-align:right;">
0.7230769
</td>
<td style="text-align:right;">
0.0685939
</td>
<td style="text-align:right;">
0.5171369
</td>
<td style="text-align:right;">
1.0433489
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.436472
</td>
<td style="text-align:right;">
1.436472
</td>
<td style="text-align:right;">
1.436472
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
1.39
</td>
<td style="text-align:right;">
0.1088905
</td>
<td style="text-align:right;">
1.414575
</td>
<td style="text-align:right;">
1.43
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.414575
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0058644
</td>
<td style="text-align:right;">
0.0001243
</td>
<td style="text-align:right;">
-1.1897947
</td>
<td style="text-align:right;">
-0.4762066
</td>
<td style="text-align:right;">
-0.0084531
</td>
<td style="text-align:right;">
0.1814633
</td>
<td style="text-align:right;">
2.9002534
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0058644
</td>
<td style="text-align:right;">
0.0001243
</td>
<td style="text-align:right;">
-1.1897947
</td>
<td style="text-align:right;">
-0.4762066
</td>
<td style="text-align:right;">
-0.0084531
</td>
<td style="text-align:right;">
0.1814633
</td>
<td style="text-align:right;">
0.9627133
</td>
<td style="text-align:right;">
-0.0041963
</td>
<td style="text-align:right;">
0.1781209
</td>
<td style="text-align:right;">
-0.3838557
</td>
<td style="text-align:right;">
0.3158431
</td>
<td style="text-align:right;">
-0.5535087
</td>
<td style="text-align:right;">
0.3948373
</td>
<td style="text-align:right;">
0.1757311
</td>
<td style="text-align:right;">
-235.0780
</td>
<td style="text-align:right;">
0.5598456
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-0.0576029
</td>
<td style="text-align:right;">
-0.0338906
</td>
<td style="text-align:right;">
0.0251717
</td>
<td style="text-align:right;">
-0.4963752
</td>
<td style="text-align:right;">
0.2570591
</td>
<td style="text-align:right;">
-0.6694337
</td>
<td style="text-align:right;">
0.4910006
</td>
<td style="text-align:right;">
0.0471296
</td>
<td style="text-align:right;">
0.3899614
</td>
<td style="text-align:right;">
0.6332046
</td>
<td style="text-align:right;">
-0.0576029
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-0.1053821
</td>
<td style="text-align:right;">
2.075447
</td>
<td style="text-align:right;">
0.5366795
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3899614
</td>
<td style="text-align:right;">
0.6332046
</td>
<td style="text-align:right;">
-0.0576029
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-0.1053821
</td>
<td style="text-align:right;">
2.075447
</td>
<td style="text-align:right;">
0.5366795
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.785628
</td>
<td style="text-align:right;">
1.436827
</td>
<td style="text-align:right;">
1.52
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.1860465
</td>
<td style="text-align:right;">
137
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.3899614
</td>
<td style="text-align:right;">
0.9886539
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.1860465
</td>
<td style="text-align:right;">
0.0511246
</td>
<td style="text-align:right;">
0.0516446
</td>
<td style="text-align:right;">
0.0471296
</td>
<td style="text-align:right;">
0.0470911
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.0025845
</td>
<td style="text-align:right;">
0.0025845
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.2161135
</td>
<td style="text-align:right;">
2.534373
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
1.404765
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
2.213233
</td>
<td style="text-align:right;">
205
</td>
<td style="text-align:right;">
2.075447
</td>
<td style="text-align:right;">
0.0681473
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.0179401
</td>
<td style="text-align:right;">
0.4720756
</td>
<td style="text-align:right;">
0.9626432
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.785628
</td>
<td style="text-align:right;">
1.785628
</td>
<td style="text-align:right;">
1.785628
</td>
<td style="text-align:right;">
0.1860465
</td>
<td style="text-align:right;">
1.44
</td>
<td style="text-align:right;">
0.0499953
</td>
<td style="text-align:right;">
1.436827
</td>
<td style="text-align:right;">
1.42
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.436827
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0042080
</td>
<td style="text-align:right;">
0.0000286
</td>
<td style="text-align:right;">
0.9969942
</td>
<td style="text-align:right;">
0.1863847
</td>
<td style="text-align:right;">
-0.0370368
</td>
<td style="text-align:right;">
0.0269840
</td>
<td style="text-align:right;">
-0.1053821
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0042080
</td>
<td style="text-align:right;">
0.0000286
</td>
<td style="text-align:right;">
0.9969942
</td>
<td style="text-align:right;">
0.1863847
</td>
<td style="text-align:right;">
-0.0370368
</td>
<td style="text-align:right;">
0.0269840
</td>
<td style="text-align:right;">
0.9886539
</td>
<td style="text-align:right;">
-0.0338906
</td>
<td style="text-align:right;">
0.0251717
</td>
<td style="text-align:right;">
-0.4963752
</td>
<td style="text-align:right;">
0.2570591
</td>
<td style="text-align:right;">
-0.6694337
</td>
<td style="text-align:right;">
0.4910006
</td>
<td style="text-align:right;">
0.0860264
</td>
<td style="text-align:right;">
-241.6752
</td>
<td style="text-align:right;">
0.5366795
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-0.1236994
</td>
<td style="text-align:right;">
0.0086381
</td>
<td style="text-align:right;">
0.0308039
</td>
<td style="text-align:right;">
-0.5025363
</td>
<td style="text-align:right;">
0.3330186
</td>
<td style="text-align:right;">
-0.6693011
</td>
<td style="text-align:right;">
0.5835466
</td>
<td style="text-align:right;">
0.1157603
</td>
<td style="text-align:right;">
0.4202335
</td>
<td style="text-align:right;">
0.7003891
</td>
<td style="text-align:right;">
-0.1236994
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0489352
</td>
<td style="text-align:right;">
2.058889
</td>
<td style="text-align:right;">
0.4864865
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4202335
</td>
<td style="text-align:right;">
0.7003891
</td>
<td style="text-align:right;">
-0.1236994
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0489352
</td>
<td style="text-align:right;">
2.058889
</td>
<td style="text-align:right;">
0.4864865
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.722492
</td>
<td style="text-align:right;">
1.396172
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
1.32
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
-0.0076923
</td>
<td style="text-align:right;">
0.8139535
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
-0.0076923
</td>
<td style="text-align:right;">
0.4202335
</td>
<td style="text-align:right;">
0.9908616
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.8139535
</td>
<td style="text-align:right;">
0.0537820
</td>
<td style="text-align:right;">
0.0583484
</td>
<td style="text-align:right;">
0.1157603
</td>
<td style="text-align:right;">
0.1120523
</td>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:right;">
0.0001609
</td>
<td style="text-align:right;">
0.0001609
</td>
<td style="text-align:right;">
0.5090878
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.6488028
</td>
<td style="text-align:right;">
3.045684
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
1.287940
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
4.338131
</td>
<td style="text-align:right;">
240
</td>
<td style="text-align:right;">
2.058889
</td>
<td style="text-align:right;">
0.0094165
</td>
<td style="text-align:right;">
-0.0076923
</td>
<td style="text-align:right;">
0.0059114
</td>
<td style="text-align:right;">
0.4457371
</td>
<td style="text-align:right;">
0.9190563
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.722492
</td>
<td style="text-align:right;">
1.722492
</td>
<td style="text-align:right;">
1.722492
</td>
<td style="text-align:right;">
0.8139535
</td>
<td style="text-align:right;">
1.63
</td>
<td style="text-align:right;">
0.1107442
</td>
<td style="text-align:right;">
1.396172
</td>
<td style="text-align:right;">
1.75
</td>
<td style="text-align:right;">
1.35
</td>
<td style="text-align:right;">
1.396172
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0229286
</td>
<td style="text-align:right;">
0.0000550
</td>
<td style="text-align:right;">
-0.6149100
</td>
<td style="text-align:right;">
0.2128084
</td>
<td style="text-align:right;">
-0.0125452
</td>
<td style="text-align:right;">
0.0317617
</td>
<td style="text-align:right;">
-0.0489352
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0229286
</td>
<td style="text-align:right;">
0.0000550
</td>
<td style="text-align:right;">
-0.6149100
</td>
<td style="text-align:right;">
0.2128084
</td>
<td style="text-align:right;">
-0.0125452
</td>
<td style="text-align:right;">
0.0317617
</td>
<td style="text-align:right;">
0.9908616
</td>
<td style="text-align:right;">
0.0086381
</td>
<td style="text-align:right;">
0.0308039
</td>
<td style="text-align:right;">
-0.5025363
</td>
<td style="text-align:right;">
0.3330186
</td>
<td style="text-align:right;">
-0.6693011
</td>
<td style="text-align:right;">
0.5835466
</td>
<td style="text-align:right;">
0.1169027
</td>
<td style="text-align:right;">
-266.1451
</td>
<td style="text-align:right;">
0.4864865
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.0137566
</td>
<td style="text-align:right;">
-0.0889224
</td>
<td style="text-align:right;">
0.0668615
</td>
<td style="text-align:right;">
-0.5649436
</td>
<td style="text-align:right;">
0.4404459
</td>
<td style="text-align:right;">
-0.7097820
</td>
<td style="text-align:right;">
0.7128451
</td>
<td style="text-align:right;">
0.0752299
</td>
<td style="text-align:right;">
0.5366795
</td>
<td style="text-align:right;">
0.6447876
</td>
<td style="text-align:right;">
0.0137566
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3033072
</td>
<td style="text-align:right;">
2.064104
</td>
<td style="text-align:right;">
0.5328185
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5366795
</td>
<td style="text-align:right;">
0.6447876
</td>
<td style="text-align:right;">
0.0137566
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3033072
</td>
<td style="text-align:right;">
2.064104
</td>
<td style="text-align:right;">
0.5328185
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.464977
</td>
<td style="text-align:right;">
1.477767
</td>
<td style="text-align:right;">
1.53
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.3269231
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
136
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.3269231
</td>
<td style="text-align:right;">
0.5366795
</td>
<td style="text-align:right;">
0.9835850
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
0.1033936
</td>
<td style="text-align:right;">
0.0236197
</td>
<td style="text-align:right;">
0.0740159
</td>
<td style="text-align:right;">
0.0248339
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.0001000
</td>
<td style="text-align:right;">
0.5000458
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.7510236
</td>
<td style="text-align:right;">
12.688453
</td>
<td style="text-align:right;">
197
</td>
<td style="text-align:right;">
1.217490
</td>
<td style="text-align:right;">
189
</td>
<td style="text-align:right;">
2.987989
</td>
<td style="text-align:right;">
194
</td>
<td style="text-align:right;">
2.064104
</td>
<td style="text-align:right;">
0.0649001
</td>
<td style="text-align:right;">
0.3269231
</td>
<td style="text-align:right;">
0.0200688
</td>
<td style="text-align:right;">
0.5201834
</td>
<td style="text-align:right;">
1.0761503
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.464977
</td>
<td style="text-align:right;">
1.464977
</td>
<td style="text-align:right;">
1.464977
</td>
<td style="text-align:right;">
0.1627907
</td>
<td style="text-align:right;">
1.35
</td>
<td style="text-align:right;">
0.0814814
</td>
<td style="text-align:right;">
1.477767
</td>
<td style="text-align:right;">
1.36
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.477767
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0081147
</td>
<td style="text-align:right;">
0.0000469
</td>
<td style="text-align:right;">
0.6555116
</td>
<td style="text-align:right;">
-0.0489727
</td>
<td style="text-align:right;">
-0.0976177
</td>
<td style="text-align:right;">
0.0700199
</td>
<td style="text-align:right;">
0.3033072
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0081147
</td>
<td style="text-align:right;">
0.0000469
</td>
<td style="text-align:right;">
0.6555116
</td>
<td style="text-align:right;">
-0.0489727
</td>
<td style="text-align:right;">
-0.0976177
</td>
<td style="text-align:right;">
0.0700199
</td>
<td style="text-align:right;">
0.9835850
</td>
<td style="text-align:right;">
-0.0889224
</td>
<td style="text-align:right;">
0.0668615
</td>
<td style="text-align:right;">
-0.5649436
</td>
<td style="text-align:right;">
0.4404459
</td>
<td style="text-align:right;">
-0.7097820
</td>
<td style="text-align:right;">
0.7128451
</td>
<td style="text-align:right;">
0.0869913
</td>
<td style="text-align:right;">
-279.8920
</td>
<td style="text-align:right;">
0.5328185
</td>
</tr>
</tbody>
</table>
<p><em>Finally</em> we can run the final model on the <strong>held-out-test-set</strong> and obtain our predictions based on the training data and the optimal parameters.</p>
<pre class="r"><code># previously and run the final training model (to make predictions on the out-of-sample test data)

x_train_final &lt;- train_final %&gt;%
  ungroup() %&gt;%
  select(-class, -row_id, -X) %&gt;%
  as.matrix()

x_test_final &lt;- test_final %&gt;%
  ungroup() %&gt;%
  select(-row_id, -X) %&gt;%
  as.matrix()

y_train_final &lt;- train_final %&gt;%
  ungroup() %&gt;%
  pull(class)

dtrain_final &lt;- xgb.DMatrix(data = as.matrix(x_train_final), label = y_train_final, missing = &quot;NaN&quot;)
dtest_final &lt;- xgb.DMatrix(data = as.matrix(x_test_final), missing = &quot;NaN&quot;)

watchlist &lt;- list(&quot;train&quot; = dtrain_final)

params &lt;- list(&quot;eta&quot; = 0.1, &quot;max_depth&quot; = 5, &quot;colsample_bytree&quot; = 1, &quot;min_child_weight&quot; = 1, &quot;subsample&quot;= 1,
               &quot;objective&quot;=&quot;binary:logistic&quot;, &quot;gamma&quot; = 1, &quot;lambda&quot; = 1, &quot;alpha&quot; = 0, &quot;max_delta_step&quot; = 0,
               &quot;colsample_bylevel&quot; = 1, &quot;eval_metric&quot;= &quot;auc&quot;,
               &quot;set.seed&quot; = 176)

nround &lt;- 95

xgb.model_final &lt;- xgb.train(params, dtrain_final, nround, watchlist)</code></pre>
<pre><code>## [1]  train-auc:0.708604 
## [2]  train-auc:0.721700 
## [3]  train-auc:0.723230 
## [4]  train-auc:0.729888 
## [5]  train-auc:0.735542 
## [6]  train-auc:0.738081 
## [7]  train-auc:0.740926 
## [8]  train-auc:0.744105 
## [9]  train-auc:0.746320 
## [10] train-auc:0.748644 
## [11] train-auc:0.754211 
## [12] train-auc:0.756892 
## [13] train-auc:0.761524 
## [14] train-auc:0.763882 
## [15] train-auc:0.767216 
## [16] train-auc:0.772009 
## [17] train-auc:0.772943 
## [18] train-auc:0.774261 
## [19] train-auc:0.775471 
## [20] train-auc:0.777801 
## [21] train-auc:0.780629 
## [22] train-auc:0.784384 
## [23] train-auc:0.787112 
## [24] train-auc:0.788946 
## [25] train-auc:0.791835 
## [26] train-auc:0.793142 
## [27] train-auc:0.795289 
## [28] train-auc:0.798502 
## [29] train-auc:0.799893 
## [30] train-auc:0.802186 
## [31] train-auc:0.804981 
## [32] train-auc:0.805649 
## [33] train-auc:0.807120 
## [34] train-auc:0.809020 
## [35] train-auc:0.810318 
## [36] train-auc:0.812637 
## [37] train-auc:0.814760 
## [38] train-auc:0.816024 
## [39] train-auc:0.817956 
## [40] train-auc:0.819350 
## [41] train-auc:0.821653 
## [42] train-auc:0.822729 
## [43] train-auc:0.824029 
## [44] train-auc:0.824765 
## [45] train-auc:0.826924 
## [46] train-auc:0.827804 
## [47] train-auc:0.828475 
## [48] train-auc:0.831018 
## [49] train-auc:0.832247 
## [50] train-auc:0.833265 
## [51] train-auc:0.834168 
## [52] train-auc:0.835535 
## [53] train-auc:0.836093 
## [54] train-auc:0.837008 
## [55] train-auc:0.837715 
## [56] train-auc:0.839537 
## [57] train-auc:0.840310 
## [58] train-auc:0.841701 
## [59] train-auc:0.842480 
## [60] train-auc:0.843106 
## [61] train-auc:0.844495 
## [62] train-auc:0.845348 
## [63] train-auc:0.845932 
## [64] train-auc:0.847843 
## [65] train-auc:0.849445 
## [66] train-auc:0.850345 
## [67] train-auc:0.851337 
## [68] train-auc:0.852121 
## [69] train-auc:0.852663 
## [70] train-auc:0.854132 
## [71] train-auc:0.855949 
## [72] train-auc:0.856758 
## [73] train-auc:0.857115 
## [74] train-auc:0.857954 
## [75] train-auc:0.858849 
## [76] train-auc:0.859527 
## [77] train-auc:0.859917 
## [78] train-auc:0.860590 
## [79] train-auc:0.861264 
## [80] train-auc:0.862359 
## [81] train-auc:0.863101 
## [82] train-auc:0.863794 
## [83] train-auc:0.864911 
## [84] train-auc:0.866293 
## [85] train-auc:0.866976 
## [86] train-auc:0.867436 
## [87] train-auc:0.869036 
## [88] train-auc:0.869469 
## [89] train-auc:0.869931 
## [90] train-auc:0.870681 
## [91] train-auc:0.872326 
## [92] train-auc:0.873706 
## [93] train-auc:0.875704 
## [94] train-auc:0.876178 
## [95] train-auc:0.876789</code></pre>
<p>I make the final predictions based on the <code>test.csv</code> data. The <code>predict</code> function in R is great, it can take any model and make predictions, we just need to provide the testing data along with the model. I “ask” for probability scores from the predictions. I plot the density of predicted probabilities also.</p>
<pre class="r"><code># Make the final predictions on the &#39;test.csv&#39; data and plot the probability density function.

xgb.pred_final &lt;- predict(xgb.model_final, dtest_final, type = &#39;prob&#39;)

xgb.pred_final %&gt;%
 as_tibble() %&gt;%
 setNames(c(&quot;Prediction&quot;)) %&gt;%
 ggplot(aes(x = Prediction)) + 
 geom_density(color = &quot;darkblue&quot;, fill = &quot;lightblue&quot;) +
 geom_vline(aes(xintercept = mean(Prediction)),
            color = &quot;blue&quot;, linetype = &quot;dashed&quot;, size = 1) +
 geom_histogram(aes(y = ..density..), colour = &quot;black&quot;, fill = &quot;white&quot;, alpha = 0.1, position = &quot;identity&quot;) +
 ggtitle(&quot;(Out of sample) - Predicted probability density plot&quot;) +
 theme_tq()</code></pre>
<p><img src="/post/synth-real-time-series/synth_real_time_series_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
</div>
<div id="finally-i-make-the-submission-file-based-on-the-predicted-probabilities." class="section level3">
<h3>Finally! I make the submission file based on the predicted probabilities.</h3>
<pre class="r"><code># Convert the probabilities into a binary class of 0 or 1 by a decision threshold of 0.465.
# Write the predictions to &quot;submission.csv&quot;

xgb.pred_final %&gt;%
  as_tibble() %&gt;%
  setNames(c(&quot;Prediction&quot;)) %&gt;%
  summarise(mean = mean(Prediction))</code></pre>
<pre><code>## # A tibble: 1 x 1
##    mean
##   &lt;dbl&gt;
## 1 0.465</code></pre>
<pre class="r"><code>xgb.pred_final %&gt;%
  as_tibble() %&gt;%
  setNames(c(&quot;Prediction&quot;)) %&gt;%
  mutate(pred = case_when(
    Prediction &gt; 0.465 ~ 1,
    Prediction &lt;= 0.465 ~ 0
  )) %&gt;%
  write.csv(&quot;submission.csv&quot;)</code></pre>
<p>I make the final remark in the Jupyter Notebook I sent as part of the interview process</p>
<p>Quote::
<em>Final footnote: Hopefully the out-of-sample predictions will obtain a 67% accuracy (the predictions in the “submission.csv” file).</em></p>
<p>I was told after I sent my scores as part of the interview process how the scores were evaluated (In Spanish):</p>
<p>*Para que sepas cómo es la valoración:</p>
<p>Obtener entre 0.4-0.6 se considera un resultado aleatorio.</p>
<p>A partir 0.6 el algoritmo clasifica correctamente y más de un 0.7 el algoritmo es genial.</p>
<p>Por debajo de 0.4 son capaces de diferenciar series sintéticas de las reales, pero están intercambiadas.*</p>
<p>I was informed that based on the held out test set I obtained a result of 0.649636 ~0.65% (a little lower than my 0.67% in-sample training set!) but still consistent with the correct methodology I was using (i.e. no leaking test data to the training data) along with the fact that I was just throwing the time series features book/kitchen sink at the problem. Further reading into time series features will strengthen this classification problem will certainly improve the prediction accuracy! Recall, that my feature selection consisted of applying every feature in the <code>tsfeatures</code> package… Using <code>functions &lt;- ls("package:tsfeatures")[1:42]</code> and then <code>mapping</code> over the data using <code>summarise(Statistics = map(data, ~ data.frame( bind_cols(tsfeatures(.x$value, functions))))) %&gt;%</code>. So there is plenty of improvements to the current model.</p>
<p>I hope this post explains some of the inner workings of time series training and testing models. I understand it’s a little <em>involved</em> but I hope I provide some tools/code in order to build from.</p>
<p>Otros:</p>
<p>Another note I obtained from the interview process was the following:</p>
<p>En el caso del reto, una de las características más importante de los datos es que provienen de una serie temporal, por lo que es de esperar que las relaciones intertemporales jueguen un papel fundamental. Por un lado, planteas una red neuronal con una arquitectura incapaz de capturar estas relaciones.</p>
<p>I didn’t apply a neural netwrok but I understand how this might have been missed, the whole Notebook explored the data and I compactly applied an XGBoost model.</p>
<p>Conclusion: A combination of time series feature selection and classifciation models and do pretty well on time series classification models such as this one I faced.</p>
<p>Any errors are my own!</p>
</div>

    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/asset-pricing/">asset pricing</a>
  
  <a class="badge badge-light" href="/tags/xgboost/">xgboost</a>
  
  <a class="badge badge-light" href="/tags/time-series/">time series</a>
  
  <a class="badge badge-light" href="/tags/synthetic-data/">synthetic data</a>
  
</div>



    
      








  






  
  
  
    
  
  
  <div class="media author-card">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu88685f9f250f5c15d78dab2d9552b11c_15179_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Matthew Smith</a></h5>
      <h6 class="card-subtitle">Researcher</h6>
      <p class="card-text">I am a researcher with a focus on Machine Learning methods applied to economics and finance.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="/#contact" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="https://twitter.com/MatthewSmith786" target="_blank" rel="noopener">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a href="https://scholar.google.co.uk/" target="_blank" rel="noopener">
              <i class="ai ai-google-scholar"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="https://github.com/msmith01" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/post/hackerrank-competitions/hackerrank-compeitions/">Series of Hackerrank Competitions</a></li>
          
          <li><a href="/post/financial-ratios-in-r/fundamental-financial-ratios-in-r/">Fundamental Financial Ratios in R</a></li>
          
        </ul>
      </div>
      
    

    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.130521ecfc6f534c52c158217bbff718.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
        
  </p>
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
